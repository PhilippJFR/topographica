<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Adding noise to Topographica &mdash; Topographica</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.9.8',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/custom.js"></script>
    <link rel="shortcut icon" href="../_static/topo-favicon.ico"/>
    <link rel="top" title="Topographica" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>

<li><a href="../index.html">Home</a></li>
<li><a href="../Downloads/index.html">Downloads</a></li>
<li><a href="../Tutorials/index.html">Tutorials</a></li>
<li><a href="index.html">User Manual</a></li>







      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="adding-noise-to-topographica">
<h1>Adding noise to Topographica<a class="headerlink" href="#adding-noise-to-topographica" title="Permalink to this headline">¶</a></h1>
<p>Most of the default settings in Topographica give precise,
repeatable, noise-free results, in order to make the behavior
predictable and understandable. However, there are many ways to
increase realism by adding noise, a few of which are outlined below.</p>
<div class="section" id="additive-and-multiplicative-noise-in-output-fns">
<h2>Additive and multiplicative noise in output_fns<a class="headerlink" href="#additive-and-multiplicative-noise-in-output-fns" title="Permalink to this headline">¶</a></h2>
<p>One easy way to add noise in Topographica is by using a
<em>TransferFn</em>. A TransferFn is simply a function that maps an array
into another array of the same size and shape. At many locations in
the Topographica code, a parameter named output_fns is provided to
allow the user to put in any desired functions of this type. For
instance, the output_fns of a Sheet (e.g. the Retina or V1)
constitute its activation or transfer function. The output_fns of a
Projection (e.g. Afferent or LateralExcitatory) are applied to the
activity in that Projection after it has been computed, and thus are
also transfer functions.</p>
<p>Multiple TransferFns can be placed in Topographica output_fns, and
will be applied sequentially. For instance, LISSOM V1 Sheets
typically have one PiecewiseLinear() TransferFn in the list of
output_fns; noise can be added to this by appending to output_fns
a TransferFn that adds noise. Others that have an empty list of
output_fns by default can again just append the new
output_function to the list. Suitable transfer functions for noise
include variants of:</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre>transferfn.misc.PatternCombine(generator=pattern.random.UniformRandom(scale=1.0,offset=1.0),operator=numpy.multiply)
transferfn.misc.PatternCombine(generator=pattern.random.GaussianRandom(scale=0.1,offset=-0.05),operator=numpy.add))
</pre></div>
</div>
</div></blockquote>
<p>where the offset and scale parameters determine the mean value and
the range of the variation, respectively, the operator determines
whether the noise is multiplicative, divisive, or some other type of
combination, and the noise itself can either be Uniform or Gaussian
(i.e., normal), or even some some user-defined distribution. There
are also some other noise-related TransferFns available, such as
ProportionalGaussian (variance proportional to the mean).</p>
<p>Hints: For additive UniformRandom noise, if you are modelling
non-zero background levels of activity in a Sheet or Projection, you
can use an offset of zero and a scale that is the level of noise you
want. In other cases where you want to avoid changing the average
activity levels, you can get zero-mean UniformRandom additive noise
by making the offset be a negative number that is half of the scale.
To keep the average activity levels constant with multiplicative
noise requires an offset of 1.0-scale/2.0; the scale then determines
the noise level. You can of course combine both types of noise in
succession, in which case you will typically want to do the
multiplicative noise first, to avoid scaling the additive noise.
Note that GaussianRandom noise is zero mean already; the difference
compared to UniformRandom is for historical reasons.</p>
<p>As an example, to inject zero-mean additive uniform random noise
into the LateralExcitatory Projection of a LISSOM-based model, just
change e.g.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">output_fns</span><span class="o">=</span><span class="p">[]</span>
</pre></div>
</div>
<p>(if output_fns are specified) to e.g.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">output_fns</span><span class="o">=</span><span class="p">[</span><span class="n">transferfn</span><span class="o">.</span><span class="n">misc</span><span class="o">.</span><span class="n">PatternCombine</span><span class="p">(</span><span class="n">generator</span><span class="o">=</span><span class="n">pattern</span><span class="o">.</span><span class="n">random</span><span class="o">.</span>\
    <span class="n">UniformRandom</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">offset</span><span class="o">=-</span><span class="mf">0.05</span><span class="p">),</span><span class="n">operator</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">add</span><span class="p">)]</span>
</pre></div>
</div>
<p>Some networks may not state &#8220;output_fns=[]&#8221; explicitly, in which
case just add the entire string above to the definition of that
projection in the .ty file. To see the results immediately, just run
the network for one step, then visualize the Projection Activity and
the final Activity. The long-term effects of this noise can then be
evaluated by running for longer periods.</p>
</div>
<div class="section" id="projection-mapping-jitter">
<h2>Projection mapping jitter<a class="headerlink" href="#projection-mapping-jitter" title="Permalink to this headline">¶</a></h2>
<p>Another important way to add variability is to add jitter when the
initial mapping between sheets is set up, i.e. to disturb the
topographic mapping of a CFProjection&#8217;s Connection Fields from the
input sheet. The mapping of a CFProjection is controlled by a
parameter &#8220;coord_mapper&#8221;, which by default does a perfect
topographic mapping that makes analysis easier, but is too ideal to
be realistic. Instead, you can specify a jittered mapping for the
CFProjection, by adding:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">coord_mapper</span> <span class="o">=</span> <span class="n">coordmapper</span><span class="o">.</span><span class="n">Jitter</span><span class="p">(</span><span class="n">gen</span><span class="o">=</span><span class="n">numbergen</span><span class="o">.</span><span class="n">UniformRandom</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">1023</span><span class="p">),</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
<p>to the topo.sim.connect command, to offset the values by a random
amount in the range plus or minus 0.1 Sheet coordinates around the
precisely topographic mapped value. The results can be visualized by
plotting the Projection and enabling &#8220;Situate&#8221;. Once set up, the
jitter of the CF boundaries will always be present, but the weights
inside the boundaries may reorganize to remove the effect of the
jittering.</p>
<p>Note that the seed value allows you to control which specific
pattern of jitter is used, e.g. if you want two different
Projections of the same shape to have the same specific jittered
values (e.g. for matching ON and OFF projections). Different seeds
will allow the projections to be jittered independently of each
other.</p>
<p>Also note that the coord_mapper varies the <em>incoming</em> connection
field location. Because of how connection fields are currently
implemented, it is much more difficult to vary the outgoing
connection field location. In the case of the LGN-&gt;V1 projection,
one can instead add jitter to the Retina-&gt;LGN projection, which
effectively varies the outgoing connection field of the LGN.</p>
</div>
<div class="section" id="connectionfield-shape-noise">
<h2>ConnectionField shape noise<a class="headerlink" href="#connectionfield-shape-noise" title="Permalink to this headline">¶</a></h2>
<p>Another type of noise is differences in the connection field shapes
between neurons in the same projection. Most of the example .ty
files specify simple circular weights outlines, and to save memory
by default all CFs in a projection share the same weight outline. If
you want to try using noisy outlines where only some values within
the circle have any effect, first set
CFProjection.same_cf_shape_for_all_cfs=False, then set
CFProjection.cf_shape to a PatternGenerator that returns different
results each time it is evaluated. By default, dynamic parameters in
Topographica only advance once per simulation time, so it is next
necessary to call
CFProjection.cf_shape.set_dynamic_time_fn(None), causing the
PatternGenerator&#8217;s dynamic values to change each time it is
evaluated. Note that one further command may be necessary in some
cases: by default, the PatternGenerator used for cf_shape has its
size set automatically; if instead you want to control the size, set
CFProjection.autosize_mask to be False.</p>
</div>
<div class="section" id="weight-adjustment-noise">
<h2>Weight adjustment noise<a class="headerlink" href="#weight-adjustment-noise" title="Permalink to this headline">¶</a></h2>
<p>One could imagine the process of adjusting weights to be a
stochastic or quantized process, either of which would give some
variability to the process of updating weight values. For instance,
this could be modeled with additive or multiplicative noise before
or after any weight normalization.</p>
</div>
<div class="section" id="spatially-correlated-noise">
<h2>Spatially correlated noise<a class="headerlink" href="#spatially-correlated-noise" title="Permalink to this headline">¶</a></h2>
<p>The examples above focus on types of noise that are spatially
uncorrelated, i.e. where the noise for each unit or weight or
Connection Field is chosen independently of all others of that type.
Many kinds of &#8220;noise&#8221; in biological systems will have spatial
correlations, e.g. due to some underlying source that has a spatial
extent (such as the vasculature, some diffusible chemical, etc.). To
include such effects for the noise sources described above
(output_fns), you could add new classes in topo.pattern.random that
generate spatially correlated noise rather than noise that is
independent per pixel. E.g., the noise matrix could be convolved
with a small blurring kernel before it is added or multiplied with
the activity, or the noise matrix could be low-pass filtered, e.g.
to create the 1/f noise (pink noise) that is common in physical
systems.</p>
</div>
<div class="section" id="measurement-noise">
<h2>Measurement noise<a class="headerlink" href="#measurement-noise" title="Permalink to this headline">¶</a></h2>
<p>One could also consider the effects of measurement noise, e.g. on
computing preference maps, which could be done by temporarily
modifying the output_fns of each sheet so that what is measured is
no longer the actual activity value, but a transformation of it. A
better approach would probably be to add an output_fns parameter to
the commands for measuring maps, so that such functions could be
supplied for any measurement.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/topo-banner7.png" alt="Logo"/>
            </a></p>
<ul class="global-toc">

<li><a href="../index.html">Home</a></li>
<li><a href="../News/index.html">News</a></li>
<li><a href="../Downloads/index.html">Downloads</a></li>
<li><a href="../Tutorials/index.html">Tutorials</a></li>
<li><a href="index.html">User Manual</a></li>
<li><a href="../Reference_Manual/index.html">Reference Manual</a></li>
<li><a href="../Developer_Manual/index.html">Developer Manual</a></li>
<li><a href="http://github.com/ioam/topographica">Github Source Code</a></li>
<li><a href="../Forums/index.html">Forums</a></li>
<li><a href="../Team_Members/index.html">Team Members</a></li>
<li><a href="../Future_Work/index.html">Future Work</a></li>
<li><a href="../FAQ/index.html">FAQ</a></li>
<li><a href="../Links/index.html">Links</a></li>
<li><a href="../Home/pubs.html">Publications</a></li>
<li><a href="../site_map.html">Site Map</a></li>
</ul>
<h3><a href="../index.html">Table Of Contents</a></h3>

<ul>
<li><a class="reference internal" href="#">Adding noise to Topographica</a><ul>
<li><a class="reference internal" href="#additive-and-multiplicative-noise-in-output-fns">Additive and multiplicative noise in output_fns</a></li>
<li><a class="reference internal" href="#projection-mapping-jitter">Projection mapping jitter</a></li>
<li><a class="reference internal" href="#connectionfield-shape-noise">ConnectionField shape noise</a></li>
<li><a class="reference internal" href="#weight-adjustment-noise">Weight adjustment noise</a></li>
<li><a class="reference internal" href="#spatially-correlated-noise">Spatially correlated noise</a></li>
<li><a class="reference internal" href="#measurement-noise">Measurement noise</a></li>
</ul>
</li>
</ul>


<h3>This Page</h3>
<ul class="this-page-menu">
	<li><a	href="https://github.com/ioam/topographica/edit/master/doc/User_Manual/noise.rst" rel="nofollow">Edit on GitHub</a></li>
    <li><a	href="http://doozy.inf.ed.ac.uk:8010/builders/topographica_docs" rel="nofollow">Rebuild docs</a></li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>

<li><a href="../index.html">Home</a></li>
<li><a href="../Downloads/index.html">Downloads</a></li>
<li><a href="../Tutorials/index.html">Tutorials</a></li>
<li><a href="index.html">User Manual</a></li>







      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, IOAM.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>