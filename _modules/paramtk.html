
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>paramtk &mdash; The Topographica Neural Map Simulator</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/topo.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.98',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/topo.js"></script>
    <link rel="top" title="The Topographica Neural Map Simulator" href="../index.html" />
    <link rel="up" title="Module code" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
<li><a href="../index.html">Home</a></li>
<li><a href="../Downloads/index.html">Downloads</a></li>
<li><a href="../Tutorials/index.html">Tutorials</a></li>
<li><a href="../User_Manual/index.html">User Manual</a></li>


<li><ul class="parents">



          <li><a href="index.html" accesskey="U">Module code</a> &raquo;</li>

</ul></li>


      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for paramtk</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Classes linking Parameters to Tkinter.</span>

<span class="sd">TkParameterized allows flexible graphical representation and</span>
<span class="sd">manipulation of the parameters of a Parameterized instance or class.</span>

<span class="sd">ParametersFrame and ParametersFrameWithApply extend TkParameterized,</span>
<span class="sd">displaying all the Parameters together in a list. Both allow these</span>
<span class="sd">Parameters to be edited; ParametersFrame applies changes immediately</span>
<span class="sd">as they are made, whereas ParametersFrameWithApply makes no changes</span>
<span class="sd">until a confirmation is given (by pressing the &#39;Apply&#39; button).</span>

<span class="sd">Using these classes to display parameters has several benefits,</span>
<span class="sd">including that, automatically:</span>

<span class="sd">- changes to the Parameters in the GUI are reflected in the objects</span>
<span class="sd">  themselves without any additional code;</span>

<span class="sd">- each Parameter is represented by an appropriate widget (e.g. slider</span>
<span class="sd">  for a Number);</span>

<span class="sd">- type and range checking is handled (by virtue of using parameters);</span>

<span class="sd">- doc strings are displayed as pop-up help for each parameter;</span>

<span class="sd">- parameter names are formatted nicely for display;</span>

<span class="sd">- changes to parameter values in the GUI can be associated with</span>
<span class="sd">  function calls.</span>


<span class="sd">Examples</span>
<span class="sd">========</span>

<span class="sd">(1) Display the parameters of an object inside an existing window</span>

<span class="sd">You want to display all parameters of a parameterized instance</span>
<span class="sd">inside an existing container (e.g. a window or a frame):</span>

<span class="sd">  # existing Parameterized instance g</span>
<span class="sd">  from topo import pattern</span>
<span class="sd">  g = pattern.Gaussian()</span>

<span class="sd">  # existing window t</span>
<span class="sd">  import Tkinter</span>
<span class="sd">  t = Tkinter.Toplevel()</span>

<span class="sd">  # display all the parameters of g in t</span>
<span class="sd">  from topo.param.tk import ParametersFrame</span>
<span class="sd">  ParametersFrame(t,g)</span>
<span class="sd">  #should be ParametersFrame(t,g).pack(); see ALERT in ParametersFrame</span>


<span class="sd">(2) Display the parameters of an object in a standalone window</span>

<span class="sd">You want a new window displaying only the parameters of your object:</span>

<span class="sd">  # existing Parameterized instance g</span>
<span class="sd">  from topo import pattern</span>
<span class="sd">  g = pattern.Gaussian()</span>

<span class="sd">  # display all the parameters of g in a new window</span>
<span class="sd">  from topo.param.tk import edit_parameters</span>
<span class="sd">  edit_parameters(g)</span>


<span class="sd">(3) Flexible GUI layout using TkParameterized</span>

<span class="sd">You want to display only some of the parameters of one or more</span>
<span class="sd">Parameterized instances:</span>

<span class="sd"> ## Existing, non-GUI code</span>
<span class="sd"> from topo import param</span>

<span class="sd"> class Object1(param.Parameterized):</span>
<span class="sd">     duration = param.Number(2.0,bounds=(0,None),doc=&#39;Duration of measurement&#39;)</span>
<span class="sd">     displacement = param.Number(0.0,bounds=(-1,1),doc=&#39;Displacement from point A&#39;)</span>

<span class="sd"> class Object2(param.Parameterized):</span>
<span class="sd">     active_today = param.Boolean(True,doc=&#39;Whether or not to count today&#39;)</span>
<span class="sd">     operator_name = param.String(&#39;A. Person&#39;,doc=&#39;Operator today&#39;)</span>

<span class="sd"> o1 = Object1()</span>
<span class="sd"> o2 = Object2()</span>

<span class="sd"> ## Existing window</span>
<span class="sd"> import Tkinter</span>
<span class="sd"> t = Tkinter.Toplevel()</span>

<span class="sd"> ## Flexible GUI representation: display o1.duration, o1.displacement,</span>
<span class="sd"> ## and o2.active_today inside t, ignoring o2.operator_name</span>
<span class="sd"> from topo.param.tk import TkParameterized</span>

<span class="sd"> t1 = TkParameterized(t,o1)</span>
<span class="sd"> t2 = TkParameterized(t,o2)</span>

<span class="sd"> t1.pack_param(&#39;duration&#39;,side=&#39;left&#39;)</span>
<span class="sd"> t1.pack_param(&#39;displacement&#39;,side=&#39;bottom&#39;)</span>
<span class="sd"> t2.pack_param(&#39;active_today&#39;,side=&#39;right&#39;)</span>


<span class="sd">(4) ?</span>

<span class="sd">TkParameterized is itself a subclass of Parameterized, so a</span>
<span class="sd">TkParameterized class can have its own parameters (in addition to</span>
<span class="sd">representing those of an external parameterized instance or class).</span>

<span class="sd">  ## Existing class</span>
<span class="sd">  from topo import params</span>

<span class="sd">  class X(param.Parameterized):</span>
<span class="sd">      one = param.Boolean(True)</span>
<span class="sd">      two = param.Boolean(True)</span>


<span class="sd">  ## Panel to represent an instance of X</span>
<span class="sd">  from Tkinter import Frame</span>
<span class="sd">  from topo.param.tk import TkParameterized</span>

<span class="sd">  class XPanel(TkParameterized,Frame):</span>

<span class="sd">      dock = param.Boolean(False,doc=&#39;Whether to attach this Panel&#39;)</span>

<span class="sd">      def __init__(self,master,x):</span>
<span class="sd">          self.pack_param(&#39;dock&#39;,side=&#39;top&#39;,on_set=self.handle_dock)</span>
<span class="sd">          self.pack_param(&#39;one&#39;,side=&#39;left&#39;)</span>
<span class="sd">          self.pack_param(&#39;two&#39;,side=&#39;right&#39;)</span>

<span class="sd">      def handle_dock(self):</span>
<span class="sd">          if self.dock:</span>
<span class="sd">              # dock the window</span>
<span class="sd">          else:</span>
<span class="sd">              # undock the window</span>


<span class="sd">  ## Running the code</span>
<span class="sd">  t = Tkinter.Toplevel()</span>
<span class="sd">  x = X()</span>
<span class="sd">  XPanel(t,x)</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c"># CEBALERT: moving todo</span>
<span class="c"># (1) move icons from topo/tkgui.</span>
<span class="c"># (2) update documentation</span>


<span class="c"># CB: This file is too long because the param/gui interface code has</span>
<span class="c"># become too long, and needs cleaning up.  I&#39;m still working on it</span>
<span class="c"># (still have to attend to simple ALERTs and do a one-pass cleanup)</span>

<span class="c"># It&#39;s quite likely that the way TkParameterizedBase is implemented</span>
<span class="c"># could be simplified. Right now, it still contains leftovers of</span>
<span class="c"># various attempts to get everything working. But it does seem to</span>
<span class="c"># work!</span>


<span class="c">## import logging</span>
<span class="c">## import string,time</span>
<span class="c">## log_name= &#39;guilog_%s&#39;%string.join([str(i) for i in list(time.gmtime())],&quot;&quot;)</span>

<span class="c">## logging.basicConfig(level=logging.DEBUG,</span>
<span class="c">##                     format=&#39;%(asctime)s %(levelname)s %(message)s&#39;,</span>
<span class="c">##                     filename=&#39;topo/tkgui/%s&#39;%log_name,</span>
<span class="c">##                     filemode=&#39;w&#39;)</span>
<span class="c">## from os import popen</span>
<span class="c">## version = popen(&#39;svnversion -n&#39;).read()</span>
<span class="c">## logging.info(&quot;tkgui logging started for %s&quot;%version)</span>


<span class="kn">import</span> <span class="nn">__main__</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">decimal</span>
<span class="kn">import</span> <span class="nn">os.path</span>

<span class="kn">import</span> <span class="nn">Tkinter</span> <span class="kn">as</span> <span class="nn">T</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">Image</span><span class="o">,</span> <span class="nn">ImageOps</span><span class="o">,</span> <span class="nn">ImageTk</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">ImageOps</span><span class="p">,</span> <span class="n">ImageTk</span> <span class="c"># pyflakes:ignore (try/except import)</span>


<span class="kn">from</span> <span class="nn">inspect</span> <span class="kn">import</span> <span class="n">getdoc</span>

<span class="kn">from</span> <span class="nn">tkMessageBox</span> <span class="kn">import</span> <span class="n">_show</span><span class="p">,</span><span class="n">QUESTION</span><span class="p">,</span><span class="n">YESNO</span>

<span class="kn">from</span> <span class="nn">param.parameterized</span> <span class="kn">import</span> <span class="n">Parameterized</span><span class="p">,</span><span class="n">ParameterizedMetaclass</span><span class="p">,</span>\
     <span class="n">classlist</span>

<span class="c"># CEBALERT: try to import from python 2.7&#39;s ttk first</span>
<span class="kn">from</span> <span class="nn">tilewrapper</span> <span class="kn">import</span> <span class="n">Combobox</span><span class="p">,</span><span class="n">Progressbar</span>

<span class="c"># CEBALERT: try to import python 2.7&#39;s ordered dictionary first</span>
<span class="kn">from</span> <span class="nn">odict</span> <span class="kn">import</span> <span class="n">OrderedDict</span>

<span class="kn">from</span> <span class="nn">param</span> <span class="kn">import</span> <span class="n">Boolean</span><span class="p">,</span><span class="n">String</span><span class="p">,</span><span class="n">Number</span><span class="p">,</span><span class="n">Selector</span><span class="p">,</span><span class="n">ClassSelector</span><span class="p">,</span>\
     <span class="n">ObjectSelector</span><span class="p">,</span><span class="n">Callable</span><span class="p">,</span><span class="n">Dynamic</span><span class="p">,</span><span class="n">Parameter</span><span class="p">,</span><span class="n">List</span><span class="p">,</span><span class="n">HookList</span><span class="p">,</span>\
     <span class="n">Filename</span><span class="p">,</span><span class="n">resolve_path</span>


<span class="c"># (part of an existing ALERT - search this file)</span>
<span class="n">_last_one_set</span> <span class="o">=</span> <span class="bp">None</span>


<span class="c"># CEBALERT: Tkinter.BooleanVar.get() doesn&#39;t support None. This is a</span>
<span class="c"># hack because there&#39;s no way in the GUI to visually distinguish a</span>
<span class="c"># &quot;None&quot; from a &quot;False&quot;.</span>
<span class="k">def</span> <span class="nf">_BooleanVar_get</span><span class="p">(</span><span class="n">instance</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">instance</span><span class="o">.</span><span class="n">_tk</span><span class="o">.</span><span class="n">getboolean</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">_tk</span><span class="o">.</span><span class="n">globalgetvar</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">_name</span><span class="p">))</span> <span class="c"># i.e. BooleanVar.get()</span>
    <span class="k">except</span> <span class="n">T</span><span class="o">.</span><span class="n">TclError</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">instance</span><span class="o">.</span><span class="n">_tk</span><span class="o">.</span><span class="n">globalgetvar</span><span class="p">(</span><span class="n">instance</span><span class="o">.</span><span class="n">_name</span><span class="p">)</span> <span class="c"># i.e. Variable.get()</span>


<span class="n">root</span> <span class="o">=</span> <span class="bp">None</span>
<div class="viewcode-block" id="initialize"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.initialize">[docs]</a><span class="k">def</span> <span class="nf">initialize</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add extension Tcl/Tk code to the Tk instance at</span>
<span class="sd">    Tkinter._default_root (creating the Tk instance first if</span>
<span class="sd">    necessary).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">root</span>

    <span class="k">if</span> <span class="n">root</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&quot;param.tk already initialized; ignoring call to param.tk.initialize()&quot;</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="n">T</span><span class="o">.</span><span class="n">_default_root</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">_default_root</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
        <span class="n">root</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span>

    <span class="c"># Until tklib, tcllib, and scrodget become more commonly</span>
    <span class="c"># available, we include them in tkgui.</span>
    <span class="n">externaltcl_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">__file__</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="s">&quot;tcl&quot;</span><span class="p">)</span>
    <span class="n">root</span><span class="o">.</span><span class="n">tk</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s">&quot;lappend&quot;</span><span class="p">,</span><span class="s">&quot;auto_path&quot;</span><span class="p">,</span><span class="n">externaltcl_path</span><span class="p">)</span>

    <span class="n">T</span><span class="o">.</span><span class="n">BooleanVar</span><span class="o">.</span><span class="n">get</span> <span class="o">=</span> <span class="n">_BooleanVar_get</span>


</div>
<div class="viewcode-block" id="inverse"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.inverse">[docs]</a><span class="k">def</span> <span class="nf">inverse</span><span class="p">(</span><span class="n">dict_</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the inverse of dictionary dict_.</span>

<span class="sd">    (I.e. return a dictionary with keys that are the values of dict_,</span>
<span class="sd">    and values that are the corresponding keys from dict_.)</span>

<span class="sd">    The values of dict_ must be unique.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">idict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">value</span><span class="p">,</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="n">dict_</span><span class="o">.</span><span class="n">iteritems</span><span class="p">()])</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">idict</span><span class="p">)</span><span class="o">!=</span><span class="nb">len</span><span class="p">(</span><span class="n">dict_</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Dictionary has no inverse (values not unique).&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">idict</span>

</div>
<div class="viewcode-block" id="lookup_by_class"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.lookup_by_class">[docs]</a><span class="k">def</span> <span class="nf">lookup_by_class</span><span class="p">(</span><span class="n">dict_</span><span class="p">,</span><span class="n">class_</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Look for class_ or its superclasses in the keys of dict_; on</span>
<span class="sd">    finding a match, return the value (return None if no match found).</span>

<span class="sd">    Searches from the most immediate class to the most distant</span>
<span class="sd">    (i.e. from class_ to the final superclass of class_).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">v</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">classlist</span><span class="p">(</span><span class="n">class_</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">dict_</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">dict_</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">v</span>

</div>
<div class="viewcode-block" id="keys_sorted_by_value"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.keys_sorted_by_value">[docs]</a><span class="k">def</span> <span class="nf">keys_sorted_by_value</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the keys of dictionary d sorted by value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># By Daniel Schult, 2004/01/23</span>
    <span class="c"># http://aspn.activestate.com/ASPN/Python/Cookbook/Recipe/52306</span>
    <span class="n">items</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="n">backitems</span><span class="o">=</span><span class="p">[</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">items</span><span class="p">]</span>
    <span class="n">backitems</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">[</span> <span class="n">backitems</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">backitems</span><span class="p">))]</span>

</div>
<div class="viewcode-block" id="keys_sorted_by_value_unique"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.keys_sorted_by_value_unique">[docs]</a><span class="k">def</span> <span class="nf">keys_sorted_by_value_unique</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="o">**</span><span class="n">sort_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the keys of d, sorted by value.</span>

<span class="sd">    The values of d must be unique (see inverse)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    <span class="n">values</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="o">**</span><span class="n">sort_kwargs</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">inverse</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="n">val</span><span class="p">]</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="keys_sorted_by_value_unique_None_safe"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.keys_sorted_by_value_unique_None_safe">[docs]</a><span class="k">def</span> <span class="nf">keys_sorted_by_value_unique_None_safe</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="o">**</span><span class="n">sort_kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    None is handled separately: if present, it always comes out at the</span>
<span class="sd">    end of the list. Allows callers to use any sort function without</span>
<span class="sd">    worrying that None will not match the other objects (e.g. for</span>
<span class="sd">    using an attribute present on all the other objects, such as</span>
<span class="sd">    precedence of sheets).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s">&#39;None&#39;</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">d</span><span class="p">[</span><span class="s">&#39;None&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span>
        <span class="n">None_in_d</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">None_in_d</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">if</span> <span class="n">None_in_d</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">d</span><span class="p">[</span><span class="s">&#39;None&#39;</span><span class="p">]</span>

    <span class="n">sorted_keys</span> <span class="o">=</span> <span class="n">keys_sorted_by_value_unique</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="o">**</span><span class="n">sort_kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">None_in_d</span><span class="p">:</span>
        <span class="n">d</span><span class="p">[</span><span class="s">&#39;None&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">None</span>
        <span class="n">sorted_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;None&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sorted_keys</span>

</div>
<div class="viewcode-block" id="is_button"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.is_button">[docs]</a><span class="k">def</span> <span class="nf">is_button</span><span class="p">(</span><span class="n">widget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simple detection of Button-like widgets that are not Checkbuttons</span>
<span class="sd">    (i.e. widgets that do not require a separate label).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># CEBALERT: document why try/except is needed</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">button</span> <span class="o">=</span> <span class="s">&#39;command&#39;</span> <span class="ow">in</span> <span class="n">widget</span><span class="o">.</span><span class="n">config</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span><span class="s">&#39;toggle&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">T</span><span class="o">.</span><span class="n">TclError</span><span class="p">:</span>
        <span class="n">button</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">return</span> <span class="n">button</span>


<span class="c">#################################################################</span>
<span class="c"># Very basic wrapper for scrodget</span></div>
<span class="k">class</span> <span class="nc">ScrodgetWidget</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">_require</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">):</span>
        <span class="n">master</span><span class="o">.</span><span class="n">tk</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s">&quot;package&quot;</span><span class="p">,</span> <span class="s">&quot;require&quot;</span><span class="p">,</span> <span class="s">&quot;scrodget&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">,</span> <span class="n">cnf</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_require</span><span class="p">(</span><span class="n">master</span><span class="p">)</span>
        <span class="n">T</span><span class="o">.</span><span class="n">Widget</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">,</span> <span class="s">&#39;scrodget&#39;</span><span class="p">,</span> <span class="n">cnf</span><span class="p">,</span> <span class="n">kw</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Scrodget</span><span class="p">(</span><span class="n">ScrodgetWidget</span><span class="p">,</span> <span class="n">T</span><span class="o">.</span><span class="n">Widget</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">associate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">widget</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tk</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_w</span><span class="p">,</span><span class="s">&quot;associate&quot;</span><span class="p">,</span><span class="n">widget</span><span class="p">)</span>
<span class="c">#################################################################</span>



<span class="c"># CEB: workaround for tkinter lagging behind tk (tk must have changed</span>
<span class="c"># the type of a returned value).  This is copied almost exactly from</span>
<span class="c"># tkMessageBox. If there are other things like this, we could have the</span>
<span class="c"># gui load some &#39;dynamic patches&#39; to tkinter on startup, which could</span>
<span class="c"># then be removed when tkinter is updated (they&#39;d all be in one place,</span>
<span class="c"># and no tkgui code would have to change).</span>
<div class="viewcode-block" id="askyesno"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.askyesno">[docs]</a><span class="k">def</span> <span class="nf">askyesno</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
    <span class="s">&quot;Ask a question; return true if the answer is yes&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">_show</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">QUESTION</span><span class="p">,</span> <span class="n">YESNO</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="s">&quot;yes&quot;</span>



<span class="c"># Buttons are not naturally represented by parameters?</span>
<span class="c">#</span>
<span class="c"># Maybe we should have a parent class that implements the</span>
<span class="c"># non-Parameter specific stuff, then one that bolts on the</span>
<span class="c"># Parameter-specific stuff, and then instead of Button we&#39;d</span>
<span class="c"># have TopoButton, or something like that...</span></div>
<div class="viewcode-block" id="Button"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.Button">[docs]</a><span class="k">class</span> <span class="nc">Button</span><span class="p">(</span><span class="n">Callable</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A GUI-specific parameter to display a button.</span>

<span class="sd">    Can be associated with an image by specifying an image_path</span>
<span class="sd">    (i.e. location of an image suitable for PIL, e.g. a PNG, TIFF, or</span>
<span class="sd">    JPEG image) and optionally a size (width,height) tuple.</span>

<span class="sd">    Note that the button size can also be set when there is no image,</span>
<span class="sd">    but instead of being presumed to be in pixels, it is presumed to</span>
<span class="sd">    be in text units (a Tkinter feature: see</span>
<span class="sd">    e.g. http://effbot.org/tkinterbook/button.htm). Therefore, to</span>
<span class="sd">    place two identically sized buttons next to each other, with one</span>
<span class="sd">    displaying text and the other an image, you first have to convert</span>
<span class="sd">    one of the sizes to the other&#39;s units.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># CEBALERT: we should probably solve the above for users,</span>
    <span class="c"># but what a pain!</span>
    <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;image_path&#39;</span><span class="p">,</span><span class="s">&#39;size&#39;</span><span class="p">,</span><span class="s">&#39;_hack&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">image_path</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="n">Callable</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image_path</span> <span class="o">=</span> <span class="n">image_path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hack</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c"># CB: would create the photoimage on construction and store it as an</span>
<span class="c"># attribute, except that it gives &quot;RuntimeError: Too early to create</span>
<span class="c"># image&quot;. Must be happening before tk starts, or something. So</span>
<span class="c"># instead, return image on demand. Also, because of PIL bug (see</span>
<span class="c"># topoconsole.py &quot;got to keep references to the images&quot;) we store</span>
<span class="c"># a reference to the image each time in _hack.</span>
    <span class="k">def</span> <span class="nf">get_image</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return an ImageTk.PhotoImage of the image at image_path</span>
<span class="sd">        (or None if image_path is None or an Image cannot be created).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">image</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">image_path</span><span class="p">:</span>
            <span class="n">image</span><span class="o">=</span><span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">ImageOps</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
                <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">resolve_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">image_path</span><span class="p">)),</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="ow">or</span> <span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="mi">32</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_hack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">image</span>




<span class="c"># Note that TkParameterized extends TkParameterizedBase by adding</span>
<span class="c"># widget-drawing abilities; documentation for using these classes</span>
<span class="c"># begins at a more useful and simple level in TkParameterized (the</span>
<span class="c"># documentation for TkParameterizedBase is more complex).</span></div>
<div class="viewcode-block" id="TkParameterizedBase"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.TkParameterizedBase">[docs]</a><span class="k">class</span> <span class="nc">TkParameterizedBase</span><span class="p">(</span><span class="n">Parameterized</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Parameterized subclass that maintains Tkinter.Variable shadows</span>
<span class="sd">    (proxies) of its Parameters. The Tkinter Variable shadows are kept</span>
<span class="sd">    in sync with the Parameter values, and vice versa.</span>

<span class="sd">    Optionally performs the same for an *additional* shadowed</span>
<span class="sd">    Parameterized (extraPO). The Parameters of the extra</span>
<span class="sd">    shadowed PO are available via this object (via both the usual</span>
<span class="sd">    &#39;dot&#39; attribute access and dedicated parameter accessors</span>
<span class="sd">    declared in this class).</span>

<span class="sd">    The Tkinter.Variable shadows for this Parameterized and any</span>
<span class="sd">    extra shadowed one are available under their corresponding</span>
<span class="sd">    parameter names in the _tkvars dictionary.</span>

<span class="sd">    (See note 1 for complications arising from name clashes.)</span>


<span class="sd">    Parameters being represented by TkParameterizedBase also</span>
<span class="sd">    have a &#39;translators&#39; dictionary, allowing mapping between string</span>
<span class="sd">    representations of the objects and the objects themselves (for use</span>
<span class="sd">    with e.g. a Tkinter.OptionMenu). More information about the</span>
<span class="sd">    translators is available from specific translator-related methods</span>
<span class="sd">    in this class.</span>


<span class="sd">    Notes</span>
<span class="sd">    =====</span>

<span class="sd">    (1) (a) There is an order of precedance for parameter lookup:</span>
<span class="sd">        this PO &gt; shadowed PO.</span>

<span class="sd">        Therefore, if you create a Parameter for this PO</span>
<span class="sd">        with the same name as one of the shadowed PO&#39;s Parameters, only</span>
<span class="sd">        the Parameter on this PO will be shadowed.</span>

<span class="sd">        Example: &#39;name&#39; is a common attribute. As a</span>
<span class="sd">        Parameterized, this object has a &#39;name&#39; Parameter. Any</span>
<span class="sd">        shadowed PO will also have a &#39;name&#39; Parameter. By default,</span>
<span class="sd">        this object&#39;s name will be shadowed at the expense of the name</span>
<span class="sd">        of the extra shadowed PO.</span>

<span class="sd">        The precedence order can be reversed by setting the attribute</span>
<span class="sd">        &#39;self_first&#39; on this object to False.</span>


<span class="sd">        (b) Along the same lines, an additional complication can arise</span>
<span class="sd">        relating specifically to &#39;dot&#39; attribute lookup.  For</span>
<span class="sd">        instance, a sublass of TkParameterized might also</span>
<span class="sd">        inherit from Tkinter.Frame. Frame has many of its own</span>
<span class="sd">        attributes, including - for example - &#39;size&#39;. If we shadow a</span>
<span class="sd">        Parameterized that has a &#39;size&#39; Parameter, the</span>
<span class="sd">        Parameterized&#39;s size Parameter will not be available as</span>
<span class="sd">        .size because (&#39;dot&#39;) attribute lookup begins on the local</span>
<span class="sd">        object and is not overridden by &#39;self_first&#39;. Using the</span>
<span class="sd">        parameter accessors .get_parameter_object(&#39;size&#39;) or</span>
<span class="sd">        .get_parameter_value(&#39;size&#39;) (and the equivalent set versions)</span>
<span class="sd">        avoids this problem.</span>



<span class="sd">    (2) If a shadowed PO&#39;s Parameter value is modified elsewhere, the</span>
<span class="sd">        Tkinter Variable shadow is NOT updated until that Parameter value</span>
<span class="sd">        or shadow value is requested from this object. Thus requesting the</span>
<span class="sd">        value will always return an up-to-date result, but any GUI display</span>
<span class="sd">        of the Variable might display a stale value (until a GUI refresh</span>
<span class="sd">        takes place).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c"># CEBNOTE: avoid (as far as possible) defining Parameters for this</span>
    <span class="c"># object because they might clash with Parameters of objects it</span>
    <span class="c"># eventually represents.</span>


    <span class="c"># CEBNOTE: Regarding note 1a above...it would be possible - with</span>
    <span class="c"># some extra work - to shadow Parameters that are duplicated on</span>
    <span class="c"># this PO and extraPO. Among other changes, things like the</span>
    <span class="c"># _tkvars dict would need different (e.g. name on this PO and</span>
    <span class="c"># name on extraPO)</span>

    <span class="c"># CEBNOTE: Regarding note 1b...might be less confusing if we stop</span>
    <span class="c"># parameters of shadowed POs being available as attributes (and</span>
    <span class="c"># use only the parameter access methods instead). But having them</span>
    <span class="c"># available as attributes is really convenient.</span>

    <span class="c"># CEBNOTE: Regarding note 2 above...if it becomes a problem, we</span>
    <span class="c"># could have some autorefresh of the vars or a callback of some</span>
    <span class="c"># kind in the parameterized object itself. E.g a</span>
    <span class="c"># refresh-the-widgets-on-focus-in method could make the gui in</span>
    <span class="c"># sync with the actual object (so changes outside the gui could</span>
    <span class="c"># show up when a frame takes focus). Or there could be timer</span>
    <span class="c"># process.</span>

    <span class="c"># CEB: because of note 1, attributes of this class should have</span>
    <span class="c"># names that are unlikely to clash (or they should be private);</span>
    <span class="c"># this will make it easier for creators and users of subclasses to</span>
    <span class="c"># avoid name clashes.</span>

    <span class="c"># must exist *before* an instance is init&#39;d</span>
    <span class="c"># (for __getattribute__)</span>
    <span class="n">_extraPO</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="c"># CEBALERT: Parameterized repr method leads to recursion error.</span>
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="n">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_setup_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parameters that are not in this object itself but are in the</span>
<span class="sd">        extraPO get set on extraPO. Then calls Parameterized&#39;s</span>
<span class="sd">        _setup_params().</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">### a parameter might be passed in for one of the extra_pos;</span>
        <span class="c">### if a key in the params dict is not a *parameter* of this</span>
        <span class="c">### PO, then try it on the extra_pos</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">p</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>

        <span class="n">Parameterized</span><span class="o">.</span><span class="n">_setup_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

    <span class="c"># CEBALERT: rename extraPO...but to what?</span>
    <span class="c"># Rename change_PO() and anything else related.</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">extraPO</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">self_first</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">live_update</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>


<span class="sd">        Translation between displayed values and objects</span>
<span class="sd">        ------------------------------------------------</span>

<span class="sd">        A Parameter has a value, but that might need some processing</span>
<span class="sd">        to become a value suitable for display. For instance, the</span>
<span class="sd">        SheetMask() object &lt;SheetMask SheetMask0001923&gt; ...</span>



<span class="sd">        Important attributes</span>
<span class="sd">        --------------------</span>

<span class="sd">        * _extraPO</span>


<span class="sd">        * self_first</span>
<span class="sd">        Determines precedence order for Parameter lookup:</span>
<span class="sd">        if True, Parameters of this object take priority whenever</span>
<span class="sd">        there is a name clash; if False, Parameters of extraPO take</span>
<span class="sd">        priority.</span>




<span class="sd">        * obj2str_fn &amp; str2obj_fn</span>

<span class="sd">        * translator_creators</span>

<span class="sd">        (Note that in the various dictionaries above, the entry for</span>
<span class="sd">        Parameter serves as a default, since keys are looked up by</span>
<span class="sd">        class, so any Parameter type not specifically listed will be</span>
<span class="sd">        covered by the Parameter entry.)</span>



<span class="sd">        * _tkvars</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">extraPO</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">extraPO</span><span class="p">,</span><span class="n">ParameterizedMetaclass</span><span class="p">)</span> \
                <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">extraPO</span><span class="p">,</span><span class="n">Parameterized</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s"> is not a Parameterized instance or class.&quot;</span><span class="o">%</span><span class="n">extraPO</span><span class="p">)</span>

        <span class="c"># make self.first etc private</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_live_update</span> <span class="o">=</span> <span class="n">live_update</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">self_first</span> <span class="o">=</span> <span class="n">self_first</span>

        <span class="c">## Which Tkinter Variable to use for each Parameter type</span>
        <span class="c"># (Note that, for instance, we don&#39;t include Number:DoubleVar.</span>
        <span class="c"># This is because we use Number to control the type, so we</span>
        <span class="c"># don&#39;t need restrictions from DoubleVar.)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_param_to_tkvar</span> <span class="o">=</span> <span class="p">{</span><span class="n">Boolean</span><span class="p">:</span><span class="n">T</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">,</span>
                                <span class="n">Parameter</span><span class="p">:</span><span class="n">T</span><span class="o">.</span><span class="n">StringVar</span><span class="p">}</span>

        <span class="c"># CEBALERT: Parameter is the base parameter class, but ...</span>
        <span class="c"># at least need a test that will fail when a new param type added</span>
        <span class="c"># Rename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trans</span><span class="o">=</span><span class="p">{</span><span class="n">Parameter</span><span class="p">:</span><span class="n">Eval_ReprTranslator</span><span class="p">,</span>
                    <span class="n">Dynamic</span><span class="p">:</span><span class="n">Eval_ReprTranslator</span><span class="p">,</span>
                    <span class="n">ObjectSelector</span><span class="p">:</span><span class="n">String_ObjectTranslator</span><span class="p">,</span>
                    <span class="n">ClassSelector</span><span class="p">:</span><span class="n">CSPTranslator</span><span class="p">,</span>
                    <span class="n">Number</span><span class="p">:</span><span class="n">Eval_ReprTranslator</span><span class="p">,</span>
                    <span class="n">Boolean</span><span class="p">:</span><span class="n">BoolTranslator</span><span class="p">,</span>
                    <span class="n">String</span><span class="p">:</span><span class="n">DoNothingTranslator</span><span class="p">,</span>
                    <span class="n">List</span><span class="p">:</span><span class="n">ListTranslator</span><span class="p">,</span>
                    <span class="n">HookList</span><span class="p">:</span><span class="n">ListTranslator</span><span class="p">}</span> <span class="c"># CBALERT: sort out inherit.</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">change_PO</span><span class="p">(</span><span class="n">extraPO</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TkParameterizedBase</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>


<div class="viewcode-block" id="TkParameterizedBase.change_PO"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.TkParameterizedBase.change_PO">[docs]</a>    <span class="k">def</span> <span class="nf">change_PO</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">extraPO</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shadow the Parameters of extraPO.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span> <span class="o">=</span> <span class="n">extraPO</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">translators</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c"># (reverse list to respect precedence)</span>
        <span class="k">for</span> <span class="n">PO</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source_POs</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_init_tkvars</span><span class="p">(</span><span class="n">PO</span><span class="p">)</span>

</div>
    <span class="k">def</span> <span class="nf">_init_tkvars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">PO</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create Tkinter Variable shadows of all Parameters of PO.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">param</span> <span class="ow">in</span> <span class="n">PO</span><span class="o">.</span><span class="n">params</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_tkvar</span><span class="p">(</span><span class="n">PO</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">param</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_create_tkvar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">PO</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">param_obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add _tkvars[name] to represent the parameter object with the specified name.</span>

<span class="sd">        The appropriate Variable is used for each Parameter type.</span>

<span class="sd">        Also adds tracing mechanism to keep the Variable and Parameter</span>
<span class="sd">        values in sync, and updates the translator dictionary to map</span>
<span class="sd">        string representations to the objects themselves.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># CEBALERT: should probably delete any existing tkvar for name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_translator</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">param_obj</span><span class="p">)</span>

        <span class="n">tkvar</span> <span class="o">=</span> <span class="n">lookup_by_class</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_param_to_tkvar</span><span class="p">,</span><span class="nb">type</span><span class="p">(</span><span class="n">param_obj</span><span class="p">))()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">tkvar</span>

        <span class="c"># overwrite Variable&#39;s set() with one that will handle</span>
        <span class="c"># transformations to string</span>
        <span class="n">tkvar</span><span class="o">.</span><span class="n">_original_set</span> <span class="o">=</span> <span class="n">tkvar</span><span class="o">.</span><span class="n">set</span>
        <span class="n">tkvar</span><span class="o">.</span><span class="n">set</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">v</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tkvar_set</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>

        <span class="n">tkvar</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_value</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">PO</span><span class="p">))</span>
        <span class="n">tkvar</span><span class="o">.</span><span class="n">_last_good_val</span><span class="o">=</span><span class="n">tkvar</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="c"># for reverting</span>
        <span class="n">tkvar</span><span class="o">.</span><span class="n">trace_variable</span><span class="p">(</span><span class="s">&#39;w&#39;</span><span class="p">,</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">p_name</span><span class="o">=</span><span class="n">name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_gui_set</span><span class="p">(</span><span class="n">p_name</span><span class="p">))</span>
        <span class="c"># CB: Instead of a trace, could we override the Variable&#39;s</span>
        <span class="c"># set() method i.e. trace it ourselves?  Or does too much</span>
        <span class="c"># happen in tcl/tk for that to work?</span>

        <span class="c"># Override the Variable&#39;s get() method to guarantee an</span>
        <span class="c"># out-of-date value is never returned.  In cases where the</span>
        <span class="c"># tkinter val is the most recently changed (i.e. when it&#39;s</span>
        <span class="c"># edited in the gui, resulting in a trace_variable being</span>
        <span class="c"># called), the _original_get() method is used.</span>
        <span class="c"># CEBALERT: what about other users of the variable? Could they</span>
        <span class="c"># be surprised by the result from get()?</span>
        <span class="n">tkvar</span><span class="o">.</span><span class="n">_original_get</span> <span class="o">=</span> <span class="n">tkvar</span><span class="o">.</span><span class="n">get</span>
        <span class="n">tkvar</span><span class="o">.</span><span class="n">get</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="o">=</span><span class="n">name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tkvar_get</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>


<span class="c">################################################################################</span>
<span class="c">#</span>
<span class="c">################################################################################</span>

    <span class="k">def</span> <span class="nf">_handle_gui_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">p_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        * The callback to use for all GUI variable traces/binds *</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_live_update</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_param_from_tkvar</span><span class="p">(</span><span class="n">p_name</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_tkvar_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param_name</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the tk variable to (the possibly transformed-to-string) val.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;_tkvar_set(</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span><span class="n">val</span><span class="p">))</span>
        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_object2string</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>
        <span class="n">tkvar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">param_name</span><span class="p">]</span>
        <span class="n">tkvar</span><span class="o">.</span><span class="n">_original_set</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="c"># trace not called because we&#39;re already in trace,</span>
                                  <span class="c"># and tk disables trace activation during trace</span>


    <span class="c"># CB: separate into update and get?</span>
    <span class="k">def</span> <span class="nf">_tkvar_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the value of the tk variable representing param_name.</span>

<span class="sd">        (Before returning the variable&#39;s value, ensures it&#39;s up to date.)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tk_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">param_name</span><span class="p">]</span><span class="o">.</span><span class="n">_original_get</span><span class="p">()</span>
        <span class="n">po_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_value</span><span class="p">(</span><span class="n">param_name</span><span class="p">)</span>

        <span class="n">po_stringrep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_object2string</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span><span class="n">po_val</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">translators</span><span class="p">[</span><span class="n">param_name</span><span class="p">]</span><span class="o">.</span><span class="n">last_string2object_failed</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">tk_val</span><span class="o">==</span><span class="n">po_stringrep</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">param_name</span><span class="p">]</span><span class="o">.</span><span class="n">_original_set</span><span class="p">(</span><span class="n">po_stringrep</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tk_val</span>


    <span class="k">def</span> <span class="nf">_tkvar_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return True if the displayed value does not equal the object&#39;s</span>
<span class="sd">        value (and False otherwise).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;_tkvar_changed(</span><span class="si">%s</span><span class="s">)&quot;</span><span class="o">%</span><span class="n">name</span><span class="p">)</span>
        <span class="n">displayed_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_string2object</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">_original_get</span><span class="p">())</span>
        <span class="n">object_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_value</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="c">#getattr(self._extraPO,name)</span>

        <span class="c"># use equality check then identity check because e.g.  val</span>
        <span class="c"># starts at 0.5, type 0.8, then type 0.5, need that to be</span>
        <span class="c"># changed is False, but some types cannot be equality compared</span>
        <span class="c"># (can be identity compared).</span>
        <span class="c"># CEBALERT: need to add a unit test to ensure this keeps working.</span>
        <span class="c"># Plus, I need to think about this, because while the above is</span>
        <span class="c"># true for floats, identity tests make more sense for many types</span>
        <span class="c"># (i.e. you want to know the object is the same).</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">displayed_value</span> <span class="o">!=</span> <span class="n">object_value</span><span class="p">:</span>
                <span class="n">changed</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">changed</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">displayed_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">object_value</span><span class="p">:</span>
                <span class="n">changed</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">changed</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;..._v_c return </span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="n">changed</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">changed</span>


    <span class="k">def</span> <span class="nf">_update_param_from_tkvar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Attempt to set the parameter represented by param_name to the</span>
<span class="sd">        value of its corresponding Tkinter Variable.</span>

<span class="sd">        If setting the parameter fails (e.g. an inappropriate value</span>
<span class="sd">        is set for that Parameter type), the Variable is reverted to</span>
<span class="sd">        its previous value.</span>

<span class="sd">        (Called by the Tkinter Variable&#39;s trace_variable() method.)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;TkPOb._update_param_from_tkvar(</span><span class="si">%s</span><span class="s">)&quot;</span><span class="o">%</span><span class="n">param_name</span><span class="p">)</span>

        <span class="n">parameter</span><span class="p">,</span><span class="n">sourcePO</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_object</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span><span class="n">with_source</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="c">### can only edit constant parameters for class objects</span>
        <span class="k">if</span> <span class="n">parameter</span><span class="o">.</span><span class="n">constant</span> <span class="ow">is</span> <span class="bp">True</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sourcePO</span><span class="p">,</span><span class="nb">type</span><span class="p">):</span>
            <span class="k">return</span>  <span class="c">### HIDDEN</span>

        <span class="n">tkvar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">param_name</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tkvar_changed</span><span class="p">(</span><span class="n">param_name</span><span class="p">):</span>
            <span class="c"># don&#39;t attempt to set if there was a string-to-object translation error</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">translators</span><span class="p">[</span><span class="n">param_name</span><span class="p">]</span><span class="o">.</span><span class="n">last_string2object_failed</span><span class="p">:</span>
                <span class="k">return</span>   <span class="c">### HIDDEN</span>

            <span class="c"># (use _original_get() because we don&#39;t want the tkvar to be reset to</span>
            <span class="c"># the parameter&#39;s current value!)</span>
            <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_string2object</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span><span class="n">tkvar</span><span class="o">.</span><span class="n">_original_get</span><span class="p">())</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_parameter</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span> <span class="c"># everything</span>
                <span class="n">tkvar</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">tkvar</span><span class="o">.</span><span class="n">_last_good_val</span><span class="p">)</span>
                <span class="k">raise</span> <span class="c"># whatever the parameter-setting error was</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;set </span><span class="si">%s</span><span class="s"> to </span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span><span class="n">val</span><span class="p">))</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tkvar</span><span class="p">,</span><span class="s">&#39;_on_modify&#39;</span><span class="p">):</span>
                <span class="n">tkvar</span><span class="o">.</span><span class="n">_on_modify</span><span class="p">()</span>

        <span class="c">### call any function associated with GUI set()</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">tkvar</span><span class="p">,</span><span class="s">&#39;_on_set&#39;</span><span class="p">):</span>

            <span class="c"># CEBALERT: provide a way of allowing other gui components</span>
            <span class="c"># to figure out where a callback error might have come</span>
            <span class="c"># from. Callback instances (the Callback class is defined</span>
            <span class="c"># in Tkinter.py) store a widget, but often it appears to</span>
            <span class="c"># be the Tk instance - which is of no use in later</span>
            <span class="c"># determining where an error might have originated.</span>
            <span class="k">global</span> <span class="n">_last_one_set</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s">&#39;master&#39;</span><span class="p">):</span>
                <span class="n">_last_one_set</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span>

            <span class="n">tkvar</span><span class="o">.</span><span class="n">_on_set</span><span class="p">()</span>


<span class="c">################################################################################</span>
<span class="c">#</span>
<span class="c">################################################################################</span>



    <span class="k">def</span> <span class="nf">_source_POs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a list of Parameterizeds in which to find</span>
<span class="sd">        Parameters.</span>

<span class="sd">        The list is ordered by precedence, as defined by self_first.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span><span class="p">:</span>
            <span class="n">sources</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">self_first</span><span class="p">:</span>
            <span class="n">sources</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sources</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span><span class="p">,</span><span class="bp">self</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">sources</span>




<div class="viewcode-block" id="TkParameterizedBase.get_source_po"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.TkParameterizedBase.get_source_po">[docs]</a>    <span class="k">def</span> <span class="nf">get_source_po</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the Parameterized which contains the parameter &#39;name&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source_POs</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">po</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">po</span><span class="o">.</span><span class="n">params</span><span class="p">():</span>
                <span class="k">return</span> <span class="n">po</span>


        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_attr_err_msg</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">sources</span><span class="p">))</span>

</div>
<div class="viewcode-block" id="TkParameterizedBase.get_parameter_object"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.TkParameterizedBase.get_parameter_object">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameter_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">parameterized_object</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">with_source</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the Parameter *object* (not value) specified by name,</span>
<span class="sd">        from the source_POs in this object (or the</span>
<span class="sd">        specified parameterized_object).</span>

<span class="sd">        If with_source=True, returns also the source parameterizedobject.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">source</span> <span class="o">=</span> <span class="n">parameterized_object</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_source_po</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">parameter_object</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">params</span><span class="p">()[</span><span class="n">name</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">with_source</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">parameter_object</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">parameter_object</span><span class="p">,</span><span class="n">source</span>



<span class="c">######################################################################</span>
<span class="c"># Attribute lookup</span>

<span class="c">##### these guarantee only to get/set parameters #####</span></div>
<div class="viewcode-block" id="TkParameterizedBase.get_parameter_value"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.TkParameterizedBase.get_parameter_value">[docs]</a>    <span class="k">def</span> <span class="nf">get_parameter_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">parameterized_object</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the value of the parameter specified by name.</span>

<span class="sd">        If a parameterized_object is specified, looks for the parameter there.</span>
<span class="sd">        Otherwise, looks in the source_POs of this object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">source</span> <span class="o">=</span> <span class="n">parameterized_object</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_source_po</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">source</span><span class="o">.</span><span class="n">get_value_generator</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="c"># CEBALERT: shouldn&#39;t this use __set_parameter? Presumably doing</span>
    <span class="c"># that kind of thing is part of the cleanup required in this file.</span></div>
<div class="viewcode-block" id="TkParameterizedBase.set_parameter_value"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.TkParameterizedBase.set_parameter_value">[docs]</a>    <span class="k">def</span> <span class="nf">set_parameter_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="n">parameterized_object</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the value of the parameter specified by name to val.</span>

<span class="sd">        Updates the corresponding tkvar.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">source</span> <span class="o">=</span> <span class="n">parameterized_object</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_source_po</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="nb">object</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">source</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>

        <span class="c"># update the tkvar</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">_original_set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_object2string</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">))</span>


<span class="c">######################################################</span>

<span class="c">########## these lookup attributes in order ##########</span>
<span class="c"># (i.e. you could get attribute of self rather than a parameter)</span>
<span class="c"># (might remove these to save confusion: they are useful except when</span>
<span class="c">#  someone would be surprised to get an attribute of e.g. a Frame (like &#39;size&#39;) when</span>
<span class="c">#  they were expecting to get one of their parameters. Also, means you can&#39;t set</span>
<span class="c">#  an attribute a on self if a exists on one of the shadowed objects)</span>
<span class="c"># (also they (have to) ignore self_first)</span>
</div>
    <span class="k">def</span> <span class="nf">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If the attribute is found on this object, return it. Otherwise,</span>
<span class="sd">        return the attribute from the extraPO, if it exists.</span>
<span class="sd">        If there is no match, raise an attribute error.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">extraPO</span> <span class="o">=</span> <span class="nb">object</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s">&#39;_extraPO&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">extraPO</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">extraPO</span><span class="p">,</span><span class="n">name</span><span class="p">)</span> <span class="c"># HIDDEN!</span>

            <span class="n">_attr_err_msg</span> <span class="o">=</span> <span class="nb">object</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s">&#39;_attr_err_msg&#39;</span><span class="p">)</span>

            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">_attr_err_msg</span><span class="p">(</span><span class="n">name</span><span class="p">,[</span><span class="bp">self</span><span class="p">,</span><span class="n">extraPO</span><span class="p">]))</span>


    <span class="k">def</span> <span class="nf">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If the attribute already exists on this object, set it. If the attribute</span>
<span class="sd">        is found on the extraPO, set it there. Otherwise, set the</span>
<span class="sd">        attribute on this object (i.e. add a new attribute).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># use dir() not hasattr() because hasattr uses __getattribute__</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">object</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span><span class="o">.</span><span class="n">params</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_parameter_value</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">object</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="c"># name not found, so set on this object</span>
            <span class="nb">object</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>
<span class="c">#######################################################</span>


<span class="c">######################################################################</span>





<span class="c">######################################################################</span>
<span class="c"># Translation between GUI (strings) and true values</span>

    <span class="k">def</span> <span class="nf">_create_translator</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">param</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;_create_translator(</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">param</span><span class="p">))</span>

        <span class="n">translator_type</span> <span class="o">=</span> <span class="n">lookup_by_class</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trans</span><span class="p">,</span><span class="nb">type</span><span class="p">(</span><span class="n">param</span><span class="p">))</span>

        <span class="c"># Dynamic parameters only *might* contain a</span>
        <span class="c"># dynamic value; if such a parameter really is dynamic, we</span>
        <span class="c"># overwrite any more specific class found above</span>
        <span class="c"># (e.g. a Number with a dynamic value will have a numeric</span>
        <span class="c"># translator from above, so we replace that)</span>
        <span class="k">if</span> <span class="n">param_is_dynamically_generated</span><span class="p">(</span><span class="n">param</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">get_source_po</span><span class="p">(</span><span class="n">name</span><span class="p">))</span> <span class="ow">or</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_dynamic</span><span class="p">:</span>
            <span class="n">translator_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trans</span><span class="p">[</span><span class="n">Dynamic</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">translators</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">=</span><span class="n">translator_type</span><span class="p">(</span><span class="n">param</span><span class="p">,</span><span class="n">initial_value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_value</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">translators</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">msg_handler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg_handler</span>




    <span class="c"># CEBALERT: doc replace &amp; rename to plastic or something</span>
    <span class="k">def</span> <span class="nf">_object2string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param_name</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">replace</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If val is one of the objects in param_name&#39;s translator,</span>
<span class="sd">        translate to the string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;object2string(</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span><span class="n">obj</span><span class="p">))</span>
        <span class="n">translator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">translators</span><span class="p">[</span><span class="n">param_name</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">replace</span><span class="p">:</span>
            <span class="n">translator</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">translator</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">translator</span><span class="o">.</span><span class="n">object2string</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_string2object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param_name</span><span class="p">,</span><span class="n">string</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Change the given string for the named parameter into an object.</span>

<span class="sd">        If there is a translator for param_name, translate the string</span>
<span class="sd">        to the object; otherwise, call convert_string2obj on the</span>
<span class="sd">        string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;string2object(</span><span class="si">%s</span><span class="s">,</span><span class="si">%s</span><span class="s">)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span><span class="n">string</span><span class="p">))</span>
        <span class="n">translator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">translators</span><span class="p">[</span><span class="n">param_name</span><span class="p">]</span>
        <span class="n">o</span> <span class="o">=</span> <span class="n">translator</span><span class="o">.</span><span class="n">string2object</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;...s2o return </span><span class="si">%s</span><span class="s">, type </span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">o</span><span class="p">,</span><span class="nb">type</span><span class="p">(</span><span class="n">o</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">o</span>

<span class="c">######################################################################</span>

    <span class="k">def</span> <span class="nf">_attr_err_msg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">attr_name</span><span class="p">,</span><span class="n">objects</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper method: return the &#39;attr_name is not in objects&#39; message.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">objects</span><span class="p">,</span><span class="s">&#39;__len__&#39;</span><span class="p">):</span><span class="n">objects</span><span class="o">=</span><span class="p">[</span><span class="n">objects</span><span class="p">]</span>

        <span class="n">error_string</span> <span class="o">=</span> <span class="s">&quot;&#39;</span><span class="si">%s</span><span class="s">&#39; not in </span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">attr_name</span><span class="p">,</span><span class="n">objects</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
            <span class="n">error_string</span><span class="o">+=</span><span class="s">&quot; or </span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="n">o</span>

        <span class="k">return</span> <span class="n">error_string</span>


    <span class="k">def</span> <span class="nf">_set_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param_name</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper method:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># use set_in_bounds if it exists</span>
        <span class="c"># i.e. users of widgets get their values cropped</span>
        <span class="c"># (no warnings/errors, so e.g. a string in a</span>
        <span class="c"># tagged slider just goes to the default value)</span>
        <span class="c"># CEBALERT: set_in_bounds not valid for POMetaclass?</span>
        <span class="n">parameter</span><span class="p">,</span><span class="n">sourcePO</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_object</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span><span class="n">with_source</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="c"># CEBHACKALERT: GeneratorSheet.input_generator should be a</span>
        <span class="c"># property? But it&#39;s a Parameter...</span>
        <span class="c"># Setting input_generator rather than calling set_input_generator()</span>
        <span class="c"># is probably a trap...</span>
        <span class="k">if</span> <span class="n">param_name</span><span class="o">==</span><span class="s">&#39;input_generator&#39;</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">sourcePO</span><span class="p">,</span><span class="s">&#39;set_input_generator&#39;</span><span class="p">):</span>
            <span class="n">sourcePO</span><span class="o">.</span><span class="n">set_input_generator</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">parameter</span><span class="p">,</span><span class="s">&#39;set_in_bounds&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sourcePO</span><span class="p">,</span><span class="n">Parameterized</span><span class="p">):</span>
            <span class="n">parameter</span><span class="o">.</span><span class="n">set_in_bounds</span><span class="p">(</span><span class="n">sourcePO</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">sourcePO</span><span class="p">,</span><span class="n">param_name</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>









</div>
<div class="viewcode-block" id="TkParameterized"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.TkParameterized">[docs]</a><span class="k">class</span> <span class="nc">TkParameterized</span><span class="p">(</span><span class="n">TkParameterizedBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Provide widgets for Parameters of itself and up to one additional</span>
<span class="sd">    Parameterized instance or class.</span>

<span class="sd">    A subclass that defines a Parameter p can display it appropriately</span>
<span class="sd">    for manipulation by the user simply by calling</span>
<span class="sd">    pack_param(&#39;p&#39;). The GUI display and the actual Parameter value</span>
<span class="sd">    are automatically synchronized (though see technical notes in</span>
<span class="sd">    TkParameterizedBase&#39;s documentation for more details).</span>

<span class="sd">    In general, pack_param() adds a Tkinter.Frame containing a label</span>
<span class="sd">    and a widget:</span>

<span class="sd">    ---------------------                     The Parameter&#39;s</span>
<span class="sd">    |                   |                     &#39;representation&#39;</span>
<span class="sd">    | [label]  [widget] |&lt;----frame</span>
<span class="sd">    |                   |</span>
<span class="sd">    ---------------------</span>

<span class="sd">    In the same way, an instance of this class can be used to display</span>
<span class="sd">    the Parameters of an existing object. By passing in extraPO=x,</span>
<span class="sd">    where x is an existing Parameterized instance or class, a</span>
<span class="sd">    Parameter q of x can also be displayed in the GUI by calling</span>
<span class="sd">    pack_param(&#39;q&#39;).</span>

<span class="sd">    For representation in the GUI, Parameter values might need to be</span>
<span class="sd">    converted between their real values and strings used for display</span>
<span class="sd">    (e.g. for a ClassSelector, the options are really class objects,</span>
<span class="sd">    but the user is presented with a list of strings to choose</span>
<span class="sd">    from). Such translation is handled and documented in the</span>
<span class="sd">    TkParameterizedBase; the default behaviors can be overridden if</span>
<span class="sd">    required.</span>

<span class="sd">    (Note that this class simply adds widget drawing to</span>
<span class="sd">    TkParameterizedBase. More detail about the shadowing of</span>
<span class="sd">    Parameters is available in the documentation for</span>
<span class="sd">    TkParameterizedBase.)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c"># CEBNOTE: as for TkParameterizedBase, avoid declaring</span>
    <span class="c"># Parameters here (to avoid name clashes with any additional</span>
    <span class="c"># Parameters this might eventually be representing).</span>

    <span class="n">pretty_parameters</span> <span class="o">=</span> <span class="n">Boolean</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">precedence</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;Whether to format parameter names, or display the</span>
<span class="s">        variable names instead.</span>

<span class="s">        Example use:</span>
<span class="s">          TkParameterized.pretty_parameters=False</span>

<span class="s">        (This causes all Parameters throughout the GUI to be displayed</span>
<span class="s">        with variable names.)</span>
<span class="s">        &quot;&quot;&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">master</span><span class="p">,</span><span class="n">extraPO</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">self_first</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                 <span class="n">msg_handler</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize this object with the arguments and attributes</span>
<span class="sd">        described below:</span>

<span class="sd">        extraPO: optional Parameterized object for which to shadow</span>
<span class="sd">        Parameters (in addition to Parameters of this object; see</span>
<span class="sd">        superclass)</span>

<span class="sd">        self_first: if True, Parameters on this object take precedence</span>
<span class="sd">        over any ones with the same names in the extraPO (i.e. what</span>
<span class="sd">        to do if there are name clashes; see superclass)</span>


<span class="sd">        Important attributes</span>
<span class="sd">        ====================</span>

<span class="sd">        * param_immediately_apply_change</span>

<span class="sd">        Some types of Parameter are represented with widgets where</span>
<span class="sd">        a complete change can be instantaneous (e.g.  when</span>
<span class="sd">        selecting from an option list, the selection should be</span>
<span class="sd">        applied straightaway). Others are represented with widgets</span>
<span class="sd">        that do not finish their changes instantaneously</span>
<span class="sd">        (e.g. entry into a text box is not considered finished</span>
<span class="sd">        until Return is pressed).</span>

<span class="sd">        * widget_creators</span>

<span class="sd">        A dictionary of methods to create a widget for each Parameter</span>
<span class="sd">        type. For special widget options (specific to each particular</span>
<span class="sd">        parameter), see the corresponding method&#39;s docstring.</span>

<span class="sd">        * representations</span>

<span class="sd">        After pack_param() is called, a Parameter&#39;s representation</span>
<span class="sd">        consists of the tuple (frame,widget,label,pack_options) - the</span>
<span class="sd">        enclosing frame, the value-containing widget, the label</span>
<span class="sd">        holding the Parameter&#39;s name, and any options supplied for</span>
<span class="sd">        pack(). These can all be accessed through the representations</span>
<span class="sd">        dictionary, under the Parameter&#39;s name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span> <span class="o">=</span> <span class="n">master</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_handler</span> <span class="o">=</span> <span class="n">msg_handler</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">representations</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c"># CEBALER: doc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allow_dynamic</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allow_default</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">param_immediately_apply_change</span> <span class="o">=</span> <span class="p">{</span><span class="n">Boolean</span><span class="p">:</span><span class="bp">True</span><span class="p">,</span>
                                               <span class="n">Selector</span><span class="p">:</span><span class="bp">True</span><span class="p">,</span>
                                               <span class="n">Number</span><span class="p">:</span><span class="bp">False</span><span class="p">,</span>
                                               <span class="n">Parameter</span><span class="p">:</span><span class="bp">False</span><span class="p">,</span>
                                               <span class="n">Filename</span><span class="p">:</span><span class="bp">True</span><span class="p">}</span>

        <span class="n">TkParameterizedBase</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">extraPO</span><span class="o">=</span><span class="n">extraPO</span><span class="p">,</span>
                                     <span class="n">self_first</span><span class="o">=</span><span class="n">self_first</span><span class="p">,</span>
                                     <span class="o">**</span><span class="n">params</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">balloon</span> <span class="o">=</span> <span class="n">Balloon</span><span class="p">(</span><span class="n">master</span><span class="p">)</span>

        <span class="c"># CEBALERT: what about subclasses of Number (e.g. Integer,</span>
        <span class="c"># which should get a slider that jumps between integers...</span>
        <span class="c"># maybe that already happens)?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget_creators</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">Boolean</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_create_boolean_widget</span><span class="p">,</span>
            <span class="n">Dynamic</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_create_string_widget</span><span class="p">,</span>
            <span class="n">Number</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_create_number_widget</span><span class="p">,</span>
            <span class="n">Button</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_create_button_widget</span><span class="p">,</span>
            <span class="n">String</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_create_string_widget</span><span class="p">,</span>
            <span class="n">Selector</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_create_selector_widget</span><span class="p">,</span>
            <span class="n">List</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_create_list_widget</span><span class="p">,</span>
            <span class="n">HookList</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_create_list_widget</span><span class="p">,</span>
            <span class="n">Filename</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_create_fileselector_widget</span><span class="p">,</span>
            <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">representations</span> <span class="o">=</span> <span class="p">{}</span>


        <span class="c"># CEBNOTE: it would be nice to sort out menus properly</span>
        <span class="c"># (i.e. parameterize them)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">popup_menu</span> <span class="o">=</span> <span class="n">Menu</span><span class="p">(</span><span class="n">master</span><span class="p">,</span> <span class="n">tearoff</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_var</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default_var</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">BooleanVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">popup_menu</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;checkbutton&quot;</span><span class="p">,</span><span class="n">indexname</span><span class="o">=</span><span class="s">&quot;dynamic&quot;</span><span class="p">,</span>
                            <span class="n">label</span><span class="o">=</span><span class="s">&quot;Enter dynamic value?&quot;</span><span class="p">,</span>
                            <span class="n">state</span><span class="o">=</span><span class="s">&quot;disabled&quot;</span><span class="p">,</span><span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_switch_dynamic</span><span class="p">,</span>
                            <span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dynamic_var</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">popup_menu</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s">&quot;command&quot;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&quot;Reset to default&quot;</span><span class="p">,</span>
                            <span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_param</span><span class="p">)</span>


        <span class="c">### Right-click menu for widgets</span>
        <span class="n">master</span><span class="o">.</span><span class="n">option_add</span><span class="p">(</span><span class="s">&quot;*Menu.tearOff&quot;</span><span class="p">,</span> <span class="s">&quot;0&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menu</span> <span class="o">=</span> <span class="n">Menu</span><span class="p">(</span><span class="n">master</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="o">.</span><span class="n">insert_command</span><span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39;Properties&#39;</span><span class="p">,</span>
            <span class="n">command</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_edit_PO_in_currently_selected_widget</span><span class="p">())</span>



    <span class="k">def</span> <span class="nf">_right_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="n">widget</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Popup the right-click menu.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_currently_selected_widget</span> <span class="o">=</span> <span class="n">widget</span>

        <span class="c"># need an actual mechanism for populating the menu, rather than this!!</span>
        <span class="c">### copied from edit_PO_in_currently...</span>
        <span class="n">param_name</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">representation</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currently_selected_widget</span> <span class="ow">is</span> <span class="n">representation</span><span class="p">[</span><span class="s">&#39;widget&#39;</span><span class="p">]:</span>
                <span class="n">param_name</span><span class="o">=</span><span class="n">name</span>
                <span class="k">break</span>
        <span class="c"># CEBALERT: should have used get_parameter_value(param_name)?</span>
        <span class="n">PO_to_edit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_string2object</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">param_name</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
        <span class="c">###</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">PO_to_edit</span><span class="p">,</span><span class="s">&#39;params&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="o">.</span><span class="n">tk_popup</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">x_root</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y_root</span><span class="p">)</span>


    <span class="c"># CEBALERT: rename</span>
    <span class="k">def</span> <span class="nf">_edit_PO_in_currently_selected_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Open a new window containing a ParametersFrame (actually, a</span>
<span class="sd">        type(self)) for the PO in _currently_selected_widget.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># CEBALERT: simplify this lookup by value</span>
        <span class="n">param_name</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">representation</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currently_selected_widget</span> <span class="ow">is</span> <span class="n">representation</span><span class="p">[</span><span class="s">&#39;widget&#39;</span><span class="p">]:</span>
                <span class="n">param_name</span><span class="o">=</span><span class="n">name</span>
                <span class="k">break</span>

        <span class="c"># CEBALERT: should have used get_parameter_value(param_name)?</span>
        <span class="n">PO_to_edit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_string2object</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">param_name</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>

        <span class="n">parameter_window</span> <span class="o">=</span> <span class="n">AppWindow</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">parameter_window</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">PO_to_edit</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s">&#39; parameters&#39;</span><span class="p">)</span>

        <span class="c">### CEBALERT: confusing? ###</span>
        <span class="n">title</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">parameter_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s">&quot;(&quot;</span><span class="o">+</span><span class="n">param_name</span> <span class="o">+</span> <span class="s">&quot; of &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="s">&#39;class &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span><span class="p">)</span>
        <span class="n">title</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span> <span class="o">=</span> <span class="s">&quot;top&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">balloon</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">title</span><span class="p">,</span><span class="n">getdoc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_object</span><span class="p">(</span><span class="n">param_name</span><span class="p">)))</span>
        <span class="c">############################</span>

        <span class="c"># uh-oh</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ParametersFrame</span><span class="p">):</span>
            <span class="n">p_type</span> <span class="o">=</span> <span class="n">ParametersFrameWithApply</span>
            <span class="n">parameter_frame</span> <span class="o">=</span> <span class="n">p_type</span><span class="p">(</span><span class="n">parameter_window</span><span class="p">,</span><span class="n">parameterized_object</span><span class="o">=</span><span class="n">PO_to_edit</span><span class="p">,</span><span class="n">msg_handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">msg_handler</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">p_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">parameter_frame</span> <span class="o">=</span> <span class="n">p_type</span><span class="p">(</span><span class="n">parameter_window</span><span class="p">,</span><span class="n">parameterized_object</span><span class="o">=</span><span class="n">PO_to_edit</span><span class="p">,</span><span class="n">msg_handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">msg_handler</span><span class="p">,</span><span class="n">on_set</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">on_set</span><span class="p">,</span><span class="n">on_modify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">on_modify</span><span class="p">)</span>

        <span class="n">parameter_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>



    <span class="k">def</span> <span class="nf">_update_dynamic_menu_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Keep track of status of dynamic entry.&quot;&quot;&quot;</span>
        <span class="n">param</span><span class="p">,</span><span class="n">po</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_object</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span><span class="n">with_source</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">currently_dynamic</span> <span class="o">=</span> <span class="n">param_is_dynamically_generated</span><span class="p">(</span><span class="n">param</span><span class="p">,</span><span class="n">po</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">param</span><span class="p">,</span><span class="s">&#39;_value_is_dynamic&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">currently_dynamic</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_right_click_param</span> <span class="o">=</span> <span class="n">param_name</span>
            <span class="n">state</span> <span class="o">=</span> <span class="s">&quot;normal&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_right_click_param</span> <span class="o">=</span> <span class="bp">None</span>
            <span class="n">state</span> <span class="o">=</span> <span class="s">&quot;disabled&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">popup_menu</span><span class="o">.</span><span class="n">entryconfig</span><span class="p">(</span><span class="s">&quot;dynamic&quot;</span><span class="p">,</span><span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dynamic_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">currently_dynamic</span> <span class="ow">or</span> \
                             <span class="n">param_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_dynamic</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_param_right_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">,</span><span class="n">param_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Display a popup menu when user right clicks on a parameter.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_dynamic_menu_entry</span><span class="p">(</span><span class="n">param_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">popup_menu</span><span class="o">.</span><span class="n">tk_popup</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">x_root</span><span class="p">,</span><span class="n">event</span><span class="o">.</span><span class="n">y_root</span><span class="p">)</span>



<span class="c">################################################################################</span>
<span class="c">#</span>
<span class="c">################################################################################</span>

    <span class="k">def</span> <span class="nf">_update_param_from_tkvar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param_name</span><span class="p">,</span><span class="n">force</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prevents the superclass&#39;s _update_param_from_tkvar() method from being</span>
<span class="sd">        called unless:</span>

<span class="sd">        * param_name is a Parameter type that has changes immediately</span>
<span class="sd">          applied (see doc for param_immediately_apply_change</span>
<span class="sd">          dictionary);</span>

<span class="sd">        * force is True.</span>

<span class="sd">        (I.e. to update a parameter for which</span>
<span class="sd">        param_immediately_apply_change[type(parameter)]==False, call</span>
<span class="sd">        this method with force=True. E.g. when &lt;Return&gt; is pressed in</span>
<span class="sd">        a text box, this method is called with force=True.)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;TkPO._update_param_from_tkvar(</span><span class="si">%s</span><span class="s">)&quot;</span><span class="o">%</span><span class="n">param_name</span><span class="p">)</span>

        <span class="n">param_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_object</span><span class="p">(</span><span class="n">param_name</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">lookup_by_class</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_immediately_apply_change</span><span class="p">,</span>
                               <span class="nb">type</span><span class="p">(</span><span class="n">param_obj</span><span class="p">))</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">force</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">(</span><span class="n">TkParameterized</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_update_param_from_tkvar</span><span class="p">(</span><span class="n">param_name</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_handle_gui_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">p_name</span><span class="p">,</span><span class="n">force</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Override the superclass&#39;s method to X and allow status indications.&quot;&quot;&quot;</span>
        <span class="c">#logging.info(&quot;%s._handle_gui_set(%s,force=%s)&quot;%(self,p_name,force))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_live_update</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_param_from_tkvar</span><span class="p">(</span><span class="n">p_name</span><span class="p">,</span><span class="n">force</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_indicate_tkvar_status</span><span class="p">(</span><span class="n">p_name</span><span class="p">)</span>



    <span class="c">#### Simulate GUI actions</span>
<div class="viewcode-block" id="TkParameterized.gui_set_param"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.TkParameterized.gui_set_param">[docs]</a>    <span class="k">def</span> <span class="nf">gui_set_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param_name</span><span class="p">,</span><span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Simulate setting the parameter in the GUI.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tkvar_set</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>  <span class="c"># ERROR: presumably calls trace stuff twice</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_handle_gui_set</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span><span class="n">force</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="TkParameterized.gui_get_param"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.TkParameterized.gui_get_param">[docs]</a>    <span class="k">def</span> <span class="nf">gui_get_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param_name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Simulate getting the parameter in the GUI.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">param_name</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="c">####</span>


<span class="c">################################################################################</span>
<span class="c"># End</span>
<span class="c">################################################################################</span>





<span class="c">################################################################################</span>
<span class="c">#</span>
<span class="c">################################################################################</span>

    <span class="c"># some refactoring required: should be a base method that&#39;s to do</span>
    <span class="c"># with adding a representation for a parameter. then this stuff</span>
    <span class="c"># would go in it.</span></div>
    <span class="k">def</span> <span class="nf">_post_add_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param_name</span><span class="p">):</span>
        <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">param_name</span><span class="p">][</span><span class="s">&#39;label&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">l</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">l</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&#39;&lt;&lt;right-click&gt;&gt;&#39;</span><span class="p">,</span><span class="k">lambda</span> <span class="n">event</span><span class="p">:</span> \
                   <span class="bp">self</span><span class="o">.</span><span class="n">_param_right_click</span><span class="p">(</span><span class="n">event</span><span class="p">,</span><span class="n">param_name</span><span class="p">))</span>


<div class="viewcode-block" id="TkParameterized.pack_param"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.TkParameterized.pack_param">[docs]</a>    <span class="k">def</span> <span class="nf">pack_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">parent</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">widget_options</span><span class="o">=</span><span class="p">{},</span>
                   <span class="n">on_set</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">on_modify</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="o">**</span><span class="n">pack_options</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a widget for the Parameter name, configured according</span>
<span class="sd">        to widget_options, and pack()ed according to the pack_options.</span>

<span class="sd">        Pop-up help is automatically set from the Parameter&#39;s doc.</span>

<span class="sd">        The widget and label (if appropriate) are enlosed in a Frame</span>
<span class="sd">        so they can be manipulated as a single unit (see the class</span>
<span class="sd">        docstring). The representation</span>
<span class="sd">        (frame,widget,label,pack_options) is returned (as well as</span>
<span class="sd">        being stored in the representations dictionary).</span>


<span class="sd">        * parent is an existing widget that is to be the parent</span>
<span class="sd">        (master) of the widget created for this paramter. If no parent</span>
<span class="sd">        is specified, defaults to the originally supplied master</span>
<span class="sd">        (i.e. that set during __init__).</span>

<span class="sd">        * on_set is an optional function to call whenever the</span>
<span class="sd">        Parameter&#39;s corresponding Tkinter Variable&#39;s trace_variable</span>
<span class="sd">        indicates that it has been set (this does not necessarily mean</span>
<span class="sd">        that the widget&#39;s value has changed). When the widget is created,</span>
<span class="sd">        the on_set method will be called (because the creation of the</span>
<span class="sd">        widget triggers a set in Tkinter).</span>

<span class="sd">        * on_modify is an optional function to call whenever the</span>
<span class="sd">        corresponding Tkinter Variable is actually changed.</span>


<span class="sd">        widget_options specified here override anything that might have been</span>
<span class="sd">        set elsewhere (e.g. Button&#39;s size can be overridden here</span>
<span class="sd">        if required).</span>



<span class="sd">        Examples of use:</span>
<span class="sd">        pack_param(name)</span>
<span class="sd">        pack_param(name,side=&#39;left&#39;)</span>
<span class="sd">        pack_param(name,parent=frame3,on_set=some_func)</span>
<span class="sd">        pack_param(name,widget_options={&#39;width&#39;:50},side=&#39;top&#39;,expand=&#39;yes&#39;,fill=&#39;y&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">parent</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="p">)</span>

        <span class="n">widget</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_widget</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">frame</span><span class="p">,</span><span class="n">widget_options</span><span class="p">,</span><span class="n">on_set</span><span class="p">,</span><span class="n">on_modify</span><span class="p">)</span>

        <span class="c"># checkbuttons are &#39;widget label&#39; rather than &#39;label widget&#39;</span>
        <span class="k">if</span> <span class="n">widget</span><span class="o">.</span><span class="n">__class__</span> <span class="ow">is</span> <span class="n">T</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">:</span>  <span class="c"># type(widget) doesn&#39;t seem to work</span>
            <span class="n">widget_side</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">;</span> <span class="n">label_side</span><span class="o">=</span><span class="s">&#39;right&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">label_side</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">;</span> <span class="n">widget_side</span><span class="o">=</span><span class="s">&#39;right&#39;</span>

        <span class="k">if</span> <span class="n">label</span><span class="p">:</span> <span class="n">label</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">label_side</span><span class="p">)</span> <span class="c"># label can be None (e.g. for Button)</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">widget_side</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="s">&#39;yes&#39;</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="s">&#39;x&#39;</span><span class="p">)</span>

        <span class="n">representation</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;frame&quot;</span><span class="p">:</span><span class="n">frame</span><span class="p">,</span><span class="s">&quot;widget&quot;</span><span class="p">:</span><span class="n">widget</span><span class="p">,</span>
                          <span class="s">&quot;label&quot;</span><span class="p">:</span><span class="n">label</span><span class="p">,</span><span class="s">&quot;pack_options&quot;</span><span class="p">:</span><span class="n">pack_options</span><span class="p">,</span>
                          <span class="s">&quot;on_set&quot;</span><span class="p">:</span><span class="n">on_set</span><span class="p">,</span><span class="s">&quot;on_modify&quot;</span><span class="p">:</span><span class="n">on_modify</span><span class="p">,</span>
                          <span class="s">&quot;widget_options&quot;</span><span class="p">:</span><span class="n">widget_options</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">representation</span>

        <span class="c"># If there&#39;s a label, balloon&#39;s bound to it - otherwise, bound</span>
        <span class="c"># to enclosing frame.</span>
        <span class="c"># (E.g. when there&#39;s [label] [text_box], only want balloon for</span>
        <span class="c"># label (because maybe more help will be present for what&#39;s in</span>
        <span class="c"># the box) but when there&#39;s [button], want popup help over the</span>
        <span class="c"># button.)</span>
        <span class="n">param_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_object</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">help_text</span> <span class="o">=</span> <span class="n">getdoc</span><span class="p">(</span><span class="n">param_obj</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">param_obj</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c"># some params appear to have no docs!!!</span>
            <span class="k">if</span> <span class="n">help_text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">help_text</span><span class="o">+=</span><span class="s">&quot;</span><span class="se">\n\n</span><span class="s">Default: </span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">_object2string</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">param_obj</span><span class="o">.</span><span class="n">default</span><span class="p">,</span><span class="n">replace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">balloon</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">label</span> <span class="ow">or</span> <span class="n">frame</span><span class="p">,</span><span class="n">help_text</span><span class="p">)</span>

        <span class="n">frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pack_options</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_indicate_tkvar_status</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_post_add_param</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">representation</span>

</div>
<div class="viewcode-block" id="TkParameterized.hide_param"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.TkParameterized.hide_param">[docs]</a>    <span class="k">def</span> <span class="nf">hide_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Hide the representation of Parameter &#39;name&#39;.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;frame&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pack_forget</span><span class="p">()</span>
        <span class="c"># CEBNOTE: forgetting label and widget rather than frame would</span>
        <span class="c"># just hide while still occupying space (i.e. the empty frame</span>
        <span class="c"># stays in place, and so widgets could later be inserted at</span>
        <span class="c"># exact same place)</span>
        <span class="c">#self.representations[name][&#39;label&#39;].pack_forget()</span>
        <span class="c">#self.representations[name][&#39;widget&#39;].pack_forget()</span>
        <span class="c"># unhide_param would need modifying too</span>

</div>
<div class="viewcode-block" id="TkParameterized.unhide_param"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.TkParameterized.unhide_param">[docs]</a>    <span class="k">def</span> <span class="nf">unhide_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">new_pack_options</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Un-hide the representation of Parameter &#39;name&#39;.</span>

<span class="sd">        Any new pack options supplied overwrite the originally</span>
<span class="sd">        supplied ones, but the parent of the widget remains the same.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># CEBNOTE: new_pack_options not really tested. Are they useful anyway?</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">:</span>
            <span class="n">pack_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;pack_options&#39;</span><span class="p">]</span>
            <span class="n">pack_options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">new_pack_options</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;frame&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">pack_options</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="TkParameterized.unpack_param"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.TkParameterized.unpack_param">[docs]</a>    <span class="k">def</span> <span class="nf">unpack_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Destroy the representation of Parameter &#39;name&#39;.</span>

<span class="sd">        (unpack and then pack a param if you want to put it in a different</span>
<span class="sd">        frame; otherwise simply use hide and unhide)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;frame&#39;</span><span class="p">]</span>
        <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;widget&#39;</span><span class="p">]</span>
        <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;label&#39;</span><span class="p">]</span>

        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">f</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">l</span><span class="p">]:</span>
            <span class="n">x</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>

</div>
    <span class="k">def</span> <span class="nf">repack_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>

        <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;frame&#39;</span><span class="p">]</span>
        <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;widget&#39;</span><span class="p">]</span>
        <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;label&#39;</span><span class="p">]</span>
        <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;pack_options&#39;</span><span class="p">]</span>
        <span class="n">on_set</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;on_set&#39;</span><span class="p">]</span>
        <span class="n">on_modify</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;on_modify&#39;</span><span class="p">]</span>

        <span class="n">w</span><span class="o">.</span><span class="n">destroy</span><span class="p">();</span> <span class="n">l</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>

        <span class="n">param_obj</span><span class="p">,</span><span class="n">PO</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_object</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">with_source</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_tkvar</span><span class="p">(</span><span class="n">PO</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">param_obj</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pack_param</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">on_set</span><span class="o">=</span><span class="n">on_set</span><span class="p">,</span><span class="n">on_modify</span><span class="o">=</span><span class="n">on_modify</span><span class="p">,</span><span class="o">**</span><span class="n">o</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_switch_dynamic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">dynamic</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>

        <span class="n">param_name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_right_click_param</span>
        <span class="n">param</span><span class="p">,</span><span class="n">po</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_object</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span><span class="n">with_source</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">param</span><span class="p">,</span><span class="s">&#39;_value_is_dynamic&#39;</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">param_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_dynamic</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">allow_dynamic</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">param_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">allow_dynamic</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">param_name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">repack_param</span><span class="p">(</span><span class="n">param_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_default_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>

        <span class="n">parameter_name</span> <span class="o">=</span> <span class="n">name</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_right_click_param</span>
        <span class="n">param</span><span class="p">,</span><span class="n">po</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_object</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">,</span><span class="n">with_source</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">parameter_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_default</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">allow_default</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">allow_default</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">)</span>

        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span><span class="p">,</span><span class="n">Parameterized</span><span class="p">)</span>
        <span class="n">defaults</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span><span class="o">.</span><span class="n">defaults</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">gui_set_param</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">,</span><span class="n">defaults</span><span class="p">[</span><span class="n">parameter_name</span><span class="p">])</span>
        <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">parameter_name</span><span class="p">][</span><span class="s">&#39;widget&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="s">&#39;tag_set&#39;</span><span class="p">):</span><span class="n">w</span><span class="o">.</span><span class="n">tag_set</span><span class="p">()</span>


<span class="c">################################################################################</span>
<span class="c">#</span>
<span class="c">################################################################################</span>





<span class="c">################################################################################</span>
<span class="c"># WIDGET CREATION</span>
<span class="c">################################################################################</span>

    <span class="k">def</span> <span class="nf">_create_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">master</span><span class="p">,</span><span class="n">widget_options</span><span class="o">=</span><span class="p">{},</span><span class="n">on_set</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">on_modify</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return widget,label for parameter &#39;name&#39;, each having the master supplied</span>

<span class="sd">        The appropriate widget creation method is found from the</span>
<span class="sd">        widget_creators dictionary; see individual widget creation</span>
<span class="sd">        methods for details to each type of widget.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># select the appropriate widget-creation method;</span>
        <span class="c"># default is self._create_string_widget...</span>
        <span class="n">widget_creation_fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_string_widget</span>

        <span class="n">param_obj</span><span class="p">,</span><span class="n">source_po</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_object</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">with_source</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">param_is_dynamically_generated</span><span class="p">(</span><span class="n">param_obj</span><span class="p">,</span><span class="n">source_po</span><span class="p">)</span> <span class="ow">or</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_dynamic</span><span class="p">):</span>
            <span class="c"># ...but overwrite that with a more specific one, if possible</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">classlist</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">param_obj</span><span class="p">))[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_creators</span><span class="o">.</span><span class="n">has_key</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
                    <span class="n">widget_creation_fn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget_creators</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
                    <span class="k">break</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_dynamic</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">allow_dynamic</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">on_set</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">_on_set</span><span class="o">=</span><span class="n">on_set</span>

        <span class="k">if</span> <span class="n">on_modify</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">_on_modify</span><span class="o">=</span><span class="n">on_modify</span>

        <span class="n">widget</span><span class="o">=</span><span class="n">widget_creation_fn</span><span class="p">(</span><span class="n">master</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">widget_options</span><span class="p">)</span>

        <span class="c"># Is widget a button (but not a checkbutton)? If so, no label wanted.</span>
        <span class="c"># CEBALERT &#39;notNonelabel&#39;: change to have a label with no text</span>
        <span class="k">if</span> <span class="n">is_button</span><span class="p">(</span><span class="n">widget</span><span class="p">):</span>
            <span class="n">label</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">master</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_pretty_print</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

        <span class="c"># disable widgets for constant params</span>
        <span class="k">if</span> <span class="n">param_obj</span><span class="o">.</span><span class="n">constant</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source_po</span><span class="p">,</span><span class="n">Parameterized</span><span class="p">):</span>
            <span class="c"># (need to be able to set on class, hence check it&#39;s PO not POMetaclass</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s">&#39;disabled&#39;</span><span class="p">)</span>

        <span class="n">widget</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&#39;&lt;&lt;right-click&gt;&gt;&#39;</span><span class="p">,</span><span class="k">lambda</span> <span class="n">event</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_right_click</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">widget</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">widget</span><span class="p">,</span><span class="n">label</span>


    <span class="k">def</span> <span class="nf">_create_button_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">frame</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">widget_options</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a FocusTakingButton to represent Parameter &#39;name&#39;.</span>

<span class="sd">        Buttons require a command, which should have been specified as the</span>
<span class="sd">        &#39;on_set&#39; function passed to pack_param().</span>

<span class="sd">        After creating a button for a Parameter param, self.param() also</span>
<span class="sd">        executes the button&#39;s command.</span>

<span class="sd">        If the Button was declared with an image, the button will</span>
<span class="sd">        have that image (and no text); otherwise, the button will display</span>
<span class="sd">        the (possibly pretty_print()ed) name of the Parameter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">_on_set</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;No command given for &#39;</span><span class="si">%s</span><span class="s">&#39; button.&quot;</span><span class="o">%</span><span class="n">name</span><span class="p">)</span>

        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">_on_set</span> <span class="c"># because we use Button&#39;s command instead</span>

        <span class="c"># Calling the parameter (e.g. self.Apply()) is like pressing the button:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&quot;_</span><span class="si">%s</span><span class="s">_param_value&quot;</span><span class="o">%</span><span class="n">name</span><span class="p">]</span><span class="o">=</span><span class="n">command</span>
        <span class="c"># like setattr(self,name,command) but without tracing etc</span>

        <span class="c"># (...CEBNOTE: and so you can&#39;t edit a tkparameterizedobject</span>
        <span class="c"># w/buttons with another tkparameterizedobject because the</span>
        <span class="c"># button parameters all skip translation etc. Instead should</span>
        <span class="c"># handle their translation. But we&#39;re not offering a GUI</span>
        <span class="c"># builder so it doesn&#39;t matter.)</span>

        <span class="n">button</span> <span class="o">=</span> <span class="n">FocusTakingButton</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span><span class="n">command</span><span class="o">=</span><span class="n">command</span><span class="p">)</span>

        <span class="n">button_param</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_object</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="n">image</span> <span class="o">=</span> <span class="n">button_param</span><span class="o">.</span><span class="n">get_image</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">image</span><span class="p">:</span>
            <span class="n">button</span><span class="p">[</span><span class="s">&#39;image&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">image</span>
            <span class="c">#button[&#39;relief&#39;]=&#39;flat&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">button</span><span class="p">[</span><span class="s">&#39;text&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_pretty_print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>


        <span class="c"># and set size from Button</span>
        <span class="c">#if size_param.size:</span>
        <span class="c">#    button[&#39;width&#39;]=size[0]</span>
        <span class="c">#    button[&#39;height&#39;]=size[1]</span>

        <span class="n">button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="o">**</span><span class="n">widget_options</span><span class="p">)</span> <span class="c"># widget_options override things from parameter</span>
        <span class="k">return</span> <span class="n">button</span>


    <span class="k">def</span> <span class="nf">_create_fileselector_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">frame</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">widget_options</span><span class="p">):</span>
        <span class="n">widget</span> <span class="o">=</span> <span class="n">HackFileEntry</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">widget</span>


    <span class="k">def</span> <span class="nf">update_selector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">:</span>
            <span class="n">widget_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&quot;widget_options&quot;</span><span class="p">]</span>

            <span class="n">new_range</span><span class="p">,</span><span class="n">widget_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_X</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">widget_options</span><span class="p">)</span>

            <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;widget&#39;</span><span class="p">]</span>
            <span class="c"># hACK: tuple to work around strange list parsing tkinter/tcl</span>
            <span class="n">w</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">new_range</span><span class="p">))</span> <span class="c"># what a mess</span>
            <span class="c">#w.configure(state=&#39;readonly&#39;) # CEBALERT: why necessary?</span>
            <span class="c"># does it get changed somewhere else by mistake? e.g. does</span>
            <span class="c"># plotgrouppanel switch disabled to normal and normal to</span>
            <span class="c"># disabled without checking that normal isn&#39;t readonly?</span>


    <span class="k">def</span> <span class="nf">_X</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">widget_options</span><span class="p">):</span>

        <span class="c"># CEBALERT: need to document how &amp; why people should use &#39;sort_fn_args&#39;</span>
        <span class="c"># and &#39;new_default&#39; when calling pack_param(). Also, simplify it if</span>
        <span class="c"># possible.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">translators</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

        <span class="n">new_range</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">translators</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">cache</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

        <span class="k">if</span> <span class="s">&#39;sort_fn_args&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">widget_options</span><span class="p">:</span>
            <span class="c"># no sort specified: defaults to sort()</span>
            <span class="n">new_range</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sort_fn_args</span> <span class="o">=</span> <span class="n">widget_options</span><span class="p">[</span><span class="s">&#39;sort_fn_args&#39;</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">widget_options</span><span class="p">[</span><span class="s">&#39;sort_fn_args&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">sort_fn_args</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">new_range</span> <span class="o">=</span> <span class="n">keys_sorted_by_value_unique_None_safe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">translators</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">cache</span><span class="p">,</span><span class="o">**</span><span class="n">sort_fn_args</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_range</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">new_range</span><span class="o">=</span><span class="p">[</span><span class="bp">None</span><span class="p">]</span>

        <span class="n">tkvar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>


        <span class="k">if</span> <span class="s">&#39;new_default&#39;</span> <span class="ow">in</span> <span class="n">widget_options</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">widget_options</span><span class="p">[</span><span class="s">&#39;new_default&#39;</span><span class="p">]:</span>
                <span class="n">current_value</span> <span class="o">=</span> <span class="n">new_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">widget_options</span><span class="p">[</span><span class="s">&#39;new_default&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">current_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_object2string</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_value</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">current_value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">new_range</span><span class="p">:</span>
                <span class="n">current_value</span> <span class="o">=</span> <span class="n">new_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c"># whatever was there is out of date now</span>

        <span class="n">tkvar</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">current_value</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">new_range</span><span class="p">,</span><span class="n">widget_options</span>


    <span class="k">def</span> <span class="nf">_create_selector_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">frame</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">widget_options</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a Tkinter.OptionMenu to represent Parameter &#39;name&#39;.</span>

<span class="sd">        In addition to Tkinter.OptionMenu&#39;s usual options, the</span>
<span class="sd">        following additional ones may be included in widget_options:</span>

<span class="sd">        * sort_fn_args: if widget_options includes &#39;sort_fn_args&#39;,</span>
<span class="sd">          these are passed to the sort() method of the list of</span>
<span class="sd">          *objects* available for the parameter, and the names are</span>
<span class="sd">          displayed sorted in that order.  If &#39;sort_fn_args&#39; is not</span>
<span class="sd">          present, the default is to sort the list of names using its</span>
<span class="sd">          sort() method.</span>

<span class="sd">        * new_default: if widget_options includes &#39;new_default&#39;:True,</span>
<span class="sd">          the currently selected value for the widget will be set</span>
<span class="sd">          to the first item in the (possibly sorted as above) range.</span>
<span class="sd">          Otherwise, the currently selected value will be left as the</span>
<span class="sd">          current value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">#param = self.get_parameter_object(name)</span>
        <span class="c">#self._update_translator(name,param)</span>

        <span class="c">## sort the range for display</span>
        <span class="c"># CEBALERT: extend OptionMenu so that it</span>
        <span class="c"># (a) supports changing its option list (subject of a previous ALERT)</span>
        <span class="c"># (b) supports sorting of its option list</span>
        <span class="c"># (c) supports selecting a new default</span>
        <span class="n">new_range</span><span class="p">,</span><span class="n">widget_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_X</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">widget_options</span><span class="p">)</span>
        <span class="n">tkvar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

        <span class="c"># Combobox looks bad with standard theme on my ubuntu</span>
        <span class="c"># (and &#39;changed&#39; marker - blue text - not visible).</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">Combobox</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span><span class="n">textvariable</span><span class="o">=</span><span class="n">tkvar</span><span class="p">,</span>
                     <span class="n">values</span><span class="o">=</span><span class="n">new_range</span><span class="p">,</span><span class="n">state</span><span class="o">=</span><span class="s">&#39;readonly&#39;</span><span class="p">,</span>
                     <span class="o">**</span><span class="n">widget_options</span><span class="p">)</span>

        <span class="c"># Combobox (along with Checkbutton?) somehow sets its</span>
        <span class="c"># associated textvariable without calling that textvariable&#39;s</span>
        <span class="c"># set() method.  Therefore, to update the Selector&#39;s help text</span>
        <span class="c"># when an item is selected, we bind to the</span>
        <span class="c"># &lt;&lt;ComboboxSelected&gt;&gt; event.</span>
        <span class="k">def</span> <span class="nf">_combobox_updated</span><span class="p">(</span><span class="n">event</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">):</span>
            <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;widget&#39;</span><span class="p">]</span>
            <span class="n">help_text</span> <span class="o">=</span>  <span class="n">getdoc</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_string2object</span><span class="p">(</span>
                    <span class="n">name</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">_original_get</span><span class="p">()))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">balloon</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">help_text</span><span class="p">)</span>

        <span class="n">w</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;ComboboxSelected&gt;&gt;&quot;</span><span class="p">,</span><span class="n">_combobox_updated</span><span class="p">)</span>

        <span class="n">help_text</span> <span class="o">=</span> <span class="n">getdoc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_string2object</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">tkvar</span><span class="o">.</span><span class="n">_original_get</span><span class="p">()))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">balloon</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="n">help_text</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">w</span>

    <span class="k">def</span> <span class="nf">_list_edit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param_name</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_value</span><span class="p">(</span><span class="n">param_name</span><span class="p">)</span>

        <span class="n">param_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_object</span><span class="p">(</span><span class="n">param_name</span><span class="p">)</span>
        <span class="n">class_</span><span class="o">=</span><span class="bp">None</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">param_obj</span><span class="p">,</span><span class="s">&#39;class_&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">param_obj</span><span class="o">.</span><span class="n">class_</span><span class="p">,</span><span class="s">&#39;get_range&#39;</span><span class="p">):</span>
            <span class="c"># i.e. we can represent with ClassSelector</span>
            <span class="n">class_</span> <span class="o">=</span> <span class="n">param_obj</span><span class="o">.</span><span class="n">class_</span>

        <span class="n">parameterized_instance</span> <span class="o">=</span> <span class="n">list_to_parameterized</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="n">class_</span><span class="p">)</span>

        <span class="n">parameter_window</span> <span class="o">=</span> <span class="n">AppWindow</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c">#parameter_window.title(PO_to_edit.name+&#39; parameters&#39;)</span>

        <span class="n">parameter_frame</span> <span class="o">=</span> <span class="n">EditingParametersFrameWithApply</span><span class="p">(</span><span class="n">parameter_window</span><span class="p">,</span><span class="n">parameterized_object</span><span class="o">=</span><span class="n">parameterized_instance</span><span class="p">,</span><span class="n">show_labels</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">on_close</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_handle_gui_set</span><span class="p">(</span><span class="n">param_name</span><span class="p">))</span>

        <span class="c"># CEBALERT: more dynamic class changes to make it impossible</span>
        <span class="c"># to follow what is happening...ParametersFrame needs some</span>
        <span class="c"># reorganization...</span>
        <span class="k">def</span> <span class="nf">_forgotten_why</span><span class="p">(</span><span class="n">itself</span><span class="p">):</span>
            <span class="c">### refresh()</span>
            <span class="n">po_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_value</span><span class="p">(</span><span class="n">param_name</span><span class="p">)</span>
            <span class="n">po_stringrep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_object2string</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span><span class="n">po_val</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">param_name</span><span class="p">]</span><span class="o">.</span><span class="n">_original_set</span><span class="p">(</span><span class="n">po_stringrep</span><span class="p">)</span>
            <span class="c">###</span>

        <span class="k">if</span> <span class="n">_forgotten_why</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">parameter_frame</span><span class="o">.</span><span class="n">_apply_hooks</span><span class="p">:</span>
            <span class="n">parameter_frame</span><span class="o">.</span><span class="n">_apply_hooks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_forgotten_why</span><span class="p">)</span>


        <span class="n">parameter_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">_create_list_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">frame</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">widget_options</span><span class="p">):</span>
        <span class="c">#param = self.get_parameter_object(name)</span>
        <span class="c">#value = self.get_parameter_value(name)</span>

        <span class="n">X</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list_edit</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="n">w</span> <span class="o">=</span> <span class="n">ListWidget</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span><span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">name</span><span class="p">],</span>
                       <span class="n">cmd</span><span class="o">=</span><span class="n">X</span><span class="p">,</span><span class="o">**</span><span class="n">widget_options</span><span class="p">)</span>
        <span class="c">#w = ListWidget(frame,variable=tkvar,**widget_options)</span>


        <span class="c">#help_text = getdoc(self._string2object(name,tkvar._original_get()))</span>
        <span class="c">#self.balloon.bind(w,help_text)</span>
        <span class="k">return</span> <span class="n">w</span>



    <span class="k">def</span> <span class="nf">_create_number_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">frame</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">widget_options</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a TaggedSlider to represent parameter &#39;name&#39;.</span>

<span class="sd">        The slider&#39;s bounds are set to those of the Parameter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">TaggedSlider</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span><span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">name</span><span class="p">],</span><span class="o">**</span><span class="n">widget_options</span><span class="p">)</span>
        <span class="n">param</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_object</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="n">lower_bound</span><span class="p">,</span><span class="n">upper_bound</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">get_soft_bounds</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">upper_bound</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">lower_bound</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c"># TaggedSlider needs BOTH bounds (neither can be None)</span>
            <span class="n">w</span><span class="o">.</span><span class="n">set_bounds</span><span class="p">(</span><span class="n">lower_bound</span><span class="p">,</span><span class="n">upper_bound</span><span class="p">,</span><span class="n">inclusive_bounds</span><span class="o">=</span><span class="n">param</span><span class="o">.</span><span class="n">inclusive_bounds</span><span class="p">)</span>


        <span class="c"># have to do the lookup because subclass might override default</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">lookup_by_class</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_immediately_apply_change</span><span class="p">,</span><span class="nb">type</span><span class="p">(</span><span class="n">param</span><span class="p">)):</span>
            <span class="n">w</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&#39;&lt;&lt;TagReturn&gt;&gt;&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">e</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_gui_set</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">force</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
            <span class="n">w</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&#39;&lt;&lt;TagFocusOut&gt;&gt;&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">e</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_gui_set</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">force</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
            <span class="n">w</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&#39;&lt;&lt;SliderSet&gt;&gt;&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">e</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_gui_set</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">force</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">w</span>


    <span class="k">def</span> <span class="nf">_create_boolean_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">frame</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">widget_options</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a Tkinter.Checkbutton to represent parameter &#39;name&#39;.&quot;&quot;&quot;</span>
        <span class="c"># CB: might be necessary to pass actions to command option of Checkbutton;</span>
        <span class="c"># could be cause of test pattern boolean not working?</span>
        <span class="k">return</span> <span class="n">T</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span><span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">name</span><span class="p">],</span><span class="o">**</span><span class="n">widget_options</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_create_string_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">frame</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">widget_options</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a Tkinter.Entry to represent parameter &#39;name&#39;.&quot;&quot;&quot;</span>
        <span class="n">widget</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span><span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">name</span><span class="p">],</span><span class="o">**</span><span class="n">widget_options</span><span class="p">)</span>
        <span class="n">param</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_object</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">lookup_by_class</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_immediately_apply_change</span><span class="p">,</span><span class="nb">type</span><span class="p">(</span><span class="n">param</span><span class="p">)):</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&#39;&lt;Return&gt;&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">e</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_gui_set</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">force</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&#39;&lt;FocusOut&gt;&#39;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">e</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_handle_gui_set</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">force</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">widget</span>

<span class="c">################################################################################</span>
<span class="c"># End WIDGET CREATION</span>
<span class="c">################################################################################</span>



    <span class="c"># CB: the colors etc for indication are only temporary</span>
    <span class="k">def</span> <span class="nf">_indicate_tkvar_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param_name</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the parameter&#39;s label to:</span>
<span class="sd">         - blue if the GUI value differs from that set on the object</span>
<span class="sd">         - red if the text doesn&#39;t translate to a correct value</span>
<span class="sd">         - black if the GUI and object have the same value</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">translators</span><span class="p">[</span><span class="n">param_name</span><span class="p">]</span><span class="o">.</span><span class="n">last_string2object_failed</span><span class="p">:</span>
            <span class="n">status</span> <span class="o">=</span> <span class="s">&#39;error&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_widget_status</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span><span class="n">status</span><span class="p">)</span>


    <span class="c"># this scheme is incompatible with tile</span>
    <span class="c"># (tile having the right idea about how to do this kind of thing!)</span>
    <span class="k">def</span> <span class="nf">_set_widget_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param_name</span><span class="p">,</span><span class="n">status</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">param_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">:</span>
            <span class="k">if</span> <span class="s">&#39;widget&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">param_name</span><span class="p">]:</span>

                <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">param_name</span><span class="p">][</span><span class="s">&#39;widget&#39;</span><span class="p">]</span>
                <span class="n">states</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;error&#39;</span>   <span class="p">:</span> <span class="s">&#39;red&#39;</span><span class="p">,</span>
                          <span class="s">&#39;changed&#39;</span> <span class="p">:</span> <span class="s">&#39;blue&#39;</span><span class="p">,</span>
                          <span class="bp">None</span>      <span class="p">:</span> <span class="s">&#39;black&#39;</span><span class="p">}</span>

                <span class="k">if</span> <span class="n">is_button</span><span class="p">(</span><span class="n">widget</span><span class="p">):</span>
                    <span class="c"># can&#39;t change state of button</span>
                    <span class="k">return</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="n">widget</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">foreground</span><span class="o">=</span><span class="n">states</span><span class="p">[</span><span class="n">status</span><span class="p">])</span>
                <span class="k">except</span> <span class="n">T</span><span class="o">.</span><span class="n">TclError</span><span class="p">:</span>  <span class="c">#CEBALERT uh-oh</span>
                    <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_pretty_print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">s</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert a Parameter name s to a string suitable for display,</span>
<span class="sd">        if pretty_parameters is True.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">pretty_parameters</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">s</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;_&quot;</span><span class="p">,</span><span class="s">&quot; &quot;</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">n</span>


<span class="c"># CEBALERT: is there no &quot;file entry&quot; widget for Tkinter?  I see there</span>
<span class="c"># is one for Tix, but while that is listed as being in Python&#39;s</span>
<span class="c"># standard library, it&#39;s rarely actually included...</span></div>
<span class="kn">import</span> <span class="nn">tkFileDialog</span>
<span class="k">class</span> <span class="nc">HackFileEntry</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">master</span><span class="p">,</span><span class="n">var</span><span class="p">,</span><span class="o">**</span><span class="n">config</span><span class="p">):</span>
        <span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">master</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">var</span> <span class="o">=</span> <span class="n">var</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">var</span><span class="p">,</span><span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cmd</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">button</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">cmd</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">tkFileDialog</span><span class="o">.</span><span class="n">askopenfilename</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">filename</span><span class="o">!=</span><span class="s">&quot;&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>


<span class="c">######################################################################</span>
<span class="c">######################################################################</span>

<div class="viewcode-block" id="Translator"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.Translator">[docs]</a><span class="k">class</span> <span class="nc">Translator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Abstract class that</span>

<span class="sd">    Translators handle translation between objects and their</span>
<span class="sd">    string representations in the GUI.</span>

<span class="sd">        last_string2object_failed is a flag that can be set to indicate that</span>
<span class="sd">        the last string-to-object translation failed.</span>
<span class="sd">        (TkParameterized checks this attribute for indicating errors to</span>
<span class="sd">        the user.)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">last_string2object_failed</span> <span class="o">=</span> <span class="bp">False</span> <span class="c"># CEBALERT: why class attr?</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param</span><span class="p">,</span><span class="n">initial_value</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param</span> <span class="o">=</span> <span class="n">param</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_handler</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">string2object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">string_</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">object2string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">object_</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">_pass_out_msg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">msg</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg_handler</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg_handler</span><span class="o">.</span><span class="n">dynamicinfo</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Copy only translator-specific state.&quot;&quot;&quot;</span>
        <span class="n">copy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">)</span>
        <span class="n">copy</span><span class="o">.</span><span class="n">last_string2object_failed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_string2object_failed</span>
        <span class="n">copy</span><span class="o">.</span><span class="n">msg_handler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg_handler</span>
        <span class="k">return</span> <span class="n">copy</span>

</div>
<div class="viewcode-block" id="DoNothingTranslator"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.DoNothingTranslator">[docs]</a><span class="k">class</span> <span class="nc">DoNothingTranslator</span><span class="p">(</span><span class="n">Translator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs no translation. For use with Parameter types such as</span>
<span class="sd">    Boolean and String, where the representation</span>
<span class="sd">    of the object in the GUI is the object itself.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">string2object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">string_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">string_</span>

    <span class="k">def</span> <span class="nf">object2string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">object_</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">object_</span>

</div>
<span class="k">class</span> <span class="nc">BoolTranslator</span><span class="p">(</span><span class="n">DoNothingTranslator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">string2object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">string_</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">string_</span><span class="o">==</span><span class="s">&#39;None&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">string_</span><span class="p">)</span>


<span class="c"># Error messages: need to change how they&#39;re reported</span>
<span class="kn">from</span> <span class="nn">param.parameterized</span> <span class="kn">import</span> <span class="n">script_repr</span>
<span class="k">class</span> <span class="nc">ListTranslator</span><span class="p">(</span><span class="n">Translator</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param</span><span class="p">,</span><span class="n">initial_value</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ListTranslator</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_</span><span class="o">=</span><span class="n">initial_value</span>

    <span class="k">def</span> <span class="nf">string2object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">string_</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_</span>

    <span class="k">def</span> <span class="nf">object2string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">object_</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_</span><span class="o">=</span><span class="n">object_</span>
        <span class="k">return</span> <span class="n">script_repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_</span><span class="p">,[],</span><span class="s">&quot;&quot;</span><span class="p">,[])</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="Eval_ReprTranslator"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.Eval_ReprTranslator">[docs]</a><span class="k">class</span> <span class="nc">Eval_ReprTranslator</span><span class="p">(</span><span class="n">Translator</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Translates a string to an object by eval()ing the string in</span>
<span class="sd">    __main__.__dict__ (i.e. as if the string were typed at the</span>
<span class="sd">    commandline), and translates an object to a string by</span>
<span class="sd">    repr(object).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">last_object</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">last_string</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param</span><span class="p">,</span><span class="n">initial_value</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Eval_ReprTranslator</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">param</span><span class="p">,</span><span class="n">initial_value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object2string</span><span class="p">(</span><span class="n">initial_value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_object</span> <span class="o">=</span> <span class="n">initial_value</span>

    <span class="c"># the whole last_string deal is required because of execing in main</span>
    <span class="k">def</span> <span class="nf">string2object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">string_</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">string_</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">last_string</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">last_object</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">string_</span><span class="p">,</span><span class="n">__main__</span><span class="o">.</span><span class="n">__dict__</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">last_string</span> <span class="o">=</span> <span class="n">string_</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_pass_out_msg</span><span class="p">(</span><span class="s">&quot; &quot;</span><span class="p">)</span>
                <span class="c">#print &quot;OUT:&quot;</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">,</span><span class="n">inst</span><span class="p">:</span>
                <span class="c">#print &quot;OUT:&quot;, str(sys.exc_info()[0])[11::]+&quot; (&quot;+str(inst)+&quot;)&quot;</span>
                <span class="n">m</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">inst</span><span class="p">)</span> <span class="c"># CEBALERT: clean up</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_pass_out_msg</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">last_string2object_failed</span><span class="o">=</span><span class="bp">True</span>
                <span class="k">return</span> <span class="n">string_</span> <span class="c"># HIDDEN</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">last_string2object_failed</span><span class="o">=</span><span class="bp">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_object</span>


    <span class="k">def</span> <span class="nf">object2string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">object_</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">object_</span><span class="o">==</span><span class="bp">self</span><span class="o">.</span><span class="n">last_object</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_string</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">string_</span><span class="o">=</span><span class="n">script_repr</span><span class="p">(</span><span class="n">object_</span><span class="p">,[],</span><span class="s">&quot;&quot;</span><span class="p">,[])</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="s">&quot;&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">last_object</span> <span class="o">=</span> <span class="n">object_</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">last_string</span> <span class="o">=</span> <span class="n">string_</span>
            <span class="k">return</span> <span class="n">string_</span>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Eval_ReprTranslator</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span>
        <span class="n">n</span><span class="o">.</span><span class="n">last_string</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_string</span>
        <span class="n">n</span><span class="o">.</span><span class="n">last_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_object</span>
        <span class="k">return</span> <span class="n">n</span>


<span class="c"># CEBALERT: I hacked on support for non-hashable types like array (now</span>
<span class="c"># have cache as {string: id(object)} and _cache_objects as</span>
<span class="c"># {id(object): object}). The whole concept of translators needs</span>
<span class="c"># revisiting anyway.</span></div>
<span class="k">class</span> <span class="nc">String_ObjectTranslator</span><span class="p">(</span><span class="n">Translator</span><span class="p">):</span>

    <span class="n">cache</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">nam</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_cache_objects</span><span class="p">[</span><span class="n">objid</span><span class="p">])</span>
                                        <span class="k">for</span> <span class="n">nam</span><span class="p">,</span><span class="n">objid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">items</span><span class="p">()]))</span>

    <span class="n">_cache</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">_cache_objects</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param</span><span class="p">,</span><span class="n">initial_value</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">String_ObjectTranslator</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">param</span><span class="p">,</span><span class="n">initial_value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cache_objects</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">string2object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">string_</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">string_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_objects</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">string_</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">string_</span>

    <span class="k">def</span> <span class="nf">object2string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">object_</span><span class="p">):</span>
        <span class="n">inverse_cache</span> <span class="o">=</span> <span class="n">inverse</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">id</span><span class="p">(</span><span class="n">object_</span><span class="p">)</span> <span class="ow">in</span> <span class="n">inverse_cache</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">inverse_cache</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">object_</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">object_</span>


    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">nam</span><span class="p">,</span><span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">get_range</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">nam</span><span class="p">]</span> <span class="o">=</span> <span class="nb">id</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cache_objects</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">obj</span><span class="p">)]</span> <span class="o">=</span> <span class="n">obj</span>


    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">String_ObjectTranslator</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span>
        <span class="n">n</span><span class="o">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span>
        <span class="n">n</span><span class="o">.</span><span class="n">_cache_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_objects</span>
        <span class="k">return</span> <span class="n">n</span>



<span class="k">class</span> <span class="nc">CSPTranslator</span><span class="p">(</span><span class="n">String_ObjectTranslator</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">string2object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">string_</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">CSPTranslator</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">string2object</span><span class="p">(</span><span class="n">string_</span><span class="p">)</span>
        <span class="c">## instantiate if it&#39;s just a class</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="nb">type</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">string_</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">string_</span><span class="p">]</span><span class="o">=</span><span class="nb">id</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cache_objects</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">obj</span><span class="p">)]</span><span class="o">=</span><span class="n">obj</span>

        <span class="k">return</span> <span class="n">obj</span>

    <span class="k">def</span> <span class="nf">object2string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">object_</span><span class="p">):</span>
        <span class="c">## replace class if we already have object</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">objid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cache_objects</span><span class="p">[</span><span class="n">objid</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">object_</span><span class="p">)</span> <span class="ow">is</span> <span class="n">obj</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">object_</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">=</span><span class="nb">id</span><span class="p">(</span><span class="n">object_</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_cache_objects</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">object_</span><span class="p">)]</span><span class="o">=</span> <span class="n">object_</span>
        <span class="c">##</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">CSPTranslator</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">object2string</span><span class="p">(</span><span class="n">object_</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># because this one&#39;s object2string can modify cache</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">Translator</span><span class="o">.</span><span class="n">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">n</span><span class="o">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
        <span class="n">n</span><span class="o">.</span><span class="n">_cache_objects</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cache_objects</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">n</span>


<span class="k">def</span> <span class="nf">param_is_dynamically_generated</span><span class="p">(</span><span class="n">param</span><span class="p">,</span><span class="n">po</span><span class="p">):</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">param</span><span class="p">,</span><span class="s">&#39;_value_is_dynamic&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">False</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">po</span><span class="p">,</span><span class="n">Parameterized</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">param</span><span class="o">.</span><span class="n">_value_is_dynamic</span><span class="p">(</span><span class="n">po</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">po</span><span class="p">,</span><span class="n">ParameterizedMetaclass</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">param</span><span class="o">.</span><span class="n">_value_is_dynamic</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;po must be a Parameterized or ParameterizedMetaclass.&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="ParametersFrame"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.ParametersFrame">[docs]</a><span class="k">class</span> <span class="nc">ParametersFrame</span><span class="p">(</span><span class="n">TkParameterized</span><span class="p">,</span><span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Displays and allows instantaneous editing of the Parameters</span>
<span class="sd">    of a supplied Parameterized.</span>

<span class="sd">    Changes made to Parameter representations on the GUI are</span>
<span class="sd">    immediately applied to the underlying object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Defaults</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;Return values to class defaults.&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="n">Refresh</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="s">&quot;Return values to those currently set on the object (or, if editing a class, to those currently set on the class).&quot;</span><span class="p">)</span>

    <span class="c"># CEBALERT: this is a Frame, so close isn&#39;t likely to make</span>
    <span class="c"># sense. But fortunately the close button acts on master.</span>
    <span class="c"># Just be sure not to use this button when you don&#39;t want</span>
    <span class="c"># the master window to vanish (e.g. in the model editor).</span>
    <span class="n">Close</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="s">&quot;Close the window. (If applicable, asks if unsaved changes should be saved).&quot;</span><span class="p">)</span>

    <span class="n">display_threshold</span> <span class="o">=</span> <span class="n">Number</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">precedence</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span><span class="n">doc</span><span class="o">=</span><span class="s">&quot;Parameters with precedence below this value are not displayed.&quot;</span><span class="p">)</span>

    <span class="n">show_labels</span> <span class="o">=</span> <span class="n">Boolean</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">master</span><span class="p">,</span><span class="n">parameterized_object</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">on_set</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">on_modify</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">msg_handler</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">on_close</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a ParametersFrame with the specifed master, and</span>
<span class="sd">        representing the Parameters of parameterized_object.</span>

<span class="sd">        on_set is an optional function to call whenever any of the</span>
<span class="sd">        GUI variables representing Parameter values is set() by the</span>
<span class="sd">        GUI (i.e. by the user). Since a variable&#39;s value is not</span>
<span class="sd">        necessarily changed by such a set(), on_modify is another</span>
<span class="sd">        optional function to call only when a GUI variable&#39;s value</span>
<span class="sd">        actually changes. (See TkParameterized for more detail.)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">master</span><span class="p">,</span><span class="n">borderwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">relief</span><span class="o">=</span><span class="s">&#39;raised&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">on_set</span> <span class="o">=</span> <span class="n">on_set</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_modify</span> <span class="o">=</span> <span class="n">on_modify</span>

        <span class="n">TkParameterized</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">master</span><span class="p">,</span>
                                 <span class="n">extraPO</span><span class="o">=</span><span class="n">parameterized_object</span><span class="p">,</span>
                                 <span class="n">self_first</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                                 <span class="n">msg_handler</span><span class="o">=</span><span class="n">msg_handler</span><span class="p">,</span>
                                 <span class="o">**</span><span class="n">params</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">on_set</span> <span class="o">=</span> <span class="n">on_set</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_modify</span> <span class="o">=</span> <span class="n">on_modify</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">on_close</span> <span class="o">=</span> <span class="n">on_close</span>

        <span class="c">## Frame for the Parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_params_frame</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_params_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;top&#39;</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="s">&#39;yes&#39;</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="s">&#39;both&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">params_to_display</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currently_displayed_params</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">parameterized_object</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_PO</span><span class="p">(</span><span class="n">parameterized_object</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_create_button_panel</span><span class="p">()</span>


        <span class="c"># CEBALERT: just because callers assume this pack()s itself.</span>
        <span class="c"># Really it should be left to callers i.e. this should be removed.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">expand</span><span class="o">=</span><span class="s">&#39;yes&#39;</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="s">&#39;both&#39;</span><span class="p">)</span>


<div class="viewcode-block" id="ParametersFrame.hidden_param"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.ParametersFrame.hidden_param">[docs]</a>    <span class="k">def</span> <span class="nf">hidden_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if a parameter&#39;s precedence is below the display threshold.&quot;&quot;&quot;</span>
        <span class="c"># interpret a precedence of None as 0</span>
        <span class="n">precedence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_object</span><span class="p">(</span><span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">precedence</span> <span class="ow">or</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="n">precedence</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">display_threshold</span>

</div>
    <span class="k">def</span> <span class="nf">_create_button_panel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add the buttons in their own panel (frame).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c">## Buttons</span>
        <span class="c">#</span>
        <span class="c"># Our button order (when all buttons present):</span>
        <span class="c"># [Defaults] [Refresh] [Apply] [Close]</span>
        <span class="c">#</span>
        <span class="c"># Our button - Windows</span>
        <span class="c"># Close(yes) - OK</span>
        <span class="c"># Close(no ) - Cancel</span>
        <span class="c"># [X]        - Cancel</span>
        <span class="c"># Apply      - Apply</span>
        <span class="c"># Defaults   -</span>
        <span class="c"># Refresh    - Reset</span>
        <span class="c">#</span>
        <span class="c"># I think Windows users will head for the window&#39;s [X]</span>
        <span class="c"># when they want to close and cancel their changes,</span>
        <span class="c"># because they won&#39;t know if [Close] saves their changes</span>
        <span class="c"># or not (until they press it, and find that it asks).</span>
        <span class="c">#</span>
        <span class="c">#</span>
        <span class="c"># Some links that discuss and address what order to use for buttons:</span>
        <span class="c">#</span>
        <span class="c"># http://java.sun.com/products/jlf/ed2/book/HIG.Dialogs2.html</span>
        <span class="c"># http://developer.kde.org/documentation/books/kde-2.0-development/ch08lev1sec6.html</span>
        <span class="c"># http://developer.kde.org/documentation/standards/kde/style/dialogs/index.html</span>
        <span class="c"># http://doc.trolltech.com/qq/qq19-buttons.html</span>


        <span class="c"># Catch click on the [X]: like clicking [Close]</span>
        <span class="c"># CEBALERT: but what if this frame isn&#39;t in its own window!</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">protocol</span><span class="p">(</span><span class="s">&quot;WM_DELETE_WINDOW&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_close_button</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="n">buttons_frame</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">borderwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">relief</span><span class="o">=</span><span class="s">&#39;sunken&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buttons_frame</span> <span class="o">=</span> <span class="n">buttons_frame</span>
        <span class="n">buttons_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&quot;bottom&quot;</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="s">&quot;no&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_buttons_frame_left</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">buttons_frame</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buttons_frame_left</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="s">&#39;yes&#39;</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="s">&#39;x&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_buttons_frame_right</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">buttons_frame</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_buttons_frame_right</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;right&#39;</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="s">&#39;yes&#39;</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="s">&#39;x&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pack_param</span><span class="p">(</span><span class="s">&#39;Defaults&#39;</span><span class="p">,</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_buttons_frame_left</span><span class="p">,</span>
                        <span class="n">on_set</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaults_button</span><span class="p">,</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pack_param</span><span class="p">(</span><span class="s">&#39;Refresh&#39;</span><span class="p">,</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_buttons_frame_left</span><span class="p">,</span>
                        <span class="n">on_set</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_refresh_button</span><span class="p">,</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pack_param</span><span class="p">(</span><span class="s">&#39;Close&#39;</span><span class="p">,</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_buttons_frame_right</span><span class="p">,</span>
                        <span class="n">on_set</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_close_button</span><span class="p">,</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;right&#39;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_refresh_button</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See Refresh parameter.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params_to_display</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">_defaults_button</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See Defaults parameter.&quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span><span class="p">,</span><span class="n">Parameterized</span><span class="p">)</span>
        <span class="n">defaults</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span><span class="o">.</span><span class="n">defaults</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">param_name</span><span class="p">,</span><span class="n">val</span> <span class="ow">in</span> <span class="n">defaults</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_param</span><span class="p">(</span><span class="n">param_name</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gui_set_param</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span><span class="n">val</span><span class="p">)</span>
                <span class="c"># tag_set() must be called in order to visually update the slider</span>
                <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">param_name</span><span class="p">][</span><span class="s">&#39;widget&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="s">&#39;tag_set&#39;</span><span class="p">):</span><span class="n">w</span><span class="o">.</span><span class="n">tag_set</span><span class="p">()</span>


        <span class="c"># CEBALERT: why doesn&#39;t this first check that something has actually changed?</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_modify</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_modify</span><span class="p">()</span>


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_set</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_set</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_idletasks</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">_close_button</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See Close parameter.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_close</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">on_close</span><span class="p">()</span>

        <span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="o">.</span><span class="n">destroy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="c"># hmm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">set_PO</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parameterized_object</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">change_PO</span><span class="p">(</span><span class="n">parameterized_object</span><span class="p">)</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s">&quot;Parameters of &quot;</span><span class="o">+</span> <span class="p">(</span><span class="n">parameterized_object</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">parameterized_object</span><span class="p">))</span> <span class="c"># (name for class is None)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="c"># can only set window title on a window (model editor puts frame in another frame)</span>
            <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;_name_param_value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">title</span>


        <span class="c">### Pack all of the non-hidden Parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params_to_display</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">p</span> <span class="ow">in</span> <span class="n">parameterized_object</span><span class="o">.</span><span class="n">params</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">hidden_param</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">params_to_display</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">=</span><span class="n">p</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pack_params_to_display</span><span class="p">()</span>

        <span class="c"># hide Defaults button for classes</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parameterized_object</span><span class="p">,</span><span class="nb">type</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hide_param</span><span class="p">(</span><span class="s">&#39;Defaults&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unhide_param</span><span class="p">(</span><span class="s">&#39;Defaults&#39;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_wipe_currently_displayed_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Wipe old labels and widgets from screen.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">rep</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currently_displayed_params</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">rep</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">rep</span><span class="p">[</span><span class="n">w</span><span class="p">]</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
                <span class="k">except</span><span class="p">:</span> <span class="c"># e.g. buttons have None for label (&#39;notNonelabel&#39;)</span>
                    <span class="k">pass</span>


    <span class="k">def</span> <span class="nf">_grid_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parameter_name</span><span class="p">,</span><span class="n">row</span><span class="p">):</span>
        <span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">parameter_name</span><span class="p">][</span><span class="s">&#39;widget&#39;</span><span class="p">]</span>
        <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">parameter_name</span><span class="p">][</span><span class="s">&#39;label&#39;</span><span class="p">]</span>

        <span class="c"># CB: (I know about the code duplication here &amp; in tkpo)</span>
        <span class="n">param_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_object</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">)</span>
        <span class="n">help_text</span> <span class="o">=</span> <span class="n">getdoc</span><span class="p">(</span><span class="n">param_obj</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">param_obj</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c"># some params appear to have no docs!!!</span>
            <span class="k">if</span> <span class="n">help_text</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">help_text</span><span class="o">+=</span><span class="s">&quot;</span><span class="se">\n\n</span><span class="s">Default: </span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">_object2string</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">,</span><span class="n">param_obj</span><span class="o">.</span><span class="n">default</span><span class="p">,</span><span class="n">replace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_labels</span><span class="p">:</span>
            <span class="n">label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span><span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                       <span class="n">padx</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">pady</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">sticky</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">E</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">balloon</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">help_text</span><span class="p">)</span>

        <span class="c"># We want widgets to stretch to both sides...</span>
        <span class="n">posn</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">E</span><span class="o">+</span><span class="n">T</span><span class="o">.</span><span class="n">W</span>
        <span class="c"># ...except Checkbuttons, which should be left-aligned.</span>
        <span class="k">if</span> <span class="n">widget</span><span class="o">.</span><span class="n">__class__</span><span class="o">==</span><span class="n">T</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">:</span>
            <span class="n">posn</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">W</span>

        <span class="n">widget</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span>
                    <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">padx</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">pady</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">sticky</span><span class="o">=</span><span class="n">posn</span><span class="p">)</span>

        <span class="c"># widgets expand to fill frame</span>
        <span class="n">widget</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">grid_columnconfigure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">weight</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_post_add_param</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">)</span>




    <span class="k">def</span> <span class="nf">_make_representation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">w</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
                <span class="k">except</span><span class="p">:</span> <span class="c">#e.g. buttons have None for label (&#39;notNonelabel&#39;)</span>
                    <span class="k">pass</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">n</span><span class="p">]</span>

        <span class="n">widget</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_widget</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_params_frame</span><span class="p">,</span>
                                           <span class="n">on_set</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">on_set</span><span class="p">,</span>
                                           <span class="n">on_modify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">on_modify</span><span class="p">)</span>

        <span class="n">label</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;Double-Button-1&gt;&quot;</span><span class="p">,</span><span class="k">lambda</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">name</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">switch_dynamic</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;widget&#39;</span><span class="p">:</span><span class="n">widget</span><span class="p">,</span><span class="s">&#39;label&#39;</span><span class="p">:</span><span class="n">label</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_indicate_tkvar_status</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>



    <span class="k">def</span> <span class="nf">pack_params_to_display</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wipe_currently_displayed_params</span><span class="p">()</span>

        <span class="c">### sort Parameters by reverse precedence</span>
        <span class="n">parameter_precedences</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">parameter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params_to_display</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">parameter_precedences</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">=</span><span class="n">parameter</span><span class="o">.</span><span class="n">precedence</span>
        <span class="n">sorted_parameter_names</span> <span class="o">=</span> <span class="n">keys_sorted_by_value</span><span class="p">(</span><span class="n">parameter_precedences</span><span class="p">)</span>

        <span class="c">### create the labels &amp; widgets</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params_to_display</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_make_representation</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="c">### add widgets &amp; labels to screen in a grid</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sorted_parameter_names</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">row</span><span class="p">,</span><span class="n">parameter_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span><span class="n">sorted_parameter_names</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_grid_param</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">,</span><span class="n">row</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">currently_displayed_params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">param_name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">param_name</span><span class="p">])</span>
                                          <span class="k">for</span> <span class="n">param_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params_to_display</span><span class="p">])</span>
        <span class="c">#self.event_generate(&quot;&lt;&lt;SizeRight&gt;&gt;&quot;)</span>


    <span class="c"># CEBALERT: rename</span>
    <span class="k">def</span> <span class="nf">_edit_PO_in_currently_selected_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Open a new window containing a ParametersFrame (actually, a</span>
<span class="sd">        type(self)) for the PO in _currently_selected_widget.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># CEBALERT: simplify this lookup by value</span>
        <span class="n">param_name</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">representation</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currently_selected_widget</span> <span class="ow">is</span> <span class="n">representation</span><span class="p">[</span><span class="s">&#39;widget&#39;</span><span class="p">]:</span>
                <span class="n">param_name</span><span class="o">=</span><span class="n">name</span>
                <span class="k">break</span>

        <span class="c"># CEBALERT: should have used get_parameter_value(param_name)?</span>
        <span class="n">PO_to_edit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_string2object</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">param_name</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>

        <span class="n">parameter_window</span> <span class="o">=</span> <span class="n">AppWindow</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">parameter_window</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">PO_to_edit</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s">&#39; parameters&#39;</span><span class="p">)</span>

        <span class="c">### CEBALERT: confusing? ###</span>
        <span class="n">title</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">parameter_window</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s">&quot;(&quot;</span><span class="o">+</span><span class="n">param_name</span> <span class="o">+</span> <span class="s">&quot; of &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span><span class="o">.</span><span class="n">name</span> <span class="ow">or</span> <span class="s">&#39;class &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span><span class="p">)</span>
        <span class="n">title</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span> <span class="o">=</span> <span class="s">&quot;top&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">balloon</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">title</span><span class="p">,</span><span class="n">getdoc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_object</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span><span class="p">)))</span>
        <span class="c">############################</span>

        <span class="c"># CEBALERT: don&#39;t want EditingParametersFrameWithApply</span>
        <span class="n">t</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">__name__</span><span class="o">==</span><span class="s">&#39;EditingParametersFrameWithApply&#39;</span><span class="p">:</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">ParametersFrameWithApply</span>

        <span class="n">parameter_frame</span> <span class="o">=</span> <span class="n">t</span><span class="p">(</span><span class="n">parameter_window</span><span class="p">,</span><span class="n">parameterized_object</span><span class="o">=</span><span class="n">PO_to_edit</span><span class="p">,</span><span class="n">msg_handler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">msg_handler</span><span class="p">,</span><span class="n">on_set</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">on_set</span><span class="p">,</span><span class="n">on_modify</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">on_modify</span><span class="p">)</span>
        <span class="n">parameter_frame</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>

        <span class="c"># CEBALERT: need to get the list item to update in parent if editing via a right click</span>
        <span class="c"># properties frame. need to get a new representation into translator.</span>
        <span class="c">#parameter_frame._apply_hooks.append(lambda *args:self._refresh_value(param_name))</span>


        <span class="c"># CEBALERT: need to sort out all this stuff in the tkpo/pf</span>
        <span class="c"># hierarchy</span>

<span class="c">##     def unpack_param(self,param_name):</span>
<span class="c">##     def hide_param(self,param_name):</span>
<span class="c">##     def unhide_param(self,param_name):</span>

    <span class="k">def</span> <span class="nf">repack_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param_name</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_refresh_value</span><span class="p">(</span><span class="n">param_name</span><span class="p">)</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">param_name</span><span class="p">]</span>
        <span class="n">widget</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="s">&#39;widget&#39;</span><span class="p">],</span><span class="n">r</span><span class="p">[</span><span class="s">&#39;label&#39;</span><span class="p">]</span>
        <span class="n">row</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">widget</span><span class="o">.</span><span class="n">grid_info</span><span class="p">()[</span><span class="s">&#39;row&#39;</span><span class="p">])</span>

        <span class="n">widget</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
        <span class="n">label</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>

        <span class="n">param</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_object</span><span class="p">(</span><span class="n">param_name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_create_translator</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span><span class="n">param</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_representation</span><span class="p">(</span><span class="n">param_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_grid_param</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span><span class="n">row</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_refresh_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param_name</span><span class="p">):</span>
        <span class="k">pass</span>


</div>
<div class="viewcode-block" id="ParametersFrameWithApply"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.ParametersFrameWithApply">[docs]</a><span class="k">class</span> <span class="nc">ParametersFrameWithApply</span><span class="p">(</span><span class="n">ParametersFrame</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Displays and allows editing of the Parameters of a supplied</span>
<span class="sd">    Parameterized.</span>

<span class="sd">    Changes made to Parameter representations in the GUI are not</span>
<span class="sd">    applied to the underlying object until Apply is pressed.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c"># CEBENHANCEMENT: might be nice to make Apply button blue like the</span>
    <span class="c"># unapplied changes, but can&#39;t currently set button color.</span>
    <span class="n">Apply</span> <span class="o">=</span> <span class="n">Button</span><span class="p">(</span><span class="n">doc</span><span class="o">=</span><span class="s">&quot;&quot;&quot;Set object&#39;s Parameters to displayed values.</span><span class="se">\n</span><span class="s"></span>
<span class="s">                          When editing a class, sets the class defaults</span>
<span class="s">                          (i.e. acts on the class object).&quot;&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">master</span><span class="p">,</span><span class="n">parameterized_object</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">on_set</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">on_modify</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_apply_hooks</span><span class="o">=</span><span class="p">[]</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ParametersFrameWithApply</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">master</span><span class="p">,</span>
                                                      <span class="n">parameterized_object</span><span class="p">,</span>
                                                      <span class="n">on_set</span><span class="p">,</span><span class="n">on_modify</span><span class="p">,</span>
                                                      <span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_live_update</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="c">### CEBALERT: describe why this apply is different from Apply</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_immediately_apply_change</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_immediately_apply_change</span><span class="p">[</span><span class="n">p</span><span class="p">]</span><span class="o">=</span><span class="bp">True</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">pack_param</span><span class="p">(</span><span class="s">&#39;Apply&#39;</span><span class="p">,</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_buttons_frame_right</span><span class="p">,</span>
                        <span class="n">on_set</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_apply_button</span><span class="p">,</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">)</span>

        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_unapplied_change</span><span class="p">()</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">,</span> <span class="s">&quot;ParametersFrame altered a value on opening. If possible, please file a bug report on the website describing what you were doing when you received this error.&quot;</span>

        <span class="c"># CEBALERT: should use existing code</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="s">&#39;Apply&#39;</span><span class="p">][</span><span class="s">&#39;widget&#39;</span><span class="p">][</span><span class="s">&#39;state&#39;</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;disabled&#39;</span>


    <span class="k">def</span> <span class="nf">_create_string_widget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">frame</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">widget_options</span><span class="p">):</span>
        <span class="c"># don&#39;t want immediate updates, so unbind update events</span>
        <span class="n">w</span><span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">ParametersFrameWithApply</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_create_string_widget</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">widget_options</span><span class="p">)</span>
        <span class="n">w</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s">&#39;&lt;Return&gt;&#39;</span><span class="p">)</span>
        <span class="n">w</span><span class="o">.</span><span class="n">unbind</span><span class="p">(</span><span class="s">&#39;&lt;FocusOut&gt;&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">w</span>


    <span class="k">def</span> <span class="nf">set_PO</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parameterized_object</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ParametersFrameWithApply</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">set_PO</span><span class="p">(</span><span class="n">parameterized_object</span><span class="p">)</span>

        <span class="c"># (don&#39;t want to update parameters immediately)</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">v</span><span class="o">.</span><span class="n">_checking_get</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">get</span>
            <span class="n">v</span><span class="o">.</span><span class="n">get</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">_original_get</span>


<div class="viewcode-block" id="ParametersFrameWithApply.has_unapplied_change"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.ParametersFrameWithApply.has_unapplied_change">[docs]</a>    <span class="k">def</span> <span class="nf">has_unapplied_change</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return True if any one of the packed parameters&#39; displayed values is different from</span>
<span class="sd">        that on the object.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params_to_display</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tkvar_changed</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">True</span>
        <span class="k">return</span> <span class="bp">False</span>
</div>
    <span class="k">def</span> <span class="nf">_indicate_tkvar_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param_name</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tkvar_changed</span><span class="p">(</span><span class="n">param_name</span><span class="p">):</span>
            <span class="n">status</span> <span class="o">=</span> <span class="s">&#39;changed&#39;</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">ParametersFrameWithApply</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_indicate_tkvar_status</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span><span class="n">status</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_handle_gui_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">p_name</span><span class="p">,</span><span class="n">force</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="c">#print &quot;ParametersFrame._handle_gui_set&quot;,p_name</span>
        <span class="n">TkParameterized</span><span class="o">.</span><span class="n">_handle_gui_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">p_name</span><span class="p">,</span><span class="n">force</span><span class="p">)</span>

        <span class="k">if</span> <span class="s">&#39;Apply&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">:</span>
            <span class="n">w</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="s">&#39;Apply&#39;</span><span class="p">][</span><span class="s">&#39;widget&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_unapplied_change</span><span class="p">():</span>
                <span class="n">state</span><span class="o">=</span><span class="s">&#39;normal&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">state</span><span class="o">=</span><span class="s">&#39;disable&#39;</span>

            <span class="n">w</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="n">state</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_close_button</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># CEBERRORALERT: dialog box should include a cancel button</span>
        <span class="c"># Also, changes are *not* applied if one of the boxes is in</span>
        <span class="c"># error.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_unapplied_change</span><span class="p">()</span> \
               <span class="ow">and</span> <span class="n">askyesno</span><span class="p">(</span><span class="s">&quot;Close&quot;</span><span class="p">,</span><span class="s">&quot;Apply changes before closing?&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_apply_button</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ParametersFrameWithApply</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_close_button</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">update_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span><span class="p">,</span><span class="nb">type</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params_to_display</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="c">#if self._tkvar_changed(name):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_update_param_from_tkvar</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">param</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params_to_display</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">param</span><span class="o">.</span><span class="n">constant</span><span class="p">:</span>  <span class="c">#and self._tkvar_changed(name):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_update_param_from_tkvar</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_apply_button</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_parameters</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refresh_button</span><span class="p">(</span><span class="n">overwrite_error</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="c"># CEBALERT: because overriding a method that\s already been</span>
        <span class="c"># installed as a callback does nothing</span>
        <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_hooks</span><span class="p">:</span>
            <span class="n">h</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c"># CEBALERT: how does apply button&#39;s status change now? Doesn&#39;t</span>
        <span class="c"># work properly for list editing; stays grey until clicked twice.</span>

    <span class="k">def</span> <span class="nf">_refresh_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">param_name</span><span class="p">):</span>
        <span class="n">po_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_parameter_value</span><span class="p">(</span><span class="n">param_name</span><span class="p">)</span>
        <span class="n">po_stringrep</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_object2string</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span><span class="n">po_val</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">param_name</span><span class="p">]</span><span class="o">.</span><span class="n">_original_set</span><span class="p">(</span><span class="n">po_stringrep</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_refresh_button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">overwrite_error</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params_to_display</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">translators</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">last_string2object_failed</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">overwrite_error</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_refresh_value</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="c">#print self._tkvars[name]._checking_get()</span>
                <span class="c"># CEBALERT: taggedsliders need to have tag_set() called to update slider</span>
                <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;widget&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="s">&#39;tag_set&#39;</span><span class="p">):</span><span class="n">w</span><span class="o">.</span><span class="n">tag_set</span><span class="p">()</span>

<span class="c"># CB: can override tracefn so that Apply/Refresh buttons are enabled/disabled as appropriate</span>
</div>
<div class="viewcode-block" id="edit_parameters"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.edit_parameters">[docs]</a><span class="k">def</span> <span class="nf">edit_parameters</span><span class="p">(</span><span class="n">parameterized</span><span class="p">,</span><span class="n">with_apply</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Edit the Parameters of a supplied parameterized instance or class.</span>

<span class="sd">    Specify with_apply=False for a ParametersFrame (which immediately</span>
<span class="sd">    updates the object - no need to press the Apply button).</span>

<span class="sd">    Extra params are passed to the ParametersFrame constructor.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">with_apply</span><span class="p">:</span>
        <span class="n">pf_class</span> <span class="o">=</span> <span class="n">ParametersFrame</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pf_class</span> <span class="o">=</span> <span class="n">ParametersFrameWithApply</span>

    <span class="k">return</span> <span class="n">pf_class</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">(),</span><span class="n">parameterized</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>










<span class="c"># Barely wrapped tooltip from tklib.</span>
<span class="c"># CB: this isn&#39;t the right way to do it, and it breaks menubar</span>
<span class="c"># tips for some reason, but user code didn&#39;t have to change.</span>
</div>
<span class="k">class</span> <span class="nc">Balloon</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">Widget</span><span class="p">):</span>

    <span class="n">_tkname</span> <span class="o">=</span> <span class="s">&#39;::tooltip::tooltip&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">master</span><span class="p">,</span><span class="n">cnf</span><span class="o">=</span><span class="p">{},</span><span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">master</span><span class="o">.</span><span class="n">tk</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s">&quot;package&quot;</span><span class="p">,</span><span class="s">&quot;require&quot;</span><span class="p">,</span><span class="s">&quot;tooltip&quot;</span><span class="p">)</span>
        <span class="n">T</span><span class="o">.</span><span class="n">Widget</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_tkname</span><span class="p">,</span> <span class="n">cnf</span><span class="p">,</span> <span class="n">kw</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">bind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        e.g. for a Button b and a Menu m with item &#39;Quit&#39; in a T.Toplevel t</span>

<span class="sd">        balloon = Balloon(t)</span>
<span class="sd">        balloon.bind(b,&#39;some guidance&#39;)</span>
<span class="sd">        balloon.bind(m,&#39;Quit&#39;,&#39;more guidance&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tk</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tkname</span><span class="p">,</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_w</span><span class="p">,</span><span class="s">&#39;-index&#39;</span><span class="p">,</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tk</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tkname</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

<span class="c">##     def tagbind(self,*args,**kw):</span>
<span class="c">##         print &quot;### Balloon.tagbind(): not yet implemented error ###&quot;</span>



<span class="c"># CEBALERT: should be renamed to something like IndexMenu, but then</span>
<span class="c"># I am not sure if some of our tk hacks would work (e.g. in topoconsole,</span>
<span class="c"># we set something for Menu on linux so that the popup behavior is</span>
<span class="c"># reasonable).</span>
<div class="viewcode-block" id="Menu"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.Menu">[docs]</a><span class="k">class</span> <span class="nc">Menu</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">Menu</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Tkinter Menu, but with a way to access entries by name.</span>

<span class="sd">    Entries can be accessed via the label supplied when the entry is</span>
<span class="sd">    add()ed or insert()ed. For an entry whose label could change, you</span>
<span class="sd">    can supply &#39;indexname&#39;, which can then be used to access the entry</span>
<span class="sd">    no matter what the label might have become.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c">## (Original Menu class is in lib/python2.4/lib-tk/Tkinter.py)</span>

<div class="viewcode-block" id="Menu.get_tkinter_index"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.Menu.get_tkinter_index">[docs]</a>    <span class="k">def</span> <span class="nf">get_tkinter_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the Tkinter index, whether given an indexname or index</span>
<span class="sd">        (where index could be an int or Tkinter position e.g. &#39;end&#39;).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexname2index</span><span class="p">:</span>
                <span class="n">i</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">indexname2index</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c"># pass through tkinter to get &#39;end&#39; etc converted to index</span>
                <span class="n">i</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span><span class="o">=</span><span class="n">index</span>
        <span class="k">return</span> <span class="n">i</span>

</div>
<div class="viewcode-block" id="Menu.get_indexname"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.Menu.get_indexname">[docs]</a>    <span class="k">def</span> <span class="nf">get_indexname</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the indexname, whether given an indexname or index</span>
<span class="sd">        (where index could be an int or Tkinter position e.g. &#39;end&#39;).</span>

<span class="sd">        The returned value will be None if index refers to an unnamed</span>
<span class="sd">        entry.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexname2index</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">index</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexname2index</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">==</span><span class="n">i</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">name</span>
        <span class="k">return</span> <span class="bp">None</span>

</div>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">cnf</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="c"># Creates two internal indexes to track names and commands</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indexname2index</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c"># rename to indexnames2index or similar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">named_commands</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">T</span><span class="o">.</span><span class="n">Menu</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">master</span><span class="p">,</span><span class="n">cnf</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">__extract_indexname</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">cnf</span><span class="p">,</span><span class="n">kw</span><span class="p">):</span>
        <span class="c"># indexname will be as specified by &#39;indexname&#39; in cnf or kw,</span>
        <span class="c"># or else as specified by &#39;label&#39; in cnf or kw.</span>
        <span class="c">#</span>
        <span class="c"># indexname will be None if neither indexname nor label is</span>
        <span class="c"># specified in cnf or kw.</span>
        <span class="n">indexname</span><span class="o">=</span><span class="n">cnf</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;indexname&#39;</span><span class="p">,</span><span class="n">kw</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">&#39;indexname&#39;</span><span class="p">,</span><span class="bp">None</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">indexname</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">indexname</span> <span class="o">=</span> <span class="n">cnf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;label&#39;</span><span class="p">,</span><span class="n">kw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;label&#39;</span><span class="p">,</span><span class="bp">None</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">indexname</span>

    <span class="k">def</span> <span class="nf">_update_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">index</span><span class="p">,</span><span class="n">indexname</span><span class="p">,</span><span class="n">cnf</span><span class="p">,</span><span class="n">kw</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">indexname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">indexname2index</span><span class="p">[</span><span class="n">indexname</span><span class="p">]</span> <span class="o">=</span> <span class="n">index</span>
            <span class="c"># this pain is to keep the actual item, if it&#39;s a menu or a command, available to access</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">named_commands</span><span class="p">[</span><span class="n">indexname</span><span class="p">]</span> <span class="o">=</span> <span class="n">cnf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;menu&#39;</span><span class="p">,</span><span class="n">kw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;menu&#39;</span><span class="p">,</span><span class="n">cnf</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;command&#39;</span><span class="p">,</span><span class="n">kw</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;command&#39;</span><span class="p">,</span><span class="bp">None</span><span class="p">))))</span>


<div class="viewcode-block" id="Menu.add"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.Menu.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itemType</span><span class="p">,</span> <span class="n">cnf</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        See Tkinter.Menu.add(), but &#39;indexname&#39; can also be supplied.</span>

<span class="sd">        If supplied, indexname must be unique. If label is supplied without</span>
<span class="sd">        indexname, then label must be unique.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">indexname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__extract_indexname</span><span class="p">(</span><span class="n">cnf</span><span class="p">,</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">indexname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexname2index</span>
        <span class="n">T</span><span class="o">.</span><span class="n">Menu</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">itemType</span><span class="p">,</span><span class="n">cnf</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_indices</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s">&quot;last&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">,</span><span class="n">indexname</span><span class="p">,</span><span class="n">cnf</span><span class="p">,</span><span class="n">kw</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="Menu.insert"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.Menu.insert">[docs]</a>    <span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">itemType</span><span class="p">,</span> <span class="n">cnf</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        See Tkinter.Menu.insert(), but index can also be specified as text.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">indexname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__extract_indexname</span><span class="p">(</span><span class="n">cnf</span><span class="p">,</span><span class="n">kw</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">indexname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexname2index</span>

        <span class="c"># increase index of any item after insertion point</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexname2index</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">&gt;=</span><span class="n">index</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">indexname2index</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">+=</span><span class="mi">1</span>

        <span class="n">T</span><span class="o">.</span><span class="n">Menu</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">index</span><span class="p">,</span><span class="n">itemType</span><span class="p">,</span><span class="n">cnf</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_indices</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="n">indexname</span><span class="p">,</span><span class="n">cnf</span><span class="p">,</span><span class="n">kw</span><span class="p">)</span>

</div>
    <span class="k">def</span> <span class="nf">__delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">index1</span><span class="p">):</span>
        <span class="n">i1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tkinter_index</span><span class="p">(</span><span class="n">index1</span><span class="p">)</span>
        <span class="n">indexname1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_indexname</span><span class="p">(</span><span class="n">index1</span><span class="p">)</span>

        <span class="k">assert</span> <span class="p">(</span><span class="n">indexname1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexname2index</span> <span class="ow">or</span> <span class="n">indexname1</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">)</span>

        <span class="c"># decrease index of any item after deletion point</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexname2index</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="n">i1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">indexname2index</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">-=</span><span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">named_commands</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">indexname1</span><span class="p">,</span><span class="bp">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indexname2index</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">indexname1</span><span class="p">,</span><span class="bp">None</span><span class="p">)</span>
        <span class="n">T</span><span class="o">.</span><span class="n">Menu</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">i1</span><span class="p">,</span><span class="bp">None</span><span class="p">)</span>


<div class="viewcode-block" id="Menu.delete"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.Menu.delete">[docs]</a>    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index1</span><span class="p">,</span> <span class="n">index2</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If index2 is not specified, deletes the menu item at index1</span>
<span class="sd">        (an indexname or tk integer index).</span>

<span class="sd">        If index2 is specified, deletes menu items in</span>
<span class="sd">        range(index1,index2+1).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">index2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">index1</span><span class="p">)</span>
            <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">index2</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">end</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="n">end</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
                    <span class="c"># __delete shifts the remaining items one position back,</span>
                    <span class="c"># so repeatedly deleting the first item in the range will</span>
                    <span class="c"># delete all of them</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__delete</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__delete</span><span class="p">(</span><span class="n">index1</span><span class="p">)</span>



    <span class="c">########## METHODS OVERRIDDEN FOR CONVENIENCE</span></div>
<div class="viewcode-block" id="Menu.entryconfigure"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.Menu.entryconfigure">[docs]</a>    <span class="k">def</span> <span class="nf">entryconfigure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">cnf</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Configure a menu item at INDEX.&quot;&quot;&quot;</span>
        <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tkinter_index</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">T</span><span class="o">.</span><span class="n">Menu</span><span class="o">.</span><span class="n">entryconfigure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">cnf</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
</div>
    <span class="n">entryconfig</span> <span class="o">=</span> <span class="n">entryconfigure</span>

<div class="viewcode-block" id="Menu.invoke"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.Menu.invoke">[docs]</a>    <span class="k">def</span> <span class="nf">invoke</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Invoke a menu item identified by INDEX and execute</span>
<span class="sd">        the associated command.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">T</span><span class="o">.</span><span class="n">Menu</span><span class="o">.</span><span class="n">invoke</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">get_tkinter_index</span><span class="p">(</span><span class="n">index</span><span class="p">))</span>

    <span class="c"># other methods can be overriden if they&#39;re needed</span>


</div></div>
<div class="viewcode-block" id="TaggedSlider"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.TaggedSlider">[docs]</a><span class="k">class</span> <span class="nc">TaggedSlider</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Widget for manipulating a numeric value using either a slider or a</span>
<span class="sd">    text-entry box, keeping the two values in sync.</span>

<span class="sd">    Generates a number of Events:</span>

<span class="sd">    &lt;&lt;TagFocusOut&gt;&gt;  - tag loses focus</span>
<span class="sd">    &lt;&lt;TagReturn&gt;&gt;    - Return pressed in tag</span>
<span class="sd">    &lt;&lt;SliderSet&gt;&gt;    - slider is clicked/dragged</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">master</span><span class="p">,</span><span class="n">variable</span><span class="p">,</span><span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">inclusive_bounds</span><span class="o">=</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span><span class="bp">True</span><span class="p">),</span>
                 <span class="n">slider_length</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">tag_width</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                 <span class="n">tag_extra_config</span><span class="o">=</span><span class="p">{},</span><span class="n">slider_extra_config</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        On clicking or dragging the slider, the tag value is set</span>
<span class="sd">        to the slider&#39;s value.</span>

<span class="sd">        On pressing Return in or moving focus from the tag, the slider</span>
<span class="sd">        value is set, but also:</span>

<span class="sd">        * the range of the slider is adjusted (e.g. to fit a larger</span>
<span class="sd">          max value)</span>

<span class="sd">        * the resolution of the slider is adjusted based on the</span>
<span class="sd">          the value in the tag (e.g. 0.01 in the tag gives a</span>
<span class="sd">          resolution of 0.01), also taking into account the precision</span>
<span class="sd">          of the value in the tag (e.g. 0.0100 gives a resolution</span>
<span class="sd">          of 0.0001).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># CEBALERT: ...although respecting the precision isn&#39;t always</span>
        <span class="c"># helpful because the slider can still have a limited</span>
        <span class="c"># resolution anyway (from its length and the range, given the</span>
        <span class="c"># size of a pixel...)</span>
        <span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">master</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">=</span> <span class="n">variable</span>

        <span class="c"># CEBALERT: shouldn&#39;t this be calling set_slider_bounds()?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="n">bounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inclusive_bounds</span> <span class="o">=</span> <span class="n">inclusive_bounds</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tag</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">,</span>
                                 <span class="n">width</span><span class="o">=</span><span class="n">tag_width</span><span class="p">,</span><span class="o">**</span><span class="n">tag_extra_config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tag</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tag</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&#39;&lt;Return&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tag_press_return</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tag</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&#39;&lt;FocusOut&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tag_focus_out</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tag</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&#39;&lt;Leave&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tag_focus_out</span><span class="p">)</span>

        <span class="c"># no variable: we control the slider ourselves</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">variable</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                    <span class="n">from_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">to</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">orient</span><span class="o">=</span><span class="s">&#39;horizontal&#39;</span><span class="p">,</span><span class="n">length</span><span class="o">=</span><span class="n">slider_length</span><span class="p">,</span>
                    <span class="n">showvalue</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="o">**</span><span class="n">slider_extra_config</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;right&#39;</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="s">&quot;yes&quot;</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&#39;&lt;ButtonRelease-1&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slider_used</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&#39;&lt;B1-Motion&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_slider_used</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">tag_set</span><span class="p">()</span>


<div class="viewcode-block" id="TaggedSlider.tag_set"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.TaggedSlider.tag_set">[docs]</a>    <span class="k">def</span> <span class="nf">tag_set</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        After entering a value into the tag, this method should be</span>
<span class="sd">        called to set the slider correctly.</span>

<span class="sd">        (Called automatically for tag&#39;s &lt;Return&gt; and &lt;FocusOut&gt;</span>
<span class="sd">        events.)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c"># Set slider resolution. This is important because</span>
        <span class="c"># we want the slider to be positioned at the exact</span>
        <span class="c"># tag value.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_try_to_set_slider_resolution</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_try_to_set_slider</span><span class="p">()</span>

</div>
<div class="viewcode-block" id="TaggedSlider.set_slider_bounds"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.TaggedSlider.set_slider_bounds">[docs]</a>    <span class="k">def</span> <span class="nf">set_slider_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">lower</span><span class="p">,</span><span class="n">upper</span><span class="p">,</span><span class="n">inclusive_bounds</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set new lower and upper bounds for the slider.</span>

<span class="sd">        If specified, inclusive_bounds should be a sequence of length</span>
<span class="sd">        2 specifying True or False for the lower and upper bounds.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span><span class="n">lower</span><span class="p">,</span><span class="n">upper</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">inclusive_bounds</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inclusive_bounds</span> <span class="o">=</span> <span class="n">inclusive_bounds</span>

        <span class="n">epsilon</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="p">[</span><span class="s">&#39;resolution&#39;</span><span class="p">],</span><span class="mf">0.00000000001</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inclusive_bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="n">lower</span><span class="o">+=</span><span class="n">epsilon</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">inclusive_bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="n">upper</span><span class="o">-=</span><span class="n">epsilon</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">from_</span><span class="o">=</span><span class="n">lower</span><span class="p">,</span><span class="n">to</span><span class="o">=</span><span class="n">upper</span><span class="p">)</span>
</div>
    <span class="n">set_bounds</span> <span class="o">=</span> <span class="n">set_slider_bounds</span>


    <span class="c"># CB: why isn&#39;t this used for [] access? What should this</span>
    <span class="c"># be called? Is it configure?</span>
<div class="viewcode-block" id="TaggedSlider.config"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.TaggedSlider.config">[docs]</a>    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        TaggedSlider is a compound widget. In most cases, config</span>
<span class="sd">        options should be passed to one of the component widgets</span>
<span class="sd">        (i.e. the tag or the slider). For some options, however,</span>
<span class="sd">        we need to handle them being set on the widget as a whole;</span>
<span class="sd">        further, some of these should be applied to both component</span>
<span class="sd">        widgets, but some should just be applied to one.</span>

<span class="sd">        Options handled:</span>
<span class="sd">        * state (applied to both)</span>
<span class="sd">        * background, foreground (applied to tag only)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s">&#39;state&#39;</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tag</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">options</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">options</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">options</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s">&#39;background&#39;</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tag</span><span class="p">[</span><span class="s">&#39;background&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">options</span><span class="p">[</span><span class="s">&#39;background&#39;</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">options</span><span class="p">[</span><span class="s">&#39;background&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s">&#39;foreground&#39;</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tag</span><span class="p">[</span><span class="s">&#39;foreground&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">options</span><span class="p">[</span><span class="s">&#39;foreground&#39;</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">options</span><span class="p">[</span><span class="s">&#39;foreground&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">options</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="sd">&quot;&quot;&quot;Only state, background, and foreground options are</span>
<span class="sd">                currently supported for this widget; set options on</span>
<span class="sd">                either the component tag or slider instead.&quot;&quot;&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{}</span> <span class="c"># CEBALERT: need to return same object as Tkinter would.</span>

</div>
<div class="viewcode-block" id="TaggedSlider.get"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.TaggedSlider.get">[docs]</a>    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calls the tag&#39;s get() method.</span>

<span class="sd">        Helps to match behavior of other Tkinter Widgets.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>


    <span class="c"># CEBALERT: three different events for max. flexibility...but</span>
    <span class="c"># often a user will just want to know if the value was set. Could</span>
    <span class="c"># also generate a &quot;&lt;&lt;TaggedSliderSet&gt;&gt;&quot; event each time, which a</span>
    <span class="c"># user could just look for. Or could these events all be children</span>
    <span class="c"># of a &lt;&lt;TaggedSliderSet&gt;&gt;?</span></div>
    <span class="k">def</span> <span class="nf">_slider_used</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">event_generate</span><span class="p">(</span><span class="s">&quot;&lt;&lt;SliderSet&gt;&gt;&quot;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_tag_press_return</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">event_generate</span><span class="p">(</span><span class="s">&quot;&lt;&lt;TagReturn&gt;&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tag_set</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">_tag_focus_out</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">event_generate</span><span class="p">(</span><span class="s">&quot;&lt;&lt;TagFocusOut&gt;&gt;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tag_set</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">_set_slider_resolution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="c"># CEBALERT: how to find n. dp simply?</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">))</span><span class="o">.</span><span class="n">as_tuple</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="p">[</span><span class="s">&#39;resolution&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="n">p</span>


    <span class="k">def</span> <span class="nf">_try_to_set_slider_resolution</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Use the actual number in the box to set the slider&#39;s resolution,</span>
<span class="sd">        so that user-entered resolutions are respected (e.g. 0.1 vs 0.1000).</span>

<span class="sd">        If that&#39;s not possible (e.g. there&#39;s text in the box), use the</span>
<span class="sd">        value contained in the variable (because whatever owns the</span>
<span class="sd">        variable could have performed a conversion of the text -</span>
<span class="sd">        TkParameterized does this, for instance).</span>

<span class="sd">        Leaves the resolution as it was if no number is available.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c"># 1st choice is to get the actual number in the box:</span>
            <span class="c"># allows us to respect user-entered resolution</span>
            <span class="c"># (e.g. 0.010000)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_slider_resolution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tag</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
            <span class="k">return</span> <span class="bp">True</span>
        <span class="k">except</span><span class="p">:</span> <span class="c"># probably tclerror</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c"># ...but that might have been text.  2nd choice is to</span>
                <span class="c"># get the value from the variable (e.g. 0.01)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_slider_resolution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
                <span class="k">return</span> <span class="bp">True</span>
            <span class="k">except</span><span class="p">:</span> <span class="c"># probably tclerror</span>
                <span class="k">return</span> <span class="bp">False</span> <span class="c"># can&#39;t set a new resolution</span>


    <span class="k">def</span> <span class="nf">_try_to_set_slider</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        If the value in the box can&#39;t be converted to a float, the slider doesn&#39;t get set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tagvar_val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">tagvar_val</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_slider_bounds</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">val</span><span class="p">),</span>
                                   <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">val</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">slider</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">pass</span>

</div>
<div class="viewcode-block" id="FocusTakingButton"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.FocusTakingButton">[docs]</a><span class="k">class</span> <span class="nc">FocusTakingButton</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">Button</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Tkinter Button that takes the focus when the mouse &lt;Enter&gt;s.</span>

<span class="sd">    (Tkinter.Button doesn&#39;t get focus even when it&#39;s clicked,</span>
<span class="sd">    and only &lt;Enter&gt; and &lt;Leave&gt; events work for buttons.)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">cnf</span><span class="o">=</span><span class="p">{},</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
        <span class="n">T</span><span class="o">.</span><span class="n">Button</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">master</span><span class="o">=</span><span class="n">master</span><span class="p">,</span><span class="n">cnf</span><span class="o">=</span><span class="n">cnf</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;Enter&gt;&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">e</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">focus_set</span><span class="p">())</span>
        <span class="c">#self[&#39;highlightthickness&#39;]=0</span>


<span class="c"># CB: tklib has status bar and scrolled window (among other widgets);</span>
<span class="c"># should try them out (although they&#39;re tk only...) because we might</span>
<span class="c"># not need the scrodget pacakge.</span>

<span class="c"># Might wonder why we need &lt;&lt;SizeRight&gt;&gt; event, and don&#39;t just use the</span>
<span class="c"># &lt;Configure&gt; event for calling sizeright: Can&#39;t distinguish manual</span>
<span class="c"># resize from autoresizing.</span></div>
<div class="viewcode-block" id="ScrolledFrame"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.ScrolledFrame">[docs]</a><span class="k">class</span> <span class="nc">ScrolledFrame</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    XXXX</span>

<span class="sd">    Content to be scrolled should go in the &#39;content&#39; frame.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_getstatus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_status</span>
    <span class="k">def</span> <span class="nf">_setstatus</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">s</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_status</span> <span class="o">=</span> <span class="n">s</span>
    <span class="n">status</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_getstatus</span><span class="p">,</span><span class="n">_setstatus</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="o">**</span><span class="n">config</span><span class="p">):</span>
        <span class="k">assert</span> <span class="s">&#39;status&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">config</span>
        <span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="o">**</span><span class="n">config</span><span class="p">)</span>


        <span class="n">abovetopframe</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">topframe</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">middleframe</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">botframe</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">botframe</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&quot;bottom&quot;</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="s">&quot;yes&quot;</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="s">&quot;x&quot;</span><span class="p">)</span>
        <span class="n">abovetopframe</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&quot;top&quot;</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="s">&quot;yes&quot;</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="s">&quot;both&quot;</span><span class="p">)</span>
        <span class="n">topframe</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&quot;top&quot;</span><span class="p">)</span><span class="c">#,expand=&quot;no&quot;,fill=&quot;both&quot;)</span>
        <span class="n">middleframe</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&quot;top&quot;</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="s">&#39;yes&#39;</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="s">&#39;x&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">noscroll</span> <span class="o">=</span> <span class="n">abovetopframe</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noscroll_bottom</span> <span class="o">=</span> <span class="n">middleframe</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="n">topframe</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sc</span> <span class="o">=</span> <span class="n">Scrodget</span><span class="p">(</span><span class="n">topframe</span><span class="p">,</span><span class="n">autohide</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sc</span><span class="o">.</span><span class="n">associate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sc</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">expand</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="s">&quot;both&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">container</span> <span class="o">=</span> <span class="bp">self</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">create_window</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="p">,</span><span class="n">anchor</span><span class="o">=</span><span class="s">&#39;nw&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;SizeRight&gt;&gt;&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">sizeright</span><span class="p">)</span>

        <span class="c">#self.status = StatusBar(botframe)</span>
        <span class="c">#if status:</span>
        <span class="c">#    self.status.pack(side=&quot;bottom&quot;,fill=&quot;both&quot;,expand=&quot;yes&quot;)</span>


    <span class="k">def</span> <span class="nf">sizeright</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">update_idletasks</span><span class="p">()</span>
        <span class="n">W</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">winfo_width</span><span class="p">()</span>
        <span class="n">H</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">winfo_height</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">scrollregion</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">H</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="n">W</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="n">H</span><span class="p">)</span>


</div>
<span class="k">class</span> <span class="nc">ScrolledWindow</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">Toplevel</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="o">**</span><span class="n">config</span><span class="p">):</span>
        <span class="n">T</span><span class="o">.</span><span class="n">Toplevel</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="o">**</span><span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">maxsize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">winfo_screenwidth</span><span class="p">(),</span><span class="bp">self</span><span class="o">.</span><span class="n">winfo_screenheight</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">topframe</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c"># CEBALERT: specifying 20 necessary because otherwise nothing</span>
        <span class="c"># requests any height for the frame. I feel there should be</span>
        <span class="c"># way to have the (status) label request the right height but</span>
        <span class="c"># make no request about the width.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">botframe</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">botframe</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;bottom&#39;</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="s">&#39;no&#39;</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">topframe</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;top&#39;</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="s">&#39;yes&#39;</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="s">&#39;both&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_scrolledframe</span> <span class="o">=</span> <span class="n">ScrolledFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topframe</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scrolledframe</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">expand</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="s">&#39;both&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scrolledframe</span><span class="o">.</span><span class="n">content</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noscroll</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scrolledframe</span><span class="o">.</span><span class="n">noscroll</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noscroll_bottom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_scrolledframe</span><span class="o">.</span><span class="n">noscroll_bottom</span>

    <span class="c"># required? presumably should be deleted</span>
    <span class="k">def</span> <span class="nf">sizeright</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scrolledframe</span><span class="o">.</span><span class="n">sizeright</span><span class="p">()</span>





<span class="k">class</span> <span class="nc">ProgressController</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">timer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">sim</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">progress_var</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="o">=</span><span class="n">status</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">=</span><span class="n">sim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span> <span class="o">=</span> <span class="n">timer</span> <span class="c">#or topo.sim.timer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">receive_info</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timing_info</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">progress_var</span> <span class="o">=</span> <span class="n">progress_var</span> <span class="ow">or</span> <span class="n">T</span><span class="o">.</span><span class="n">DoubleVar</span><span class="p">()</span>
        <span class="c"># trace the variable so that at 100 we can destroy the window</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress_trace_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">progress_var</span><span class="o">.</span><span class="n">trace_variable</span><span class="p">(</span>
            <span class="s">&#39;w&#39;</span><span class="p">,</span><span class="k">lambda</span> <span class="n">name</span><span class="p">,</span><span class="n">index</span><span class="p">,</span><span class="n">mode</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_close_if_complete</span><span class="p">())</span>


    <span class="k">def</span> <span class="nf">_close_if_complete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Close the specified progress window if the value of progress_var has reached 100.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">progress_var</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">&gt;=</span><span class="mi">100</span><span class="p">:</span>
            <span class="c"># delete the variable trace (necessary?)</span>
            <span class="c">#self.progress_var.trace_vdelete(&#39;w&#39;,self.progress_trace_name)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_close</span><span class="p">(</span><span class="n">final_message</span><span class="o">=</span><span class="s">&quot;Time </span><span class="si">%s</span><span class="s">: Finished </span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">timestr</span><span class="p">(),</span>
                                                             <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">__name__</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">_close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">final_message</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">receive_info</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timing_info</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">final_message</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">response</span><span class="p">(</span><span class="n">final_message</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">timing_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">percent</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">duration</span><span class="p">,</span><span class="n">remaining</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progress_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">percent</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Declare that running should be interrupted.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">stop</span><span class="o">=</span><span class="bp">True</span>
        <span class="n">final_message</span> <span class="o">=</span> <span class="s">&quot;Time </span><span class="si">%s</span><span class="s">: Interrupted </span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sim</span><span class="o">.</span><span class="n">timestr</span><span class="p">(),</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">timer</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_close</span><span class="p">(</span><span class="n">final_message</span><span class="p">)</span>


<div class="viewcode-block" id="ProgressWindow"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.ProgressWindow">[docs]</a><span class="k">class</span> <span class="nc">ProgressWindow</span><span class="p">(</span><span class="n">ProgressController</span><span class="p">,</span><span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Graphically displays progress information for a SomeTimer object.</span>

<span class="sd">    ** Currently expects a 0-100 (percent) value ***</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">sim</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">timer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">progress_var</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">title</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">unpack_master_when_done</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="n">ProgressController</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">timer</span><span class="o">=</span><span class="n">timer</span><span class="p">,</span><span class="n">sim</span><span class="o">=</span><span class="n">sim</span><span class="p">,</span>
                                    <span class="n">progress_var</span><span class="o">=</span><span class="n">progress_var</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="n">status</span><span class="p">)</span>
        <span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">balloon</span> <span class="o">=</span> <span class="n">Balloon</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_master</span><span class="o">=</span><span class="n">unpack_master_when_done</span>


        <span class="n">progress_bar</span> <span class="o">=</span> <span class="n">Progressbar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">variable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">progress_var</span><span class="p">)</span>
        <span class="n">progress_bar</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">)</span>

        <span class="c"># CEBALERT: would like time to be displayed inside the bar,</span>
        <span class="c"># but I don;t know how to do that.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeleft</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeleft</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">)</span>

        <span class="n">stop_button</span> <span class="o">=</span> <span class="n">FocusTakingButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&quot;X&quot;</span><span class="p">,</span><span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">set_stop</span><span class="p">)</span>
        <span class="n">stop_button</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;right&#39;</span><span class="p">)</span><span class="c">#side=&quot;bottom&quot;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">balloon</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">stop_button</span><span class="p">,</span><span class="s">&quot;&quot;&quot;Interrupt a procedure.&quot;&quot;&quot;</span><span class="p">)</span>
<span class="c">#        Stop a running simulation.</span>
<span class="c">#</span>
<span class="c">#        The simulation can be interrupted only on round integer</span>
<span class="c">#        simulation times, e.g. at 3.0 or 4.0 but not 3.15.  This</span>
<span class="c">#        ensures that stopping and restarting are safe for any</span>
<span class="c">#        model set up to be in a consistent state at integer</span>
<span class="c">#        boundaries, as the example Topographica models are.&quot;&quot;&quot;)</span>


    <span class="k">def</span> <span class="nf">_close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">final_message</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">ProgressController</span><span class="o">.</span><span class="n">_close</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">final_message</span><span class="p">)</span>
        <span class="c"># such a hack</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_unpack_master</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">pack_forget</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">master</span><span class="p">[</span><span class="s">&#39;width&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
        <span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="o">.</span><span class="n">destroy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">timing_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">percent</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">duration</span><span class="p">,</span><span class="n">remaining</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ProgressController</span><span class="o">.</span><span class="n">timing_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">percent</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">duration</span><span class="p">,</span><span class="n">remaining</span><span class="p">)</span>

            <span class="n">Z</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%02d</span><span class="s">:</span><span class="si">%02d</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">remaining</span><span class="o">/</span><span class="mi">60</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">remaining</span><span class="o">%</span><span class="mi">60</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">timeleft</span><span class="p">[</span><span class="s">&#39;text&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">Z</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">response</span><span class="p">(</span><span class="s">&#39;Time: </span><span class="si">%s</span><span class="s">  Duration: </span><span class="si">%s</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">duration</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update_idletasks</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">T</span><span class="o">.</span><span class="n">TclError</span><span class="p">:</span>
            <span class="k">pass</span>




<span class="c"># CEB: slightly modifed code from http://code.activestate.com/recipes/576688/</span>

<span class="c"># CEBALERT: this seems better than the tooltip provided by</span>
<span class="c"># tklib. Should probably use this instead of &#39;Balloon&#39; everywhere. I</span>
<span class="c"># need to use Tooltip rather than Balloon for the status bar, because</span>
<span class="c"># Tooltip allows a function to be passed for generating the text. I</span>
<span class="c"># wish tk included a useful tooltip widget by default.</span></div>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
<div class="viewcode-block" id="ToolTip"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.ToolTip">[docs]</a><span class="k">class</span> <span class="nc">ToolTip</span><span class="p">(</span> <span class="n">T</span><span class="o">.</span><span class="n">Toplevel</span> <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Provides a ToolTip widget for Tkinter.</span>
<span class="sd">    To apply a ToolTip to any Tkinter widget, simply pass the widget to the</span>
<span class="sd">    ToolTip constructor</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">wdgt</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">msgFunc</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">follow</span><span class="o">=</span><span class="bp">True</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the ToolTip</span>

<span class="sd">        Arguments:</span>
<span class="sd">          wdgt: The widget this ToolTip is assigned to</span>
<span class="sd">          msg:  A static string message assigned to the ToolTip</span>
<span class="sd">          msgFunc: A function that retrieves a string to use as the ToolTip text</span>
<span class="sd">          delay:   The delay in seconds before the ToolTip appears(may be float)</span>
<span class="sd">          follow:  If True, the ToolTip follows motion, otherwise hides</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wdgt</span> <span class="o">=</span> <span class="n">wdgt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wdgt</span><span class="o">.</span><span class="n">master</span>                                          <span class="c"># The parent of the ToolTip is the parent of the ToolTips widget</span>
        <span class="n">T</span><span class="o">.</span><span class="n">Toplevel</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">1</span> <span class="p">)</span>      <span class="c"># Initalise the Toplevel</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span>                                                         <span class="c"># Hide initially</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overrideredirect</span><span class="p">(</span> <span class="bp">True</span> <span class="p">)</span>                                           <span class="c"># The ToolTip Toplevel should have no frame or title bar</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">msgVar</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>                                               <span class="c"># The msgVar will contain the text displayed by the ToolTip</span>
        <span class="k">if</span> <span class="n">msg</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">pass</span><span class="c">#self.msgVar.set( &#39;No message provided&#39; )</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msgVar</span><span class="o">.</span><span class="n">set</span><span class="p">(</span> <span class="n">msg</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msgFunc</span> <span class="o">=</span> <span class="n">msgFunc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delay</span> <span class="o">=</span> <span class="n">delay</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">follow</span> <span class="o">=</span> <span class="n">follow</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastMotion</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">T</span><span class="o">.</span><span class="n">Message</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">msgVar</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s">&#39;#FFFFDD&#39;</span><span class="p">,</span>
                 <span class="n">aspect</span><span class="o">=</span><span class="mi">1000</span> <span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>                                           <span class="c"># The test of the ToolTip is displayed in a Message widget</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wdgt</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span> <span class="s">&#39;&lt;Enter&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spawn</span><span class="p">,</span> <span class="s">&#39;+&#39;</span> <span class="p">)</span>                            <span class="c"># Add bindings to the widget.  This will NOT override bindings that the widget already has</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wdgt</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span> <span class="s">&#39;&lt;Leave&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hide</span><span class="p">,</span> <span class="s">&#39;+&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wdgt</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span> <span class="s">&#39;&lt;Motion&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">,</span> <span class="s">&#39;+&#39;</span> <span class="p">)</span>

<div class="viewcode-block" id="ToolTip.spawn"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.ToolTip.spawn">[docs]</a>    <span class="k">def</span> <span class="nf">spawn</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Spawn the ToolTip.  This simply makes the ToolTip eligible for display.</span>
<span class="sd">        Usually this is caused by entering the widget</span>

<span class="sd">        Arguments:</span>
<span class="sd">          event: The event that called this funciton</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">after</span><span class="p">(</span> <span class="nb">int</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">delay</span> <span class="o">*</span> <span class="mi">1000</span> <span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">show</span> <span class="p">)</span>                       <span class="c"># The after function takes a time argument in miliseconds</span>
</div>
<div class="viewcode-block" id="ToolTip.show"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.ToolTip.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Displays the ToolTip if the time delay has been long enough</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">visible</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">lastMotion</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">delay</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">visible</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">msgVar</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">!=</span><span class="s">&#39;&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">deiconify</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="ToolTip.move"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.ToolTip.move">[docs]</a>    <span class="k">def</span> <span class="nf">move</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">event</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Processes motion within the widget.</span>

<span class="sd">        Arguments:</span>
<span class="sd">          event: The event that called this function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lastMotion</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">follow</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>                                                <span class="c"># If the follow flag is not set, motion within the widget will make the ToolTip dissapear</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span> <span class="s">&#39;+</span><span class="si">%i</span><span class="s">+</span><span class="si">%i</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">event</span><span class="o">.</span><span class="n">x_root</span><span class="o">+</span><span class="mi">10</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y_root</span><span class="o">+</span><span class="mi">10</span> <span class="p">)</span> <span class="p">)</span>        <span class="c"># Offset the ToolTip 10x10 pixes southwest of the pointer</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msgVar</span><span class="o">.</span><span class="n">set</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">msgFunc</span><span class="p">()</span> <span class="p">)</span>                                   <span class="c"># Try to call the message function.  Will not change the message if the message function is None or the message function fails</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">after</span><span class="p">(</span> <span class="nb">int</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">delay</span> <span class="o">*</span> <span class="mi">1000</span> <span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">show</span> <span class="p">)</span>
</div>
<div class="viewcode-block" id="ToolTip.hide"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.ToolTip.hide">[docs]</a>    <span class="k">def</span> <span class="nf">hide</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="o">=</span><span class="bp">None</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Hides the ToolTip.  Usually this is caused by leaving the widget</span>

<span class="sd">        Arguments:</span>
<span class="sd">          event: The event that called this function</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">withdraw</span><span class="p">()</span>

</div></div>
<span class="k">def</span> <span class="nf">bind_tooltip</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span><span class="n">msg</span><span class="p">):</span>
    <span class="n">kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">follow</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
        <span class="n">kw</span><span class="p">[</span><span class="s">&#39;msgFunc&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">msg</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">kw</span><span class="p">[</span><span class="s">&#39;msg&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">msg</span>
    <span class="n">ToolTip</span><span class="p">(</span><span class="n">widget</span><span class="p">,</span><span class="o">**</span><span class="n">kw</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">StatusBar</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>

    <span class="n">messageframe_pack_options</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="s">&#39;yes&#39;</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">dynamicinfoframe_pack_options</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="s">&#39;yes&#39;</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="s">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">progressframe_pack_options</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;right&#39;</span><span class="p">)</span>


    <span class="c">#####</span>
    <span class="c"># CEBALERT: hacks until we&#39;re using styles.</span>
    <span class="c">#</span>
    <span class="c"># This won&#39;t look good across platforms. Should get defaults.</span>
    <span class="n">label_background</span> <span class="o">=</span> <span class="s">&#39;#d9d9d9&#39;</span>
    <span class="n">label_foreground</span> <span class="o">=</span> <span class="s">&#39;#000000&#39;</span>
    <span class="k">def</span> <span class="nf">_wrn_fmt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messagelabel</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">background</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label_background</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messagelabel</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">foreground</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_err_fmt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messagelabel</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">background</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messagelabel</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">foreground</span><span class="o">=</span><span class="s">&#39;white&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_nrm_fmt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messagelabel</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">background</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label_background</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messagelabel</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">foreground</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label_foreground</span><span class="p">)</span>
    <span class="c">#####</span>


    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">master</span><span class="p">):</span>
        <span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mstack</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msformat</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mpoint</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pf0</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pf0</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progressframe</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pf0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dynamicinfoframe</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dynamicinfolabel</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dynamicinfoframe</span><span class="p">,</span><span class="n">anchor</span><span class="o">=</span><span class="s">&#39;w&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dynamicinfolabel</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">)</span>
        <span class="n">bind_tooltip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dynamicinfolabel</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_dynamicinfo</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">messageframe</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messageclear</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messageframe</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&quot;X&quot;</span><span class="p">,</span>
                                   <span class="n">command</span><span class="o">=</span><span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">clear_message</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">messagefwd</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messageframe</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&quot;&gt;&quot;</span><span class="p">,</span>
                                 <span class="n">command</span><span class="o">=</span><span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">next_message</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">messagebck</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messageframe</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&quot;&lt;&quot;</span><span class="p">,</span>
                                 <span class="n">command</span><span class="o">=</span><span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">previous_message</span><span class="p">())</span>

        <span class="n">bind_tooltip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messageclear</span><span class="p">,</span><span class="s">&quot;Dismiss current message(s)&quot;</span><span class="p">)</span>
        <span class="n">bind_tooltip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messagefwd</span><span class="p">,</span><span class="s">&quot;Next message&quot;</span><span class="p">)</span>
        <span class="n">bind_tooltip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messagebck</span><span class="p">,</span><span class="s">&quot;Previous message&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">messageclear</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messagefwd</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messagebck</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;right&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">messagelabel</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messageframe</span><span class="p">,</span><span class="n">anchor</span><span class="o">=</span><span class="s">&#39;w&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messagelabel</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">)</span>
        <span class="n">bind_tooltip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">messagelabel</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_message</span><span class="p">)</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">_show_dynamicinfoframe</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">open_progress_window</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">timer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">sim</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">ProgressWindow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">progressframe</span><span class="p">,</span><span class="n">sim</span><span class="o">=</span><span class="n">sim</span><span class="p">,</span><span class="n">timer</span><span class="o">=</span><span class="n">timer</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progressframe</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">progressframe_pack_options</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">p</span>


    <span class="k">def</span> <span class="nf">_show_messageframe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dynamicinfoframe</span><span class="o">.</span><span class="n">pack_forget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messageframe</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">messageframe_pack_options</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_show_dynamicinfoframe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messageframe</span><span class="o">.</span><span class="n">pack_forget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dynamicinfoframe</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">dynamicinfoframe_pack_options</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_idletasks</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">dynamicinfo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">text</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dynamicinfolabel</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">text</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dynamicinfo</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

        <span class="c"># remove previous after()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">after_cancel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__last_after_id</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__last_after_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span><span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">clear_dynamicinfo</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_display_from_history</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">displayindex</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">mpoint</span><span class="o">+</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msformat</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mpoint</span><span class="p">]()</span>
        <span class="k">if</span> <span class="n">displayindex</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%s</span><span class="s">: </span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">displayindex</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">mstack</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mpoint</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstack</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mpoint</span><span class="p">])</span>


    <span class="k">def</span> <span class="nf">previous_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mpoint</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstack</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">mpoint</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_from_history</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">next_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mpoint</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">mpoint</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_from_history</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">text</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nrm_fmt</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mstack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msformat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nrm_fmt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_display_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">text</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">text</span><span class="o">!=</span><span class="s">&#39;&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mstack</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">pass</span><span class="c">#self.mnavframe.pack(side=&#39;right&#39;)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span><span class="c">#self.mnavframe.pack_forget()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">messagelabel</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_show_messageframe</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">warn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">text</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_wrn_fmt</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mstack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msformat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_wrn_fmt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">error</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">text</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_err_fmt</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mstack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msformat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_err_fmt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_display_message</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bell</span><span class="p">()</span>
<span class="c">#        # CEBALERT: would like to lock only the window with the error,</span>
<span class="c">#        # not the whole app, but I don&#39;t know how to do that.</span>
<span class="c">#        try:</span>
<span class="c">#            self.grab_set()</span>
<span class="c">#        except: # get tclerror if another app has grab</span>
<span class="c">#            pass</span>

    <span class="k">def</span> <span class="nf">clear_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mpoint</span><span class="o">=-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mstack</span><span class="o">=</span><span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messagelabel</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nrm_fmt</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_show_dynamicinfoframe</span><span class="p">()</span>
<span class="c">#        try:</span>
<span class="c">#            self.grab_release()</span>
<span class="c">#        except:</span>
<span class="c">#            pass</span>

    <span class="k">def</span> <span class="nf">clear_dynamicinfo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dynamicinfolabel</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_message</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">messagelabel</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s">&#39;text&#39;</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span>
    <span class="k">def</span> <span class="nf">_get_dynamicinfo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dynamicinfolabel</span><span class="o">.</span><span class="n">config</span><span class="p">()[</span><span class="s">&#39;text&#39;</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span>



<span class="c"># CEBALERT: rename</span>
<div class="viewcode-block" id="AppWindow"><a class="viewcode-back" href="../Reference_Manual/paramtk-module.html#paramtk.AppWindow">[docs]</a><span class="k">class</span> <span class="nc">AppWindow</span><span class="p">(</span><span class="n">ScrolledWindow</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A ScrolledWindow with extra features intended to be common to all</span>
<span class="sd">    windows of an application.</span>

<span class="sd">    Currently this only includes a window icon, but we intend to</span>
<span class="sd">    add a right-click menu and possibly more.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">window_icon_path</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="o">**</span><span class="n">config</span><span class="p">):</span>
        <span class="n">ScrolledWindow</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">renew</span><span class="p">()</span>
        <span class="c">### Universal right-click menu</span>
        <span class="c"># CB: not currently used by anything but the plotgrouppanels</span>
        <span class="c"># self.context_menu = Tkinter.Menu(self, tearoff=0)</span>
        <span class="c"># self.bind(&quot;&lt;&lt;right-click&gt;&gt;&quot;,self.display_context_menu)</span>

        <span class="c"># status bar is currenlty inside scrolled area (a feature</span>
        <span class="c"># request is to move it outside ie replace self.content with</span>
        <span class="c"># just self)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">StatusBar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">botframe</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">status</span><span class="p">:</span>
            <span class="c"># place doesn&#39;t interfere with parent&#39;s geometry</span>
            <span class="c"># (don&#39;t want status bar to cause horizontal resizing,</span>
            <span class="c"># but DO want it to cause vertical resizing - the vertical</span>
            <span class="c"># part doesn&#39;t work, see earlier HACKALERT by botframe)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">status</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">relx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">rely</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">relwidth</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">renew</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># CEBALERT: doesn&#39;t work on OS X, and is a strange color on</span>
        <span class="c"># Windows.  To get a proper icon on OS X, we probably have to</span>
        <span class="c"># bundle into an application package or something like that.</span>
        <span class="c"># On OS X, could possibly alter the small titlebar icon with something like:</span>
        <span class="c"># self.attributes(&quot;-titlepath&quot;,&quot;/Users/x/topographica/AppIcon.icns&quot;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iconbitmap</span><span class="p">(</span><span class="s">&#39;@&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">window_icon_path</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="p">(</span><span class="s">&quot;WM_DELETE_WINDOW&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">mydestroy</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">mydestroy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ScrolledWindow</span><span class="o">.</span><span class="n">destroy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


</div>
<span class="k">class</span> <span class="nc">ListWidget</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>

    <span class="c"># CEBALERT: as with several of my compound widgets, need to deal</span>
    <span class="c"># with **config passed to __init__, by putting through config()</span>
    <span class="c"># (and so also need to add config() methods where currently</span>
    <span class="c"># missing).</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">,</span> <span class="n">variable</span><span class="p">,</span><span class="n">cmd</span><span class="p">,</span><span class="o">**</span><span class="n">widget_options</span><span class="p">):</span>
        <span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">)</span>

        <span class="k">if</span> <span class="s">&#39;state&#39;</span> <span class="ow">in</span> <span class="n">widget_options</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disabled</span><span class="o">=</span><span class="n">widget_options</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">disabled</span><span class="o">=</span><span class="bp">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">textvariable</span><span class="o">=</span><span class="n">variable</span><span class="p">,</span><span class="n">state</span><span class="o">=</span><span class="s">&#39;disabled&#39;</span><span class="p">,</span><span class="n">disabledforeground</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">)</span> <span class="c">#CEBALERT: presumably disabledforeground won&#39;t work work with styles...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s">&#39;both&#39;</span><span class="p">,</span><span class="n">expand</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="c">### Right-click menu for widgets</span>
        <span class="c"># CEBALERT: I can&#39;t work out how to make the right-click event</span>
        <span class="c"># bound to the widget already (by the ParametersFrame) ever</span>
        <span class="c"># activate!  It must be overwritten or something by tk. So I</span>
        <span class="c"># have to duplicate the right-click menu code here.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s">&quot;&lt;&lt;right-click&gt;&gt;&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">_right_click</span><span class="p">)</span>
        <span class="n">master</span><span class="o">.</span><span class="n">option_add</span><span class="p">(</span><span class="s">&quot;*Menu.tearOff&quot;</span><span class="p">,</span> <span class="s">&quot;0&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menu</span> <span class="o">=</span> <span class="n">Menu</span><span class="p">(</span><span class="n">master</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="o">.</span><span class="n">insert_command</span><span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39;Properties&#39;</span><span class="p">,</span>
            <span class="n">command</span><span class="o">=</span><span class="n">cmd</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_right_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Popup the right-click menu.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">disabled</span> <span class="ow">is</span> <span class="bp">False</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">menu</span><span class="o">.</span><span class="n">tk_popup</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">x_root</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">y_root</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">options</span><span class="p">):</span>
        <span class="c"># all options are passed to the entry</span>
        <span class="c"># state=disabled-&gt;no right click menu</span>
        <span class="k">if</span> <span class="s">&#39;state&#39;</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">options</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;disabled&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">disabled</span><span class="o">=</span><span class="bp">True</span>
            <span class="k">elif</span> <span class="n">options</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">]</span><span class="o">==</span><span class="s">&#39;normal&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">disabled</span><span class="o">=</span><span class="bp">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>



<span class="kn">import</span> <span class="nn">new</span>



<span class="c"># CEBALERT: dict stuff is just half implemented! does enough</span>
<span class="c"># to support list subclasses</span>
<span class="k">def</span> <span class="nf">dict_to_parameterized</span><span class="p">(</span><span class="n">class_name</span><span class="p">,</span><span class="n">parameter_values</span><span class="p">):</span>
    <span class="c"># each item is just a Parameter (i.e. not specific)</span>
    <span class="n">parameter_objs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">name</span><span class="p">,</span><span class="n">Parameter</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">value</span><span class="p">))</span>
                           <span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="n">parameter_values</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>

    <span class="c"># got to be a new class to get independent sets of parameters</span>
    <span class="n">new_class</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">classobj</span><span class="p">(</span><span class="n">class_name</span><span class="p">,(</span><span class="n">Representer</span><span class="p">,),</span><span class="n">parameter_objs</span><span class="p">)</span>
    <span class="k">return</span>  <span class="n">new_class</span><span class="p">(</span><span class="n">parameter_values</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">list_to_parameterized</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span><span class="n">class_</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>

    <span class="n">parameter_values</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">([(</span><span class="s">&#39;a&#39;</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span><span class="p">,</span><span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">list_</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">list_</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">))])</span>

    <span class="k">if</span> <span class="n">class_</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">parameter_objs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">name</span><span class="p">,</span><span class="n">Parameter</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">value</span><span class="p">))</span>
                               <span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="n">parameter_values</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">parameter_objs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">name</span><span class="p">,</span><span class="n">ClassSelector</span><span class="p">(</span><span class="n">class_</span><span class="o">=</span><span class="n">class_</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="n">value</span><span class="p">))</span>
                               <span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">value</span> <span class="ow">in</span> <span class="n">parameter_values</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>


    <span class="n">new_class</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">classobj</span><span class="p">(</span><span class="s">&#39;List&#39;</span><span class="p">,(</span><span class="n">ListRepresenter</span><span class="p">,),</span><span class="n">parameter_objs</span><span class="p">)</span>
    <span class="c">#new_class.params(&#39;name&#39;).hidden=True</span>

    <span class="n">inst</span> <span class="o">=</span> <span class="n">new_class</span><span class="p">(</span><span class="n">parameter_values</span><span class="p">,</span><span class="n">class_</span><span class="o">=</span><span class="n">class_</span><span class="p">)</span>
    <span class="n">inst</span><span class="o">.</span><span class="n">list_</span> <span class="o">=</span> <span class="n">list_</span> <span class="c"># that&#39;s a hack; need to get classes right</span>
    <span class="k">return</span> <span class="n">inst</span>





<span class="c">############################################################</span>

<span class="k">def</span> <span class="nf">standard_parameterized_params</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">Parameterized</span><span class="o">.</span><span class="n">params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">Representer</span><span class="p">(</span><span class="n">Parameterized</span><span class="p">):</span>

    <span class="n">name</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">precedence</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="c"># CEBALERT</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">represented</span><span class="p">,</span><span class="n">class_</span><span class="p">):</span>
        <span class="c">## CEBALERT: when we come to represent dicts in the GUI,</span>
        <span class="c">## will have to deal with name clashes (e.g. for name parameter)</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">standard_parameterized_params</span><span class="p">():</span>
            <span class="k">assert</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">represented</span>
        <span class="c">##</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">class_</span> <span class="o">=</span> <span class="n">class_</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">represented</span> <span class="o">=</span> <span class="n">represented</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Representer</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">represented</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialized</span><span class="o">=</span><span class="bp">False</span> <span class="c"># allow all modifications</span>


    <span class="k">def</span> <span class="nf">my_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">param_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

        <span class="c"># remove any of the standard params (e.g. name) that haven&#39;t</span>
        <span class="c"># been added to represented</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">standard_parameterized_params</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">represented</span><span class="p">:</span>
                <span class="n">param_names</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">param_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">param_names</span>


    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_params</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">represented</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">ClassSelector</span><span class="p">(</span><span class="n">class_</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">class_</span><span class="p">,</span><span class="n">default</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_add_parameter</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">represented</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="n">default</span>
        <span class="k">return</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="c"># CB: don&#39;t move any of this method up to parameterized</span>
        <span class="c"># without considering the consequences!</span>

        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">represented</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

        <span class="n">cls</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="nb">delattr</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">delattr</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="s">&#39;_</span><span class="si">%s</span><span class="s">__params&#39;</span><span class="o">%</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>


<span class="k">class</span> <span class="nc">ListRepresenter</span><span class="p">(</span><span class="n">Representer</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ListRepresenter</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

        <span class="c">## grow or shrink original list if necessary</span>
        <span class="n">l</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">represented</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">l</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">list_</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">l</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">l</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">list_</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">represented</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">list_</span><span class="p">[:]</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">return</span>

        <span class="k">for</span> <span class="n">val</span><span class="p">,</span><span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">represented</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_</span><span class="p">))):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">list_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">val</span>

    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">longest</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_params</span><span class="p">()])</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">longest</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s">&#39;a&#39;</span><span class="o">*</span><span class="p">(</span><span class="n">longest</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="c">#name = &#39;a&#39;*(len(self.my_params())+1)</span>
        <span class="k">assert</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">my_params</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">ListRepresenter</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>


<span class="c"># Problems:</span>
<span class="c"># * + button gets hidden as more rows added (unless window made</span>
<span class="c">#   bigger)</span>
<span class="c">#</span>
<span class="c"># * window doesn&#39;t open at right width to display contents</span>
<span class="c">#   list item contents</span>
<span class="c">#</span>
<span class="c"># * I suspect there&#39;s a bug where you can get to a situation in</span>
<span class="c">#   which editing one box will result in changes to another,</span>
<span class="c">#   thanks to the ridiculously and unnecessarily complex code</span>
<span class="c">#   for tracking items. But I can&#39;t currently demonstrate such a</span>
<span class="c">#   a bug...</span>
<span class="k">class</span> <span class="nc">EditingParametersFrameWithApply</span><span class="p">(</span><span class="n">ParametersFrameWithApply</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">master</span><span class="p">,</span><span class="n">parameterized_object</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">on_set</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">on_modify</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">EditingParametersFrameWithApply</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span>
            <span class="n">master</span><span class="p">,</span><span class="n">parameterized_object</span><span class="p">,</span><span class="n">on_set</span><span class="p">,</span><span class="n">on_modify</span><span class="p">,</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">hide_param</span><span class="p">(</span><span class="s">&#39;Defaults&#39;</span><span class="p">)</span>

        <span class="c">## hack to find last row</span>
        <span class="n">last_row</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">currently_displayed_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">row</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">&#39;widget&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">grid_info</span><span class="p">()[</span><span class="s">&#39;row&#39;</span><span class="p">])</span>
            <span class="n">last_row</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">last_row</span><span class="p">)</span>

        <span class="n">ad</span><span class="o">=</span><span class="n">T</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&quot;+&quot;</span><span class="p">,</span><span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_add_param</span><span class="p">)</span>
        <span class="n">ad</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;right&#39;</span><span class="p">)</span>

        <span class="c">### CB: should use button parameter and pack_param</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hack</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">image</span><span class="o">=</span><span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">ImageOps</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">resolve_path</span><span class="p">(</span><span class="s">&#39;tkgui/icons/edit_add.png&#39;</span><span class="p">)),(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)))</span>
        <span class="n">ad</span><span class="p">[</span><span class="s">&#39;image&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">image</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
        <span class="c">###</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_apply_hooks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">xupdate</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_apply_hooks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_apply_status</span><span class="p">())</span>


<span class="c"># CEBALERT: name this, and there&#39;s duplication with represented etc.</span>
    <span class="k">def</span> <span class="nf">xupdate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">cls</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span><span class="p">)</span>

        <span class="n">old</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params_to_display</span><span class="p">:</span>
            <span class="n">old</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">name</span><span class="p">],</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">],</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">params_to_display</span><span class="p">[</span><span class="n">name</span><span class="p">],</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">currently_displayed_params</span><span class="p">[</span><span class="n">name</span><span class="p">],</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span><span class="o">.</span><span class="n">params</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

        <span class="n">new_pos</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params_to_display</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">new_pos</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;widget&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">grid_info</span><span class="p">()[</span><span class="s">&#39;row&#39;</span><span class="p">])]</span><span class="o">=</span><span class="n">name</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span><span class="o">.</span><span class="n">represented</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">pos</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params_to_display</span><span class="p">),</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params_to_display</span><span class="p">))):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">=</span><span class="n">old</span><span class="p">[</span><span class="n">new_pos</span><span class="p">[</span><span class="n">pos</span><span class="p">]][</span><span class="mi">0</span><span class="p">]</span>

            <span class="c"># getting ridiculous. make sure old widgets are wiped from</span>
            <span class="c"># the earth. who knows how many other times I should have</span>
            <span class="c"># been doing this in the gui?</span>
            <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">w</span><span class="o">.</span><span class="n">grid_remove</span><span class="p">()</span>
                    <span class="n">w</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">=</span><span class="n">old</span><span class="p">[</span><span class="n">new_pos</span><span class="p">[</span><span class="n">pos</span><span class="p">]][</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">params_to_display</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">=</span><span class="n">old</span><span class="p">[</span><span class="n">new_pos</span><span class="p">[</span><span class="n">pos</span><span class="p">]][</span><span class="mi">2</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currently_displayed_params</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">=</span><span class="n">old</span><span class="p">[</span><span class="n">new_pos</span><span class="p">[</span><span class="n">pos</span><span class="p">]][</span><span class="mi">3</span><span class="p">]</span>
            <span class="nb">type</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">old</span><span class="p">[</span><span class="n">new_pos</span><span class="p">[</span><span class="n">pos</span><span class="p">]][</span><span class="mi">4</span><span class="p">])</span>

            <span class="c"># (see alert at start of method)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span><span class="o">.</span><span class="n">represented</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>

        <span class="c">## delete cached params()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">delattr</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span><span class="s">&#39;_</span><span class="si">%s</span><span class="s">__params&#39;</span><span class="o">%</span><span class="n">cls</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_PO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span><span class="p">)</span> <span class="c"># HACK! At least extract relevant parts</span>


    <span class="k">def</span> <span class="nf">_grid_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parameter_name</span><span class="p">,</span><span class="n">row</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">EditingParametersFrameWithApply</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_grid_param</span><span class="p">(</span>
            <span class="n">parameter_name</span><span class="p">,</span><span class="n">row</span><span class="p">)</span>
        <span class="n">lc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">parameter_name</span><span class="p">][</span><span class="s">&#39;list_ctrl&#39;</span><span class="p">]</span>
        <span class="n">lc</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_make_representation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">EditingParametersFrameWithApply</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_make_representation</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;list_ctrl&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">ListItemCtrlWidget</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_params_frame</span><span class="p">,</span>
            <span class="k">lambda</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_up_param</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
            <span class="k">lambda</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_down_param</span><span class="p">(</span><span class="n">name</span><span class="p">),</span>
            <span class="k">lambda</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_del_param</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_add_param</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># should refactor pack_params to get out adding of single param</span>

        <span class="n">po</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">po</span><span class="o">.</span><span class="n">add</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_create_tkvar</span><span class="p">(</span><span class="n">po</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">po</span><span class="o">.</span><span class="n">params</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_make_representation</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">row</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params_to_display</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_grid_param</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">row</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">params_to_display</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">=</span><span class="n">po</span><span class="o">.</span><span class="n">params</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currently_displayed_params</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_update_apply_status</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">_del_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="n">current_pos</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;widget&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">grid_info</span><span class="p">()[</span><span class="s">&#39;row&#39;</span><span class="p">])</span>
        <span class="n">po</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span>
        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">]:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">w</span><span class="p">]</span><span class="o">.</span><span class="n">grid_forget</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">w</span><span class="p">]</span><span class="o">.</span><span class="n">destroy</span><span class="p">()</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tkvars</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">params_to_display</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">currently_displayed_params</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">translators</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

        <span class="n">po</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="c"># move ones below up one</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params_to_display</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">n2</span><span class="p">,</span><span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="s">&#39;grid_info&#39;</span><span class="p">):</span>
                    <span class="n">w_gi</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">grid_info</span><span class="p">()</span>
                    <span class="k">if</span> <span class="s">&#39;row&#39;</span> <span class="ow">in</span> <span class="n">w_gi</span><span class="p">:</span>
                        <span class="n">r1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">w_gi</span><span class="p">[</span><span class="s">&#39;row&#39;</span><span class="p">])</span>
                        <span class="k">if</span> <span class="n">r1</span><span class="o">&gt;</span><span class="n">current_pos</span><span class="p">:</span>
                            <span class="n">w_gi</span><span class="p">[</span><span class="s">&#39;row&#39;</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">r1</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                            <span class="n">w</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="o">**</span><span class="n">w_gi</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_update_apply_status</span><span class="p">()</span>



    <span class="k">def</span> <span class="nf">_down_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="n">current_pos</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;widget&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">grid_info</span><span class="p">()[</span><span class="s">&#39;row&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">current_pos</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params_to_display</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">new_pos</span> <span class="o">=</span> <span class="n">current_pos</span><span class="o">+</span><span class="mi">1</span>
        <span class="n">current_name</span> <span class="o">=</span> <span class="n">name</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">(</span><span class="n">current_name</span><span class="p">,</span><span class="n">current_pos</span><span class="p">,</span><span class="n">new_pos</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">current_name</span><span class="p">,</span><span class="n">current_pos</span><span class="p">,</span><span class="n">new_pos</span><span class="p">):</span>
        <span class="c">#### HACK TO FIND NEW NAME BY MATCHING ROW</span>
        <span class="n">new_name</span><span class="o">=</span><span class="bp">None</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">:</span>
            <span class="k">if</span> <span class="s">&#39;row&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s">&#39;widget&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">grid_info</span><span class="p">():</span>
                <span class="n">row</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="s">&#39;widget&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">grid_info</span><span class="p">()[</span><span class="s">&#39;row&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">row</span><span class="o">==</span><span class="n">new_pos</span><span class="p">:</span>
                    <span class="n">new_name</span><span class="o">=</span><span class="n">n</span>
                    <span class="k">break</span>
        <span class="k">assert</span> <span class="n">new_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span>
        <span class="c">####</span>

        <span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">current_name</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="s">&#39;grid_info&#39;</span><span class="p">):</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">grid_info</span><span class="p">()</span>
                <span class="k">if</span> <span class="s">&#39;row&#39;</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span>
                    <span class="c">#print &quot;regrid&quot;,current_name,current_pos</span>
                    <span class="n">g</span><span class="p">[</span><span class="s">&#39;row&#39;</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">&#39;</span><span class="o">%</span><span class="n">new_pos</span>
                    <span class="n">w</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="o">**</span><span class="n">g</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">new_name</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="s">&#39;grid_info&#39;</span><span class="p">):</span>
                <span class="n">g</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">grid_info</span><span class="p">()</span>
                <span class="k">if</span> <span class="s">&#39;row&#39;</span> <span class="ow">in</span> <span class="n">g</span><span class="p">:</span>
                    <span class="c">#print &quot;regrid&quot;,new_name,new_pos</span>
                    <span class="n">g</span><span class="p">[</span><span class="s">&#39;row&#39;</span><span class="p">]</span><span class="o">=</span><span class="s">&#39;</span><span class="si">%s</span><span class="s">&#39;</span><span class="o">%</span><span class="n">current_pos</span>
                    <span class="n">w</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="o">**</span><span class="n">g</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_update_apply_status</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">_up_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="n">current_pos</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;widget&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">grid_info</span><span class="p">()[</span><span class="s">&#39;row&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">current_pos</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">new_pos</span> <span class="o">=</span> <span class="n">current_pos</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">current_name</span> <span class="o">=</span> <span class="n">name</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">(</span><span class="n">current_name</span><span class="p">,</span><span class="n">current_pos</span><span class="p">,</span><span class="n">new_pos</span><span class="p">)</span>

    <span class="c"># CEBALERT: why not in super?</span>
    <span class="k">def</span> <span class="nf">_update_apply_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">w</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="s">&#39;Apply&#39;</span><span class="p">][</span><span class="s">&#39;widget&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_unapplied_change</span><span class="p">():</span>
            <span class="n">w</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s">&#39;normal&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">w</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s">&#39;disabled&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_PO</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parameterized_object</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">EditingParametersFrameWithApply</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">set_PO</span><span class="p">(</span><span class="n">parameterized_object</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hide_param</span><span class="p">(</span><span class="s">&#39;Defaults&#39;</span><span class="p">)</span> <span class="c"># CEBALERT: should just have been unpacked earlier</span>

    <span class="k">def</span> <span class="nf">has_unapplied_change</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c"># detect length change</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span><span class="o">.</span><span class="n">list_</span><span class="p">)</span><span class="o">!=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params_to_display</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">True</span>

        <span class="c"># detect order change</span>
        <span class="n">names</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params_to_display</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)),</span><span class="n">names</span><span class="p">):</span>
            <span class="k">if</span> <span class="s">&#39;widget&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="ow">or</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">representations</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;widget&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">grid_info</span><span class="p">()[</span><span class="s">&#39;row&#39;</span><span class="p">])</span><span class="o">!=</span><span class="n">i</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">True</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">EditingParametersFrameWithApply</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">has_unapplied_change</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">_refresh_button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">overwrite_error</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_PO</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_extraPO</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_apply_status</span><span class="p">()</span>

    <span class="c"># CEBALERT: because</span>
    <span class="k">def</span> <span class="nf">_apply_button</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_parameters</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_hooks</span><span class="p">:</span>
            <span class="n">h</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">ListItemCtrlWidget</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">master</span><span class="p">,</span><span class="n">up_cmd</span><span class="p">,</span><span class="n">down_cmd</span><span class="p">,</span><span class="n">remove_cmd</span><span class="p">):</span>
        <span class="n">T</span><span class="o">.</span><span class="n">Frame</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">)</span>

        <span class="n">up</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&quot;u&quot;</span><span class="p">,</span><span class="n">command</span><span class="o">=</span><span class="n">up_cmd</span><span class="p">)</span>
        <span class="n">up</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">)</span>

        <span class="n">down</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&quot;d&quot;</span><span class="p">,</span><span class="n">command</span><span class="o">=</span><span class="n">down_cmd</span><span class="p">)</span>
        <span class="n">down</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">)</span>

        <span class="n">remove</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;-&#39;</span><span class="p">,</span><span class="n">command</span><span class="o">=</span><span class="n">remove_cmd</span><span class="p">)</span>
        <span class="n">remove</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="s">&#39;left&#39;</span><span class="p">)</span>


        <span class="c">### CEBALERT: should use button parameter &amp; pack_param</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hack</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">image</span><span class="o">=</span><span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">ImageOps</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">resolve_path</span><span class="p">(</span><span class="s">&#39;tkgui/icons/arrow-up.png&#39;</span><span class="p">)),(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)))</span>
        <span class="n">up</span><span class="p">[</span><span class="s">&#39;image&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">image</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

        <span class="n">image</span><span class="o">=</span><span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">ImageOps</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">resolve_path</span><span class="p">(</span><span class="s">&#39;tkgui/icons/arrow-down-2.0.png&#39;</span><span class="p">)),(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)))</span>
        <span class="n">down</span><span class="p">[</span><span class="s">&#39;image&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">image</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>

        <span class="n">image</span><span class="o">=</span><span class="n">ImageTk</span><span class="o">.</span><span class="n">PhotoImage</span><span class="p">(</span><span class="n">ImageOps</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
            <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">resolve_path</span><span class="p">(</span><span class="s">&#39;tkgui/icons/edit_remove.png&#39;</span><span class="p">)),(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)))</span>
        <span class="n">remove</span><span class="p">[</span><span class="s">&#39;image&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">image</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
        <span class="c">###</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/topo-banner7.png" alt="Logo"/>
            </a></p>
<ul class="global-toc">
<li><a href="../index.html">Home</a></li>
<li><a href="../News/index.html">News</a></li>
<li><a href="../Downloads/index.html">Downloads</a></li>
<li><a href="../Tutorials/index.html">Tutorials</a></li>
<li><a href="../User_Manual/index.html">User Manual</a></li>
<li><a href="../Reference_Manual/index.html">Reference Manual</a></li>
<li><a href="../Developer_Manual/index.html">Developer Manual</a></li>
<li><a href="http://github.com/ioam/topographica">Github Source Code</a></li>
<li><a href="../Forums/index.html">Forums</a></li>
<li><a href="../Team_Members/index.html">Team Members</a></li>
<li><a href="../Future_Work/index.html">Future Work</a></li>
<li><a href="../FAQ/index.html">FAQ</a></li>
<li><a href="../Links/index.html">Links</a></li>
<li><a href="../Home/pubs.html">Publications</a></li>
<li><a href="../site_map.html">Site Map</a></li>
</ul>
<h3><a href="../index.html">Table Of Contents</a></h3>


<h3>This Page</h3>
<ul class="this-page-menu">
	<li><a	href="https://github.com/ioam/topographica/edit/master/doc/_modules/paramtk.rst" rel="nofollow">Edit on GitHub</a></li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
<li><a href="../index.html">Home</a></li>
<li><a href="../Downloads/index.html">Downloads</a></li>
<li><a href="../Tutorials/index.html">Tutorials</a></li>
<li><a href="../User_Manual/index.html">User Manual</a></li>


<li><ul class="parents">



          <li><a href="index.html" >Module code</a> &raquo;</li>

</ul></li>


      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, IOAM.
      Last updated on May 15, 2014.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>